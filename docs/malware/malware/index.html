<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>About Malware - readloud.org</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "About Malware", url: "#_top", children: [
          ]},
          {title: "Malware Analysis", url: "#malware-analysis", children: [
              {title: "Why Malware Analysis?", url: "#why-malware-analysis" },
              {title: "Types of Malware Analysis", url: "#types-of-malware-analysis" },
              {title: "Objectives", url: "#objectives" },
              {title: "Requisites", url: "#requisites" },
              {title: "Create an Executable Server with njRAT", url: "#create-an-executable-server-with-njrat" },
              {title: "Execute the Server on the Target Machine", url: "#execute-the-server-on-the-target-machine" },
              {title: "Manipulate Files on Target machine", url: "#manipulate-files-on-target-machine" },
              {title: "Manage the Processes", url: "#manage-the-processes" },
              {title: "Manage the Connections", url: "#manage-the-connections" },
              {title: "Manage the Registries", url: "#manage-the-registries" },
              {title: "Launch a Remote Shell", url: "#launch-a-remote-shell" },
              {title: "Run File", url: "#run-file" },
              {title: "Launch a Remote Desktop Connection", url: "#launch-a-remote-desktop-connection" },
              {title: "Perform Key Logging", url: "#perform-key-logging" },
          ]},
          {title: "HTTP RAT Trojan", url: "#http-rat-trojan", children: [
              {title: "Objectives", url: "#objectives_1" },
              {title: "Requisites", url: "#requisites_1" },
              {title: "Create a Trojan on Windows Server", url: "#create-a-trojan-on-windows-server" },
              {title: "Execute the Trojan on Windows 10", url: "#execute-the-trojan-on-windows-10" },
              {title: "Analyze the Target Machine", url: "#analyze-the-target-machine" },
              {title: "Scanning Malicious File", url: "#scanning-malicious-file" },
              {title: "Crypt a Trojan file using SwayzCryptor", url: "#crypt-a-trojan-file-using-swayzcryptor" },
          ]},
          {title: "Malware Analysis Virtual Environment", url: "#malware-analysis-virtual-environment", children: [
              {title: "REMnux", url: "#remnux" },
              {title: "Tsurugi Linux", url: "#tsurugi-linux" },
              {title: "FLARE VM", url: "#flare-vm" },
          ]},
          {title: "ProRat", url: "#prorat", children: [
          ]},
          {title: "Theef", url: "#theef", children: [
          ]},
          {title: "JPS Virus Maker Tool", url: "#jps-virus-maker-tool", children: [
          ]},
          {title: "Internet Worm Maker Thing", url: "#internet-worm-maker-thing", children: [
          ]},
          {title: "Regshot", url: "#regshot", children: [
          ]},
          {title: "WinPatrol", url: "#winpatrol", children: [
          ]},
          {title: "TCPView", url: "#tcpview", children: [
          ]},
          {title: "Autoruns", url: "#autoruns", children: [
          ]},
          {title: "ClamWin", url: "#clamwin", children: [
              {title: "Malware-Examples", url: "#malware-examples" },
              {title: "Some tips for detecting and preventing Ransomware", url: "#some-tips-for-detecting-and-preventing-ransomware" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="about-malware">About Malware</h1>
<p><img alt="malware" src="https://upload.wikimedia.org/wikipedia/commons/4/44/2017_Petya_cyberattack_screenshot.jpg" /></p>
<p>Malware / Malicious Software is a type of program that contains malicious or harmful code embedded inapparently harmless programming or data in such a way that it can take control of a system or its operations and cause damage, such as running the file allocation table on a hard drive.</p>
<p>Malware poses a major security threat to the information security. Malware writers explore new attack vectors to exploit vulnerabilities in information systems. This leads to ever more sophisticated malware attacks, including drive by malware, 'maladvertising' (or 'malvertising'), Advanced Persistent Threats (APT), and so on. Though organizations try hard to  defend themselves using comprehensive security policies and advanced anti-malware controls, the current trend indicates that malware applications are targeting 'lower-hanging fruit': undersecured smartphones, mobile applications, social media, and cloud services. The problem is further complicated because of threat predictions. As McAfee stated in its McAfee Labs Threats Report published in December 2017, 'The biggest number of the quarter is our count of new malware, which reached an all-time high of 57.6 million new samples, an increase of 10% from Q2. The total count in the McAfee Labs sample databases is now more than 780 million. New ransomware rose by 36% this quarter, largely from widespread Android screen-locking malware. The easy availability of exploit kits and dark web sources fuel the rapid creation of new malware'.</p>
<h1 id="malware-analysis">Malware Analysis</h1>
<p>Malware analysis provides an in-depth understanding of each individual sample and identifies emerging technical trends from the large collections of malware samples without actually executing them. The samples of malware are mostly compatible with the Windows binary executable. There are variety of goals in performing Malware analysis.</p>
<p align="center">
  <img  src="https://github.com/mandiant/flare-vm/raw/main/Images/flarevm-logo.png" alt="FLARE VM" width="200"/>
</p>

<h3 id="why-malware-analysis">Why Malware Analysis?</h3>
<p><em>Malware analysis can be conducted with various objectives in mind:</em></p>
<ul>
<li>To understand the capabilities of the malware.</li>
<li>Determine how the malware functions
Asses the intrusion damage.</li>
<li>Identify indicators that will helps us determine other infected machine by the same malware and the level of infection in the network.</li>
<li>Help us identify if the malware is exploiting any vulnerability or on how it is persisting on the system.</li>
<li>Determine the nature &amp; purpose of the malware.</li>
<li>To understand who is targeting &amp; how good they are.</li>
<li>To understand what information did they steal.</li>
</ul>
<h3 id="types-of-malware-analysis">Types of Malware Analysis</h3>
<ul>
<li><strong>Static analysis:</strong> is the process of analyzing malware without executing or running it. The objective is to extract as much metadata from the malware as possible. (Strings, PE Headers)</li>
<li><strong>Dynamic analysis:</strong> is the process of executing malware and analyzing it's functionality and behaviour. The objective is to understand exactly how and what the malware does during the execution. This is done in a debugger.</li>
<li><strong>Code analysis:</strong> is the process of analyzing/reverse engineering assembly code. This can be both statically and dynamically done (Static and Dynamic code analysis).</li>
<li><strong>Behavioural analysis:</strong> is the process of analyzing and monitoring the malware after execution. It involves monitoring the processes, registry entries and network monitoring to determine the workings of the malware.# njRAT - Remote Access Trojan 
njRAT is a RAT with powerful data-stealing capabilities. In addition to loggin keystrokes, it is capable of accessing a victim's camera, stealing credentials stored in browsers, uploading and downloading files, performing the process and file manipulations, and viewing the victim's desktop.</li>
</ul>
<p>RATs help an attacker to remotely access complete GUI, control victim's computer without his or her awareness and are capable of performing screening and camera capture, code execution, keylogging, file access, password sniffing, registry management, and so on. It infects victims via phishing attacks and drive by downloads and propagates through infected USB keys or networked drives. It can download and execute additional malware, execute shell commands, read and write registry keys, capture screenshots, log keystrokes, and spy on webcams.</p>
<p><img alt="njrat-banner" src="https://mrpirate.net/wp-content/uploads/2019/01/Download-NjRat-Cracked-696x297.png" /></p>
<p>The njRAT Trojan can be used to control Botnets (network of computers), allowing the attacker to update, uninstall, disconnect, restart, close the RAT, and rename its compaign ID. The attacker can further create and configure the malware to spread through USB drives with the help of the Command and Control server software.</p>
<p>https://mrpirate.net/njrat/</p>
<h3 id="objectives">Objectives</h3>
<ul>
<li>Create a server using njRAT.</li>
<li>Access the target machine remotely.</li>
</ul>
<h3 id="requisites">Requisites</h3>
<ul>
<li>Windows 10 (Attacker).</li>
<li>Windows 7, 8 or Server (Target).</li>
</ul>
<hr />
<h3 id="create-an-executable-server-with-njrat">Create an Executable Server with njRAT</h3>
<ol>
<li>
<p>Log in to the <strong>Windows 10</strong> and install the <strong>njRAT</strong>.</p>
</li>
<li>
<p>Launch the njRAT, the GUI appears along with a pop-up, where you need to specify the port you want to use to interact with the target machine. Use the default port number <strong>5552</strong>, and click <strong>Start</strong>.<br><br>
<img alt="njRAT-1" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/caad9653523827738862d74cf1c36cf8837d6fd7/njrat-1.png" /></p>
</li>
<li>
<p>Click on <strong>Builder</strong> at lower-left corner.<br><br>
<img alt="njrat-2" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/411c9e98897726a97257b7987b0c509a3aa1675f/njrat-2.png" /></p>
</li>
<li>
<p>On the <strong>Builder</strong> dialog-box, enter the IP address of the <strong>Attacker machine - Windows 10</strong>, check the option <strong>Copy to StartUp and Registry StarUp</strong>, then click <strong>Build</strong> as shown below:<br><br>
<img alt="njrat-3" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/411c9e98897726a97257b7987b0c509a3aa1675f/njrat-3.png" /></p>
</li>
<li>
<p><strong>Save</strong> the file on the <strong>Desktop</strong> and name as <strong>Example.exe</strong>.</p>
</li>
<li>
<p>Now, we need to use any technique to send this server to the intended target through mail or any other way.<br>
To make this easier in this lab, I copied the <strong>Example.exe</strong> file in the <strong>shared network location</strong>.</p>
</li>
</ol>
<h3 id="execute-the-server-on-the-target-machine">Execute the Server on the Target Machine</h3>
<p>In this Lab I'm using Windows 7 SP1 virtual machine.<br>
<strong>Note</strong>: Make sure to <strong>enable</strong> the Firewall on the target machine.</p>
<ol>
<li>
<p>Drag the <strong>Example.exe</strong> file to your Desktop and double-click it. <br><br>
<img alt="njrat-file" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/b2573905cb5a70412b91a66178dbc31d408b88c5/njrat-4-.png" />
<br><br>
As you can see below, the connection was successfully established.
<img alt="netstat" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/09d357ad5a4100dc86c96752cdfa66aa5d7ea0b8/netstat-njrat-0.png" /></p>
</li>
<li>
<p>Switch back to the <strong>Windows 10</strong> (Attacker). When the target double-clicks the server, the executable starts running and the njRAT GUI running on the Windows 10 establishes a persistent connection with the Target machine as show below:<br><br>
<img alt="njrat-5" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/b2573905cb5a70412b91a66178dbc31d408b88c5/njrat-5-manager.png" /><br>
The GUI displays the machine's basic details such as the IP address, OS, user name and so on.</p>
</li>
</ol>
<p><strong>Note</strong>: Unless the attacker disconnects the server on his own, the victim machine remains under his control.</p>
<h3 id="manipulate-files-on-target-machine">Manipulate Files on Target machine</h3>
<ul>
<li>Right-click on the detected Target machine and click <strong>Manager</strong>.<br><br>
<img alt="njrat-6" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-6.png" /><br><br> Double-click on any directory in the left pane. You can right-click any selected directory and manipulate it using the contextual options:<br><br>
<img alt="njrat-7" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-7.png" /><br>
<img alt="njrat-8" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-8.png" /></li>
</ul>
<h3 id="manage-the-processes">Manage the Processes</h3>
<ul>
<li>Click on <strong>Process Manager</strong> on the top menu. You will be redirected to the Process Manager, where you can right-click any process and perform actions such as <strong>Kill</strong>, <strong>Delete</strong>, and <strong>Restart</strong>.<br><br>
<img alt="njrat-9" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-9.png" /></li>
</ul>
<h3 id="manage-the-connections">Manage the Connections</h3>
<ul>
<li>Click on <strong>Connections</strong> on the top menu and select a specific connection, right-click on it, and click <strong>Kill Connection</strong>. This action kills the connection between two machines communicating through a particular port.<br><br>
<img alt="njrat-10" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-10.png" /></li>
</ul>
<h3 id="manage-the-registries">Manage the Registries</h3>
<ul>
<li>Click on <strong>Registry</strong> on the top menu and choose a registry from the left pane, right-click on its associated registry files, a few options appear to manipulate them.<br><br>
<img alt="njrat-11" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-11.png" /></li>
</ul>
<h3 id="launch-a-remote-shell">Launch a Remote Shell</h3>
<ul>
<li>Click on <strong>Remote Shell</strong> on the top menu. This action launches a remote command prompt of the target machine.<br><br>
<img alt="njrat-12" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/765ee94aa03721aa4e232e9bb6681286a85c1b63/njrat-12.png" />
Similarly, you can issue all the other commands that can be executed in the command prompt of the target. </li>
</ul>
<h3 id="run-file">Run File</h3>
<ul>
<li>On the main window of njRAT, righ-click on the Target machine and select <strong>Run File</strong>. An attacker makes use of these options to execute scripts or files remotely from his/her machine.<br><br>
<img alt="njrat-13" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/ec9651e3ff4d84df00483d9533bba6e5c636fe07/njrat-13.png" /></li>
</ul>
<h3 id="launch-a-remote-desktop-connection">Launch a Remote Desktop Connection</h3>
<ul>
<li>Righ-click on the Target machine and select <strong>Remote Desktop Connection</strong><br><br>
<img alt="njrat-14" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/ec9651e3ff4d84df00483d9533bba6e5c636fe07/njrat-14.png" /><br><br>
This launches a remote desktop connection without target's consent. You will be able to remotely interact with the victim machine using the mouse or keyboard.<br>
<img alt="njrat-15" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/ec9651e3ff4d84df00483d9533bba6e5c636fe07/njrat-15.png" /><br><br>
In the same way, you can select the <strong>Remote Cam</strong> and <strong>Microphone</strong> to spy on the target and track voice conversations.</li>
</ul>
<h3 id="perform-key-logging">Perform Key Logging</h3>
<ul>
<li>
<p>Switch to the <strong>Windows 7 (Target machine)</strong>. Let's assume that you are a legitimate user and perform a few activities such as logging into any websites or typing text in some documents.</p>
</li>
<li>
<p>Now, switch back to <strong>Windows 10</strong> machine / njRAT GUI and right-click on the target machine, select the <strong>Keylogger</strong> option.<br><br>
<img alt="njrat-17" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/cac208d7be116875c33553b33c198cb97a1a4830/rjrat-17.png" /><br><br>
The keylogger window appears, displaying all the keystrokes performed by the target.</p>
</li>
</ul>
<hr />
<p>In case the victim/target, attempts to break the connection by restarting the machine, however, as soon the victim logs again, the njRAT client will automatically establishes a connection with the victim.</p>
<h1 id="http-rat-trojan">HTTP RAT Trojan</h1>
<p>HTTP/HTTPS Trojans can bypass any firewall, and work as kind of a straight HTTP tunnel, but one that works in reverse. They use web-based interfaces and port 80 to gain access. The execution of these trojans takes places on the internal host and spawns a "child" at a predetermined time. The child program appears to be a user to the firewall so it allows the program access to the internet. However, this child executes a local shell, connects to the web server that the attacker owns on the internet through a legitimate-looking HTTP request, and sends it a ready signal. The legitimate-looking answer from the attacker's web server is in reality a series of commands that the child can execute on the machine's local shell.</p>
<p>Auditing a network against HTTP RATs is generally more difficult as well as essential, as most firewalls and other perimeter security devices cannot detect traffic generated by a HTTP RAT Trojan. </p>
<p>Remote Access Trojans (RATs) are malicious programs that run invisibly on the host's PC and permit an intruder remote access and control. A RAT can provide a backdoor for administrative control over the target computer. Upon compromising the target system, the attacker can use it to distribute RATs to other vulnerable computers and establish a botnet.</p>
<h3 id="objectives_1">Objectives</h3>
<ul>
<li>Create a server and Run HTTP Trojan on Windows Server 2012.</li>
<li>Execute the Server from Windows 10 virtual machine.</li>
<li>Control Windows 10 machine remotely from Windows Server 2012.</li>
</ul>
<h3 id="requisites_1">Requisites</h3>
<ul>
<li>Windows Server 2012 virtual machine (Attacker).</li>
<li>Windows 10 virtual machine (Target).</li>
</ul>
<h2 id="create-a-trojan-on-windows-server">Create a Trojan on Windows Server</h2>
<ol>
<li>Log on to Windows Server 2012 and install the HTTP RAT TROJAN tool:</li>
<li>
<p><a href="https://anonfile.com/HaT8v9Jbn7/HTTP_RAT_TROJAN.zip">HTTP_RAT_TROJAN.zip</a></p>
</li>
<li>
<p>Double-click <strong>httprat.exe</strong>, the HTTP RAT main window appears as shown below:<br><br>
<img alt="httprat1" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/c6adc85569ebd126c778c0867c201e1125259a8a/httprat-1.png" /></p>
</li>
<li>
<p>Uncheck <strong>send notification with IP address to mail</strong> option, enter the <strong>server port</strong> to <strong>84</strong> and click <strong>Create</strong>.<br><br>
<img alt="httprat2" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/c6adc85569ebd126c778c0867c201e1125259a8a/httprat-2.png" /></p>
</li>
<li>
<p>Once the <strong>httpserver.exe</strong> file is created, a pop-up will be displayed, click <strong>OK</strong> and share the file with <strong>Windows 10 virtual machine</strong>.<br><br>
<img alt="httprat3" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/c6adc85569ebd126c778c0867c201e1125259a8a/httprat-2-5.png" /><br><br>
The file will be saved into HTTP RAT TROJAN folder as show below:<br><br>
<img alt="httprat4" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/c6adc85569ebd126c778c0867c201e1125259a8a/httprat-3.png" /></p>
</li>
</ol>
<h2 id="execute-the-trojan-on-windows-10">Execute the Trojan on Windows 10</h2>
<ol>
<li>
<p>Now log into <strong>Windows 10</strong> and navigate to the place where you saved the httpserver.exe file. Double click to run the Trojan.<br><br>
<img alt="httprat5" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/e5031f2ab424e1f284d9784c64396990baddf01a/httprat-5.png" /></p>
</li>
<li>
<p>You will be able to see the <strong>Httpserver</strong> process in the task manager:<br><br>
<img alt="httprat6" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/e5031f2ab424e1f284d9784c64396990baddf01a/httprat-6.png" /></p>
</li>
</ol>
<h2 id="analyze-the-target-machine">Analyze the Target Machine</h2>
<ol>
<li>Switch back to the <strong>Windows Server 2012</strong> and launch the web browser.</li>
<li>Enter the IP address of Windows 10 in the address bar to access the machine.</li>
</ol>
<p>Note: it is normal to get some errors on the first requests, the browser may fail to connect - just reload the webpage a couple times.</p>
<ul>
<li>
<p>If everything works, you should get this window:<br><br>
<img alt="httprat7" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/195c036c0d7694686c5351ec418d1ec9806e8fe2/httprat-7.png" /></p>
</li>
<li>
<p>Click on the <strong>Running procesess</strong> link to list down processes running on the <strong>Windows 10</strong>. It is possible to kill any process from here.<br><br>
<img alt="httprat8" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/195c036c0d7694686c5351ec418d1ec9806e8fe2/httprat-8.png" /></p>
</li>
<li>
<p>Click <strong>browse</strong> and then click <strong>Drive C</strong> to explore the contents in this drive.<br><br>
<img alt="httprat9" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/195c036c0d7694686c5351ec418d1ec9806e8fe2/httprat-10.png" /></p>
</li>
<li>
<p>Click <strong>computer info</strong> to view information of the <strong>computer, users and hardware.</strong><br><br>
<img alt="httprat10" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/195c036c0d7694686c5351ec418d1ec9806e8fe2/httprat-9.png" /></p>
</li>
</ul>
<hr />
<p>After you done, end the <strong>Httpserver.exe</strong> process in <strong>Windows 10</strong>.# Obfuscating a Trojan using SwayzCryptor
SwazCryptor a encrypter (or 'cypher') that allows users to encrypt the source code of their program.</p>
<p>A Crypter is a software used to hide viruses, keyloggers, or any RAT tool from antiviruses so that are not detected and deleted by AV's. It simply assings hidden values to each individual code within the source code. Thus, the source becomes hidden, making it difficult for the AV tools to scan it.</p>
<h3 id="objectives_2">Objectives</h3>
<ul>
<li>How to crypt a Trojan and make it partially/ completely undetectable.</li>
</ul>
<h3 id="requisites_2">Requisites</h3>
<ul>
<li>Windows 10 virtual machine (Attacker).</li>
<li>Windows 7 or 8 virtual machine (Target).</li>
</ul>
<h2 id="scanning-malicious-file">Scanning Malicious File</h2>
<ol>
<li>Log into Windows 10.</li>
<li>Launch a web browser and enter the URL: <code>https://antiscan.me</code></li>
<li>Uplaod the malware file created in <a href="/_ethical_hacking/malware/0-Using-njRAT.md">previous lab</a> and start the scanner.<br></li>
<li>
<p>This site scan with various anti-virus programs in its database, and displays the scan result shown below:<br><br>
<img alt="antiscan" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/882f8120f8b44e6c84a95ba57329c288a8c99d55/antiscan-2.png" /></p>
</li>
<li>
<p>Note the number of detection from AV's <strong>21/26</strong>.</p>
</li>
</ol>
<h2 id="crypt-a-trojan-file-using-swayzcryptor">Crypt a Trojan file using SwayzCryptor</h2>
<ol>
<li>Download the <strong>SwayzCryptor</strong> and launch the program.<br></li>
<li>
<p><a href="https://anonfile.com/JfI8EfI7ne/SwayzCryptor.zip">SwayzCryptor.zip</a></p>
</li>
<li>
<p>Select the same malicious file that you have scanned:<br><br>
<img alt="swayz" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/4e2c26c5828b803db23706fcbdec6bf2c2e19611/swayzcryptor.png" /></p>
</li>
<li>
<p>Check the options <strong>Start up, Mutex and Disable UAC</strong>, then click <strong>Encrypt</strong> to start.<br><br>
<img alt="swayz-2" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/4e2c26c5828b803db23706fcbdec6bf2c2e19611/swayzcryptor-2.png" /></p>
</li>
<li>
<p>Scan the generated <strong>CryptedFile</strong> from SwayzCryptor on  https://antiscan.me <br><br>
<img alt="antiscan-reduced" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/882f8120f8b44e6c84a95ba57329c288a8c99d55/antiscan-3.png" /><br><br>
Note the file detected by very few anti-virus programs now, <strong>12/26</strong>.</p>
</li>
</ol>
<h3 id="test-out-the-cryptedfileexe">Test out the <strong>CryptedFile.exe</strong></h3>
<p>You can easily test if everything works using <strong>njRAT</strong>, share the malicious file with any Windows virtual machine, execute the file with njRAT opened on the Windows 10 machine. <em>In case you're reading this tutorial randomly, on the <a href="/ethical-hacking/blob/malware/Using-njRAT">previous lab</a> is explained how to do this.</em></p>
<h1 id="malware-analysis-virtual-environment">Malware Analysis Virtual Environment</h1>
<h2 id="remnux">REMnux</h2>
<p>REMnux® is a free Linux toolkit for assisting malware analysts with reverse-engineering malicious software. It strives to make it easier for forensic investigators and incident responders to start using the variety of freely-available tools that can examine malware, yet might be difficult to locate or set up.</p>
<p>The heart of the project is the REMnux Linux distribution based on Ubuntu. This lightweight distro incorporates many tools for analyzing Windows and Linux malware, examining browser-based threats such as obfuscated JavaScript, exploring suspicious document files and taking apart other malicious artifacts. Investigators can also use the distro to intercept suspicious network traffic in an isolated lab when performing behavioral malware analysis.</p>
<ul>
<li><a href="https://remnux.org/">REMnux</a></li>
</ul>
<h2 id="tsurugi-linux">Tsurugi Linux</h2>
<p>Tsurugi Linux is a new heavily customized Linux distribution (first release 03/Nov/2018 at AvTokyo security conference in Japan) based on Ubuntu 16LTS version (64-bit with the new 5.4.2 custom kernel) and is designed to support DFIR investigations, malware analysis and OSINT activities.</p>
<ul>
<li><a href="https://tsurugi-linux.org/">tsurugi-linux.</a></li>
</ul>
<h2 id="flare-vm">FLARE VM</h2>
<p><a href="https://github.com/fireeye/flare-vm"><strong>FLARE VM</strong></a> is a freely available and open sourced Windows-based security distribution designed for <strong>reverse engineers, malware analysts</strong>, incident responders, forensicators, and penetration testers. Inspired by open-source Linux-based security distributions like Kali Linux, REMnux and others, FLARE VM delivers a fully configured platform with a comprehensive collection of Windows security tools such as debuggers, disassemblers, decompilers, static and dynamic analysis utilities, network analysis and manipulation, web assessment, exploitation, vulnerability assessment applications, and many others.</p>
<p align="center">
  <img width="200" height="200" src="https://github.com/fireeye/flare-vm/blob/master/flarevm.png?raw=true" alt="FLARE VM"/>
</p>

<h3 id="setup-the-flare-vm-environment">Setup the Flare VM Environment</h3>
<p>The process is very simple, make sure to download the FLARE VM on <a href="https://github.com/fireeye/flare-vm">official GitHub repository</a> by FireEye, and the <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/">Windows 7 virtual machine</a>.</p>
<p>The setup is very easy, just fire up your fresh new Windows 7 VM and install the Flare VM PS scripts. I separeted some useful links on setting up the FLARE VM.</p>
<ul>
<li><a href="https://github.com/fireeye/flare-vm">Official FireEye Repo - Flare VM</a></li>
<li><a href="https://www.fireeye.com/blog/threat-research/2017/07/flare-vm-the-windows-malware.html">Tutorial by FireEye</a></li>
<li><a href="https://youtu.be/F1LE56QQ7iA">HackerSploit Environment Setup Tutorial [Video]</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLBf0hzazHTGMSlOI2HZGc08ePwut6A2Io">HackerSploit Malware Analysis Playlist [Video]</a>#MoSucker</li>
</ul>
<p>MoSucker is a visual basic Trojan. MoSucker's edit server program. It has a client with the same layout as sub Seven's client.</p>
<p>MoSucker is a powerful backdoor-hacker's remote access tool. The backdoor renames NETSTAT.EXE to NETSTAT.OLD when it is first activated and renames the file back when it is uninstalled. The backdoor also can install itself in a system with modification of startup keys in the Registry or INI files.</p>
<ul>
<li><a href="https://anonfile.com/90ZeF1Ifn7/MoSucker.zip">MoSucker.zip</a></li>
</ul>
<p><img alt="mosucker" src="https://1.bp.blogspot.com/-AnTz7yVvxJg/SsvQVfaH5YI/AAAAAAAAAGU/aq5UBVgxcOY/s320/Mosucker_3.0.jpg" /></p>
<h1 id="prorat">ProRat</h1>
<p>ProRat is a Remote Administration Tool written in C, and capable of working with all Windows OS.</p>
<p>ProRat was designed to allow users to control their own computers remotely from other computers. However, attackers have co-opted it for their own nefarious purposes. Some hackers take control of remote computer systems to conduct a denial of service (DoS) attack, which renders the target system unavailable for normal personal or business uses.</p>
<ul>
<li><a href="https://anonfile.com/V4x6GfI8nb/ProRat.zip">ProRat.zip</a></li>
</ul>
<p><img alt="prorat" src="https://3.bp.blogspot.com/-Xx3rNYCYFT4/UWjT2lp3jsI/AAAAAAAAAUc/qsgPijdY85o/s1600/prorat+vv2%252C1.gif" /></p>
<h1 id="theef">Theef</h1>
<p>Theef is a Windows-based application for both client and server. The Theef server is a virus that you install on a target computer, and the Theef client is what you then use to control the virus.</p>
<p>Theef is a Remote Access Trojan written in Delphi, which gives remote attackers system access via port 9871.</p>
<ul>
<li><a href="https://anonfile.com/faf0H8I7na/Theef.zip">Theef.zip</a></li>
</ul>
<p><img alt="theef" src="https://3.bp.blogspot.com/_Sgb3i0uZUVA/S_tLnaKIy2I/AAAAAAAAAGA/v1BMcgN5YnY/s320/2.png" /></p>
<h1 id="jps-virus-maker-tool">JPS Virus Maker Tool</h1>
<p>JPS Virus Maker is a tool to create viruses. It also has a feature for converting a virus into a worm.</p>
<ul>
<li><a href="https://anonfile.com/b4A1x0J6ne/JPS_Virus_Maker.zip">JPS_Virus_Maker.zip</a></li>
</ul>
<p><img alt="jps" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/06800b40b36b1abda880a94465c5ead437e4ffb3/jps-virus.png" /></p>
<h1 id="internet-worm-maker-thing">Internet Worm Maker Thing</h1>
<p>Internet Worm Maker Thing is an automated scripting tool used to generate malicious code. It enables you to specify criteria down to the most basic element, including the action you want it to perform, it display language, and its launch date.</p>
<ul>
<li><a href="https://anonfile.com/x9Y9x8J6nf/IWMT.zip">IWMT.zip</a></li>
</ul>
<p><img alt="iwmt" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/0727fac78bcec409cecbe98ff5bb49ea71c9d3bb/IWMT.png" /></p>
<h1 id="regshot">Regshot</h1>
<p>The purpose of this software is to compare your registry at two separate points by creating a snapshot of the registry before any system changes or when programs are added, removed, or modified and then taking a second snapshot after the modifications then comparing them.</p>
<p>Regshot is a great utility that you can use to compare the amount of registry entries that have been changed during an installation or a change in your system settings. It is a great tool for troubleshooting and monitoring your registry.</p>
<ul>
<li><a href="https://sourceforge.net/projects/regshot/">regshot</a></li>
</ul>
<p><img alt="regshot" src="https://www.howtogeek.com/wp-content/uploads/2014/10/regshot-0.jpg" /></p>
<h1 id="winpatrol">WinPatrol</h1>
<p>WinPatrol is a computer monitoring utility used to protect files and folders from any unwanted changes.</p>
<ul>
<li><a href="http://www.winpatrol.com/download.html">WinPatrol</a></li>
</ul>
<p><img alt="winpatrol" src="https://sc.filehippo.net/images/t_app-cover-l,f_auto/p/4c35e724-2919-5f13-804d-eae15dd20659/3831197935/winpatrol-screenshot.png" /></p>
<h1 id="tcpview">TCPView</h1>
<p>TCPView is a Windows program that will show you detailed listings of all TCP and UDP endpoints on your system, including the local and remote addresses and state of TCP connections. On Windows Server 2008, Vista, and XP, TCPView also reports the name of the process that owns the endpoint. TCPView provides a more informative and conveniently presented subset of the Netstat program that ships with Windows. The TCPView download includes Tcpvcon, a command-line version with the same functionality.</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview">tcpview</a></li>
</ul>
<p><img alt="tcpview" src="https://docs.microsoft.com/en-us/media/landing/sysinternals/tcpview.jpg" /></p>
<h1 id="autoruns">Autoruns</h1>
<p>This utility, which has the most comprehensive knowledge of auto-starting locations of any startup monitor, shows you what programs are configured to run during system bootup or login, and when you start various built-in Windows applications like Internet Explorer, Explorer and media players. These programs and drivers include ones in your startup folder, Run, RunOnce, and other Registry keys. Autoruns reports Explorer shell extensions, toolbars, browser helper objects, Winlogon notifications, auto-start services, and much more. Autoruns goes way beyond other autostart utilities.</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns">autoruns</a></li>
</ul>
<p><img alt="autoruns" src="https://docs.microsoft.com/en-us/media/landing/sysinternals/autoruns_v13.png" /></p>
<h1 id="clamwin">ClamWin</h1>
<p>ClamWin is a Free Antivirus program for Microsoft Windows 10 / 8 / 7 / Vista / XP / Me / 2000 / 98 and Windows Server 2012, 2008 and 2003.
ClamWin Free Antivirus is used by more than 600,000 users worldwide on a daily basis. It comes with an easy installer and open source code. You may download and use it absolutely free of charge.</p>
<h2 id="malware-examples">Malware-Examples</h2>
<p>A collection of viruses/spyware code (not for real use) designed to teach malware analysis</p>
<p>Each program is written in a separate file, using a variety of programming languages to accommodate all backgrounds.<br />
Along with each program's source code are comments describing how it works, and what to look out for.</p>
<p>This is purely an instructional repository of malware code.<br />
None of this is intended for real-life use and be forewarned that use of any of it is illegal almost anywhere in the world.<br />
Please use this repository as a way to learn Cybersecurity forensics.<br />
If there is a type of malware that you wish for me to create an example of for educational purposes, please leave a comment (include the language requested).</p>
<p>I hope that this can help people learn to protect themselves from these types of programs.</p>
<h2 id="some-tips-for-detecting-and-preventing-ransomware">Some tips for detecting and preventing Ransomware</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">Sysmon</a></li>
<li><a href="https://github.com/Neo23x0/Raccine">Raccine</a></li>
<li><a href="http://www.clamwin.com/">ClamWin</a></li>
</ul>
<p><img alt="clamwin" src="https://www.trishtech.com/img_art_a/clamwin_3.jpg" /></p>
<ul>
<li><a href="https://antiscan.me/">AntiScan</a></li>
</ul>
<p>Thank you,<br />
Devon Griffith<br />
A.K.A. rootPHAGE / 我爱数据</p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/malware/malware.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>