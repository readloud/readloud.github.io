<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Phishing Catcher - readloud.org</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Phishing Catcher", url: "#_top", children: [
              {title: "Installation", url: "#installation" },
              {title: "Configuration", url: "#configuration" },
              {title: "Usage", url: "#usage" },
              {title: "Example phishing caught", url: "#example-phishing-caught" },
              {title: "Phishing catcher in Docker container", url: "#phishing-catcher-in-docker-container" },
          ]},
          {title: "License", url: "#license", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="phishing-catcher">Phishing Catcher</h1>
<p>Catch possible phishing domains in near real time by looking for suspicious TLS certificate issuances reported to the <a href="https://www.certificate-transparency.org/">Certificate Transparency Log (CTL)</a> via the <a href="https://certstream.calidog.io/">CertStream</a> API. "Suspicious" issuances are those whose domain name scores beyond a certain threshold based on a configuration file.</p>
<p>This is just a working PoC. Feel free to contribute and tweak the code to fit your needs. üëç</p>
<p><img alt="Screencast of example usage." src="https://i.imgur.com/4BGuXkR.gif" /></p>
<h3 id="installation">Installation</h3>
<p>The script should work fine using Python2 or Python3. In either case, install the requirements after cloning or downloading the source code:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span></code></pre></div>
<h3 id="configuration">Configuration</h3>
<p>Phishing Catcher uses a simple YAML configuration file to assign a numeric score for strings that can be found in a TLS certificate's common name or SAN field (i.e., a cert's domain name). The configuration file, <a href="suspicious.yaml"><code>suspicious.yaml</code></a>, ships with sensible defaults, but you can adjust or add to both the strings it contains and the score assigned to each string by editing an override file, <a href="external.yaml"><code>external.yaml</code></a>.</p>
<p>Both the default <code>suspicious.yaml</code> and the user-modifiable <code>external.yaml</code> configuration files contain two YAML dictionaries: <code>keywords</code> and <code>tlds</code>. The keys of the dictionaries are the strings and the values are the scores to assign if that string is found in the domain name for an issued certificate. For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">keywords</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="s">&#39;login&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
</span></code></pre></div>
<p>Here, a score of <code>25</code> is added to the generic keyword <code>login</code> when it is found in a TLS certificate domain name. Increasing this value will raise the level of suspicion against domains with the string <code>login</code> in them, thus allowing you to subject these certificate issuances to increased scrutiny.</p>
<p>However, in order to be reported as suspicious by Phishing Catcher, the score assigned to a given certificate must meet or exceed (<code>&gt;=</code>, "greater than or equal to") the following thresholds:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Score</th>
<th>Reported as</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">65</td>
<td><code>Potential</code></td>
</tr>
<tr>
<td style="text-align: right;">80</td>
<td><code>Likely</code></td>
</tr>
<tr>
<td style="text-align: right;">90</td>
<td><code>Suspicious</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>:bulb: See the <code>score_domain()</code> function in the source code for details regarding the scoring algorithm.</p>
</blockquote>
<h3 id="usage">Usage</h3>
<p>Once configured to your liking, usage is as simple as running the script:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$ ./catch_phishing.py
</span></code></pre></div>
<h3 id="example-phishing-caught">Example phishing caught</h3>
<p><img alt="Paypal Phishing" src="https://i.imgur.com/AK60EYz.png" /></p>
<h3 id="phishing-catcher-in-docker-container">Phishing catcher in Docker container</h3>
<p>If you running MacOs or having a different OS version that would make the installation of phishing_catcher difficult, then having the tool dockerized is one of your options.</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>docker build . -t phishing_catcher
</span></code></pre></div>
<img alt="container" src="https://i.imgur.com/nEo13PH.jpg" /></p>
<h1 id="license">License</h1>
<p>GNU GPLv3</p>
<p>If this tool has been useful for you, feel free to thank me by buying me a coffee.</p>
<p><a href="https://buymeacoff.ee/x0rz"><img alt="Coffee" src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" /></a></p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/malware/phishing-catcher.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>