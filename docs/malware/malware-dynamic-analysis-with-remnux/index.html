<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Malware Dynamic Analysis with REMnux - readloud.org</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Malware Dynamic Analysis with REMnux", url: "#_top", children: [
              {title: "Upgrade REMnux", url: "#upgrade-remnux" },
              {title: "Add Execute Permission", url: "#add-execute-permission" },
              {title: "Sniff C2 Server Packets", url: "#sniff-c2-server-packets" },
              {title: "Using Process Monitor (Windows)", url: "#using-process-monitor-windows" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="malware-dynamic-analysis-with-remnux">Malware Dynamic Analysis with REMnux</h1>
<p>REMnux is a Linux toolkit for reverse engineering and analyzing malicious software.</p>
<h2 id="upgrade-remnux">Upgrade REMnux</h2>
<p>Before starting analysis, upgrade the REMnux machine by running the following command.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>remnux upgrade
</span></code></pre></div>
<p><br /></p>
<h2 id="add-execute-permission">Add Execute Permission</h2>
<p>To analyze an executable, modify the permission to execute the file then run it.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>chmod +x example.exe
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>./example.exe
</span></code></pre></div>
<p><br /></p>
<h2 id="sniff-c2-server-packets">Sniff C2 Server Packets</h2>
<p>If the executable starts <strong>C2 server</strong> when dynamic analysis, we might be able to sniff packets using Wireshark. In Wireshark, filter by <strong><code>http</code></strong> for sniffing HTTP packets.</p>
<p><br /></p>
<h2 id="using-process-monitor-windows">Using Process Monitor (Windows)</h2>
<p>If our environment is Windows, start <strong>Process Monitor</strong> before dynamic analysis.<br />
<a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procmon">Process Monitor (ProcMon)</a> is a Windows tool that analyze the behavior (real-time registry, file system, and process/threat activity) while analyzing malware.  </p>
<p>In ProcMon, set <strong>"Process Name"</strong> <strong>"is"</strong> <strong>"executable.exe"</strong> then <strong>"Include"</strong> in the Process Monitor Filter, and click <strong>Add ‚Üí OK</strong>.<br />
After executing, we should see results appear in the ProcMon.<br />
The first step is to unset all filters on the right of the tool bar, then set again a filter one by one.</p>
<ul>
<li>
<p><strong>Show Registry Activity</strong></p>
<p>This filter allows us to determine if any significant Registry Modifications are executed by the binary.  To focus on Registry Key Creations and Modifications, exclude RegOpenKey, RegQueryValue, RegQueryKey, RegCloseKey by right-clicking on the row of results.</p>
</li>
<li>
<p><strong>Show File System Activity</strong></p>
<p>This filter allows us to determint if the malware executes File Creations. To focus only on File Write events, exclude CreateFile, CreateFileMapping, QuerySecurityFile, QueryNameInformationFile, QueryBasicInformationFile, CloseFile, ReadFile.</p>
</li>
<li>
<p><strong>Show Network Activity</strong></p>
<p>This filter allows us to confirm if the malware attempts to make a network connection.</p>
</li>
</ul>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/malware/malware-dynamic-analysis-with-remnux.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>