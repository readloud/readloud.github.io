<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>External - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "External Network Penetration Testing", url: "#_top", children: [
              {title: "OSINT", url: "#osint" },
              {title: "Reconnaissance", url: "#reconnaissance" },
              {title: "Exploitation", url: "#exploitation" },
              {title: "Password spray", url: "#password-spray" },
              {title: "Resources", url: "#resources" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../internal/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../internal/" class="btn btn-xs btn-link">
        Internal
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../resource/csrredteam/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../resource/csrredteam/" class="btn btn-xs btn-link">
        Cobaltstrike red team
      </a>
    </div>
    
  </div>

    

    <h1 id="external-network-penetration-testing">External Network Penetration Testing</h1>
<ul>
<li><a href="#external-network-penetration-testing">External Network Penetration Testing</a></li>
<li><a href="#osint">OSINT</a></li>
<li><a href="#reconnaissance">Reconnaissance</a><ul>
<li><a href="#passive-external-network-reconnaissance">Passive External Network Reconnaissance</a><ul>
<li><a href="#dorks">Dorks</a></li>
<li><a href="#pastebin">Pastebin</a></li>
<li><a href="#certificate-transparency">Certificate Transparency</a></li>
<li><a href="#exposed-credentials-and-leaks-flare-darkweb-agent-dehashed-breach-parse">Exposed credentials and leaks (Flare, DarkWeb Agent, dehashed, breach-parse)</a></li>
<li><a href="#dns-history">DNS history</a></li>
<li><a href="#asn-lookups">ASN Lookups</a></li>
<li><a href="#web-archive">Web Archive</a></li>
</ul>
</li>
<li><a href="#active-external-network-reconnaissance">Active External Network Reconnaissance</a><ul>
<li><a href="#subdomain-enumeration">Subdomain enumeration</a></li>
<li><a href="#httphttps-screenshots">HTTP/HTTPS Screenshots</a></li>
<li><a href="#web-app-pentest-checklists">Web App Pentest Checklists</a></li>
<li><a href="#linkedin-users-search">Linkedin users search</a></li>
<li><a href="#subdomain-takeover">Subdomain takeover</a></li>
<li><a href="#bypassing-cloudflare">Bypassing CloudFlare</a></li>
<li><a href="#nmap">NMAP</a></li>
<li><a href="#recon-ng">Recon-NG</a></li>
<li><a href="#user-account-enumeration">User account enumeration</a></li>
<li><a href="#exposed-documents---metadata">Exposed documents - Metadata</a></li>
<li><a href="#virtual-host">Virtual Host</a></li>
<li><a href="#bgp-hijacking">BGP Hijacking</a></li>
<li><a href="#cloud-enumeration">Cloud enumeration</a></li>
</ul>
</li>
<li><a href="#exposed-services---protocols">Exposed services - Protocols</a><ul>
<li><a href="#httphttps">HTTP/HTTPS</a></li>
<li><a href="#smtp">SMTP</a></li>
<li><a href="#dkim--dmarc--spf-misconfiguration">DKIM / DMARC / SPF misconfiguration</a></li>
<li><a href="#snmp">SNMP</a></li>
<li><a href="#ftp">FTP</a></li>
<li><a href="#ssh">SSH</a></li>
<li><a href="#databases-mysql-mssql-oracle-db2-postgre-mongodb">Databases (MySQL, MSSQL, Oracle, DB2, Postgre, MongoDB...)</a></li>
<li><a href="#exposed-storages">Exposed storages</a></li>
<li><a href="#scanning-external-target">Scanning external target</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#exploitation">Exploitation</a><ul>
<li><a href="#rce">RCE</a></li>
<li><a href="#exposed-source-code-or-credentials">Exposed source code or credentials</a></li>
<li><a href="#sap">SAP</a></li>
<li><a href="#lync">Lync</a></li>
<li><a href="#iis-specific-checks">IIS specific checks</a></li>
<li><a href="#web-vulnerabilities">Web vulnerabilities</a></li>
<li><a href="#ssltls-implementation">SSL/TLS implementation</a></li>
<li><a href="#default-credentials-in-use">Default Credentials in use</a></li>
<li><a href="#open-smtp-relay">Open SMTP Relay</a></li>
<li><a href="#dns-zone-transfer">DNS Zone Transfer</a></li>
<li><a href="#vpn---ike-aggressive-mode">VPN - IKE Aggressive Mode</a></li>
</ul>
</li>
<li><a href="#password-spray">Password spray</a><ul>
<li><a href="#general-tool">General tool</a><ul>
<li><a href="#checkpoint-ssl-vpn">CheckPoint SSL VPN</a></li>
<li><a href="#o365">O365</a></li>
<li><a href="#owa">OWA</a></li>
<li><a href="#azure">Azure</a></li>
<li><a href="#ip-rotation">IP rotation</a></li>
</ul>
</li>
<li><a href="#2famfa-implementation-issues">2FA/MFA implementation issues</a></li>
</ul>
</li>
<li><a href="#resources">Resources</a><ul>
<li><a href="#attacking-ms-exchange">Attacking MS Exchange</a></li>
<li><a href="#foregenix--know-your-attack-surfaces">FOREGENIX : Know your attack surfaces</a></li>
<li><a href="#offensive-osint">Offensive OSINT</a></li>
<li><a href="#osint-resources">OSINT Resources</a></li>
<li><a href="#pentest-check-list">Pentest Check-List</a></li>
<li><a href="#haax-cheatsheet">Haax cheatsheet</a></li>
</ul>
</li>
</ul>
<h2 id="osint">OSINT</h2>
<ul>
<li>
<p>spiderfoot<br />
https://github.com/smicallef/spiderfoot</p>
</li>
<li>
<p>Maltego</p>
</li>
<li>
<p>Metabigor<br />
https://github.com/j3ssie/metabigor</p>
</li>
<li>
<p>Very complete and Great OSINT Blog
https://start.me/p/ZME8nR/osint</p>
</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="passive-external-network-reconnaissance">Passive External Network Reconnaissance</h3>
<h5 id="dorks">Dorks</h5>
<p>Google dorks
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>site:company.com -site:www.company.com
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>site:*.company.com
</span></code></pre></div></p>
<p>Bing dorks
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>site:company.com -site:www.company.com 
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>site:*.company.com
</span></code></pre></div></p>
<h5 id="pastebin">Pastebin</h5>
<ul>
<li>https://github.com/carlospolop/Pastos</li>
<li>https://github.com/leapsecurity/Pastepwnd</li>
<li>https://github.com/CIRCL/AIL-framework</li>
<li>https://github.com/cvandeplas/pystemon</li>
<li>https://github.com/xme/pastemon</li>
<li>https://github.com/woj-ciech/pepe</li>
</ul>
<h5 id="certificate-transparency">Certificate Transparency</h5>
<ul>
<li>crt.sh</li>
<li>https://developers.facebook.com/tools/ct/
https://transparencyreport.google.com/https/certificates</li>
<li>
<p>https://certstream.calidog.io/</p>
</li>
<li>
<p><a href="https://github.com/chris408/ct-exposer">ct-exposer</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>python3 ct-exposer.py -d teslamotors.com
</span></code></pre></div></p>
</li>
</ul>
<p>Finding domain for a company using certificate transparency list (<a href="https://github.com/NeelRanka/DomainParser">Domain Parser</a>)
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>curl -s https://crt.sh/\?o\=Company\&amp;output\=json &gt; crt.txt
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>cat crt.txt | jq -r &#39;.[].common_name&#39; | DomainParser | sort -u
</span></code></pre></div></p>
<h5 id="exposed-credentials-and-leaks-flare-darkweb-agent-dehashed-breach-parse">Exposed credentials and leaks (Flare, DarkWeb Agent, dehashed, breach-parse)</h5>
<ul>
<li>Social networks (linkedIn, hunter.io, clearbit, phonebook.cz, Facebook, Company twitter/instagram)</li>
</ul>
<h5 id="dns-history">DNS history</h5>
<ul>
<li>Security-Trails</li>
<li>https://intodns.com/company.com)</li>
</ul>
<h5 id="asn-lookups">ASN Lookups</h5>
<p>https://bgp.he.net/dns/company.com#_ipinfo<br />
Shodan ASN filter feature</p>
<p>Google search<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>ipinfo asn Company Name
</span></code></pre></div></p>
<p>Amass Intel module<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>amass intel -org CompanyName
</span></code></pre></div></p>
<p><a href="https://github.com/projectdiscovery/tlsx">TLSX : TLS Grabber</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>echo &quot;144.178.0.0/10&quot; | tlsx -san
</span></code></pre></div></p>
<h5 id="web-archive">Web Archive</h5>
<ul>
<li>Wayback machine</li>
<li>https://archive.fo</li>
<li>Google cache</li>
</ul>
<h3 id="active-external-network-reconnaissance">Active External Network Reconnaissance</h3>
<ul>
<li>masscan</li>
<li>censys</li>
<li>shodan (search engine filters + monitor feature)</li>
<li>scans.io</li>
</ul>
<h5 id="subdomain-enumeration">Subdomain enumeration</h5>
<ul>
<li>
<p>DNS brute force (aiodnsbrute, subLocal)</p>
</li>
<li>
<p>DNS Recon (<a href="https://github.com/OWASP/Amass">amass</a>, <a href="https://github.com/aboul3la/Sublist3r">sublist3r</a>)
https://0xffsec.com/handbook/information-gathering/subdomain-enumeration/#asn-enumeration</p>
</li>
</ul>
<p>A (script)[https://github.com/appsecco/the-art-of-subdomain-enumeration/blob/master/san_subdomain_enum.py] to extract sub-domains from Subject Alternate Name(SAN) in X.509 certs 
- Source: https://github.com/appsecco/the-art-of-subdomain-enumeration<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>python3 san_subdomain_enum.py company.com
</span></code></pre></div></p>
<ul>
<li>https://github.com/projectdiscovery/subfinder
Subdomain discovery tool that discovers valid subdomains for websites by using passive online sources.
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>subfinder -d targetdomain.com -o output.txt
</span></code></pre></div>
<strong><a href="https://github.com/rbsec/dnscan">DNS Scan</a></strong><br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>python3 dnscan.py -d aecon.com -w subdomains.txt
</span></code></pre></div></li>
</ul>
<p><strong><a href="https://github.com/blark/aiodnsbrute">aiodnsbrute</a></strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>aiodnsbrute -t 20 company.com -o csv -f subdomains -w ./subdomains-top1million-110000.txt
</span></code></pre></div></p>
<h5 id="httphttps-screenshots">HTTP/HTTPS Screenshots</h5>
<ul>
<li><a href="https://github.com/michenriksen/aquatone">Aquatone</a></li>
<li><a href="https://github.com/FortyNorthSecurity/EyeWitness">Eyewitness</a></li>
<li><a href="https://github.com/byt3bl33d3r/WitnessMe">WitnessMe</a></li>
<li><a href="https://github.com/sensepost/gowitness">GoWitness</a></li>
</ul>
<h5 id="web-app-pentest-checklists">Web App Pentest Checklists</h5>
<ul>
<li>https://pentestbook.six2dez.com/others/web-checklist</li>
<li>https://alike-lantern-72d.notion.site/Web-Application-Penetration-Testing-Checklist-4792d95add7d4ffd85dd50a5f50659c6</li>
<li>https://github.com/swisskyrepo/PayloadsAllTheThings</li>
</ul>
<h5 id="linkedin-users-search">Linkedin users search</h5>
<ul>
<li>https://github.com/initstring/linkedin2username.git</li>
<li>https://github.com/vysecurity/LinkedInt.git</li>
</ul>
<h5 id="subdomain-takeover">Subdomain takeover</h5>
<ul>
<li>https://www.hackerone.com/blog/Guide-Subdomain-Takeovers</li>
<li>(https://github.com/haccer/subjack)
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>./subjack -w subdomains.txt -t 100 -timeout 30 -o results.txt -ssl
</span></code></pre></div></li>
</ul>
<h5 id="bypassing-cloudflare">Bypassing CloudFlare</h5>
<ul>
<li>
<p>https://github.com/greycatz/CloudUnflare</p>
</li>
<li>
<p>https://www.ericzhang.me/resolve-cloudflare-ip-leakage/</p>
</li>
</ul>
<h5 id="nmap">NMAP</h5>
<ul>
<li>NSE scripts : 14 categories</li>
<li>auth</li>
<li>broadcast</li>
<li>brute</li>
<li>default</li>
<li>discovery</li>
<li>dos (not recommanded)</li>
<li>exploit</li>
<li>external</li>
<li>fuzzer</li>
<li>intrusive</li>
<li>malware</li>
<li>safe</li>
<li>version</li>
<li>vuln</li>
</ul>
<p>Scanning /24 IP range with UDP and TCP scan using SMB NSE script.
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>nmap -sU -sT -p U:137,139,T:22,21,80,443,139,445 --script=smb2-security-mode.nse 192.168.0.10/24
</span></code></pre></div></p>
<h5 id="recon-ng">Recon-NG</h5>
<ul>
<li>https://github.com/lanmaster53/recon-ng</li>
</ul>
<h5 id="user-account-enumeration">User account enumeration</h5>
<p>Against web app portal</p>
<h5 id="exposed-documents-metadata">Exposed documents - Metadata</h5>
<ul>
<li><a href="https://github.com/ElevenPaths/FOCA">Foca</a></li>
<li><a href="https://github.com/dafthack/PowerMeta">PowerMeta</a></li>
<li><a href="https://github.com/m8sec/pymeta">Pymeta</a></li>
</ul>
<h5 id="virtual-host">Virtual Host</h5>
<ul>
<li>https://wya.pl/2022/06/16/virtual-hosting-a-well-forgotten-enumeration-technique/</li>
</ul>
<h5 id="bgp-hijacking">BGP Hijacking</h5>
<ul>
<li><a href="https://www.youtube.com/watch?v=SVo6cDnQQm0">BGP Deep Dive</a></li>
<li>https://www.youtube.com/watch?v=oESNgliRar0</li>
<li><a href="https://www.youtube.com/watch?v=iG5rIqgKuK4">Breaking HTTPS with BGP Hijacking</a></li>
<li>Pentest Mag - <a href="https://pentestmag.com/bgp-hijacking-attack/">BGP Hijacking</a></li>
<li><a href="https://www.wired.com/images_blogs/threatlevel/files/nist_on_bgp_security.pdf">NIST SP-800-54 - BGP Security</a></li>
<li><a href="https://www.youtube.com/watch?v=S0BM6aB90n8">Defcon 16 - Stealing the Internet</a></li>
</ul>
<h5 id="cloud-enumeration">Cloud enumeration</h5>
<ul>
<li><a href="https://github.com/NetSPI/MicroBurst">MicroBurst</a></li>
<li><a href="https://github.com/initstring/cloud_enum">cloud_enum.py</a></li>
</ul>
<h3 id="exposed-services-protocols">Exposed services - Protocols</h3>
<h5 id="httphttps">HTTP/HTTPS</h5>
<h5 id="smtp">SMTP</h5>
<h5 id="dkim-dmarc-spf-misconfiguration">DKIM / DMARC / SPF misconfiguration</h5>
<ul>
<li>https://github.com/BishopFox/spoofcheck.git</li>
<li>https://github.com/Mr-Un1k0d3r/SPFAbuse</li>
<li>https://github.com/MattKeeley/Spoofy
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>python3 spoofy.py -d company.com -o stdout
</span></code></pre></div></li>
</ul>
<h5 id="snmp">SNMP</h5>
<ul>
<li>snmpget</li>
<li>onesixtyone</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>for i in $(cat onesixtyone/dict.txt); do echo -n &quot;$i : &quot;; snmpget -v 3 -u $i udp6:[IPv6] MIB_TO_FETCH; done
</span></code></pre></div>
<h5 id="ftp">FTP</h5>
<h5 id="ssh">SSH</h5>
<h5 id="databases-mysql-mssql-oracle-db2-postgre-mongodb">Databases (MySQL, MSSQL, Oracle, DB2, Postgre, MongoDB...)</h5>
<h5 id="exposed-storages">Exposed storages</h5>
<ul>
<li>AWS S3 buckets</li>
<li>Azure blob storage</li>
<li>GCP storage</li>
</ul>
<h5 id="scanning-external-target">Scanning external target</h5>
<ul>
<li>Nessus, Burp Enterprise, Qualys, nuclei, wpscan, joomscan.  </li>
<li><a href="http://www.melcara.com/wp-content/uploads/2017/09/parse_nessus_xml.v24.pl_.zip">Nessus Perl Parser</a></li>
</ul>
<h2 id="exploitation">Exploitation</h2>
<h4 id="rce">RCE</h4>
<p>RCE-as-a-feature (Jenkins, Serv-U, etc).<br />
- https://github.com/p0dalirius/Awesome-RCE-techniques</p>
<h4 id="exposed-source-code-or-credentials">Exposed source code or credentials</h4>
<ul>
<li>.git folder  </li>
<li>
<p>Access key, token, secret on github, gitlab, mercurial, code repo solutions...
Git / Repo secret parsers  </p>
</li>
<li>
<p>gitleaks (https://github.com/zricethezav/gitleaks)</p>
</li>
<li>trufflehog (https://github.com/trufflesecurity/truffleHog)</li>
<li>git-secrets (https://github.com/awslabs/git-secrets)</li>
<li>shhgit (https://github.com/eth0izzle/shhgit)</li>
<li>gitrob (https://github.com/michenriksen/gitrob)</li>
</ul>
<h4 id="sap">SAP</h4>
<ul>
<li>https://book.hacktricks.xyz/network-services-pentesting/pentesting-sap</li>
</ul>
<h4 id="lync">Lync</h4>
<ul>
<li>https://www.mdsec.co.uk/2017/04/penetration-testing-skype-for-business-exploiting-the-missing-lync/</li>
<li>https://www.trustedsec.com/blog/attacking-self-hosted-skype-businessmicrosoft-lync-installations/</li>
<li>https://github.com/mdsecresearch/LyncSniper</li>
<li>https://github.com/nyxgeek/lyncsmash</li>
</ul>
<h4 id="iis-specific-checks">IIS specific checks</h4>
<p>ASPNET_CLIENT Folder enumeration<br />
- http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html</p>
<ul>
<li><a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt">IIS Fuzz wordlist</a></li>
<li>
<p><a href="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-L_YlVBGlH_l7w9zCtQO%2F-L_YlWYOMUA7fr799GvH%2Fiisfinal.txt?alt=media&amp;token=de499b23-3599-45ce-ad7e-7800858b3dac">IIS Wordlist HackTricks</a></p>
</li>
<li>
<p>.Trace.axd file</p>
</li>
</ul>
<p>IIS tilde character ‚Äú~‚Äù Vulnerability/Feature<br />
- Burp Suite Module IIS Tilde Enumeration
- <a href="https://github.com/irsdl/IIS-ShortName-Scanner">IIS-ShortName-Scanner</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>java -jar iis_shortname_scanner.jar 2 20 https://iiswebserver.com
</span></code></pre></div></p>
<h4 id="web-vulnerabilities">Web vulnerabilities</h4>
<ul>
<li>serialization/deserialization  </li>
</ul>
<h4 id="ssltls-implementation">SSL/TLS implementation</h4>
<ul>
<li>heartbleed</li>
<li>Shellshock</li>
</ul>
<h4 id="default-credentials-in-use">Default Credentials in use</h4>
<ul>
<li>https://diarium.usal.es/pmgallardo/2020/10/31/list-of-default-credentials-websites/</li>
<li>https://cirt.net/passwords</li>
<li>https://datarecovery.com/rd/default-passwords/</li>
</ul>
<h4 id="open-smtp-relay">Open SMTP Relay</h4>
<ul>
<li>https://www.blackhillsinfosec.com/how-to-test-for-open-mail-relays/</li>
</ul>
<h4 id="dns-zone-transfer">DNS Zone Transfer</h4>
<ul>
<li>
<p>https://github.com/mschwager/fierce.git
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>fierce -dns domain.fr
</span></code></pre></div></p>
</li>
<li>
<p>https://github.com/cybernova/DNSaxfr</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>dig @your-ip -t axfr &lt;TARGETDOMAIN.COM&gt;  
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>nmap --script dns-zone-transfer.nse --script-args &quot;dns-zone-transfer.domain=&lt;TARGETDOMAIN.COM&gt;&quot; -Pn -p 53 &lt;TARGET_IP&gt;
</span></code></pre></div>
<h4 id="vpn-ike-aggressive-mode">VPN - IKE Aggressive Mode</h4>
<h2 id="password-spray">Password spray</h2>
<p>(o365, Azure, Citrix, RDP, VPN, OWA, etc)</p>
<h4 id="general-tool">General tool</h4>
<ul>
<li>https://github.com/knavesec/CredMaster</li>
</ul>
<p>The following plugins are currently supported:<br />
- OWA - Outlook Web Access
- EWS - Exchange Web Services
- O365 - Office365
- O365Enum - Office365 User Enum (No Authentication Request)
- MSOL - Microsoft Online
- Okta - Okta Authentication Portal
- FortinetVPN - Fortinet VPN Client
- HTTPBrute - Generic HTTP Brute Methods (Basic/Digest/NTLM)
- ADFS - Active Directory Federation Services
- AzureSSO - Azure AD Seamless SSO Endpoint
- GmailEnum - Gmail User Enumeration (No Authentication Request)</p>
<h5 id="checkpoint-ssl-vpn">CheckPoint SSL VPN</h5>
<ul>
<li>https://github.com/lutzenfried/checkpointSpray</li>
</ul>
<h5 id="o365">O365</h5>
<ul>
<li>https://github.com/SecurityRiskAdvisors/msspray</li>
<li>https://github.com/blacklanternsecurity/TREVORspray</li>
</ul>
<p><code>./trevorspray.py -e emails.txt --passwords "Winter2021!"  --delay 15 --no-current-ip --ssh ubuntu@&lt;IP&gt; ubuntu2@&lt;IP2&gt; -k privkey.pem</code></p>
<h5 id="owa">OWA</h5>
<p>Metasploit module : <code>scanner/http/owa_login</code>  </p>
<h5 id="azure">Azure</h5>
<ul>
<li>https://github.com/dafthack/MSOLSpray</li>
<li>https://github.com/blacklanternsecurity/TREVORspray</li>
</ul>
<h5 id="ip-rotation">IP rotation</h5>
<p>Sometimes during password spraying or brute force attack attacker will need to rotate IP and geolocation to avoid being blocked.  </p>
<ul>
<li>Burp Extension: IPRotate</li>
<li>RhinoSecurity Blog : https://rhinosecuritylabs.com/aws/bypassing-ip-based-blocking-aws/</li>
<li>AWS Keys Setup : https://www.youtube.com/watch?v=_YQLao6p9GM</li>
<li>Proxycannon https://www.blackhillsinfosec.com/using-burp-proxycannon/</li>
<li>BHIS blog (https://www.blackhillsinfosec.com/how-to-rotate-your-source-ip-address/)</li>
<li>Amazon Lambda</li>
<li>Fireprox</li>
</ul>
<h4 id="2famfa-implementation-issues">2FA/MFA implementation issues</h4>
<p>‚Äã
- <a href="https://github.com/dafthack/MFASweep">MFASweep</a>: Detect MFA for various Microsoft Servers<br />
- Credsniper</p>
<p>Re-using valid credentials on alternate services<br />
- Mailsniper</p>
<ul>
<li>https://infosecwriteups.com/all-about-multi-factor-authentication-security-bypass-f1a95f9b6362</li>
<li>https://medium.com/proferosec-osm/multi-factor-authentication-in-the-wild-bypass-methods-689f53f0b62b</li>
</ul>
<h2 id="resources">Resources</h2>
<h4 id="attacking-ms-exchange">Attacking MS Exchange</h4>
<ul>
<li>https://swarm.ptsecurity.com/attacking-ms-exchange-web-interfaces/</li>
</ul>
<h4 id="foregenix-know-your-attack-surfaces">FOREGENIX : Know your attack surfaces</h4>
<ul>
<li>https://www.foregenix.com/blog/know-your-attack-surfaces</li>
</ul>
<h4 id="offensive-osint">Offensive OSINT</h4>
<ul>
<li>https://www.offensiveosint.io/offensive-osint-introduction/</li>
</ul>
<h4 id="osint-resources">OSINT Resources</h4>
<ul>
<li>https://cheatsheet.haax.fr/resources/osint/</li>
<li>https://cheatsheet.haax.fr/open-source-intelligence-osint/</li>
</ul>
<h4 id="pentest-check-list">Pentest Check-List</h4>
<ul>
<li>https://github.com/ibr0wse/RedTeam-PenTest-Cheatsheet-Checklist</li>
</ul>
<h4 id="haax-cheatsheet">Haax cheatsheet</h4>
<ul>
<li>https://cheatsheet.haax.fr/open-source-intelligence-osint/technical-recon/subdomain_discovery/</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../internal/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../internal/" class="btn btn-xs btn-link">
        Internal
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../resource/csrredteam/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../resource/csrredteam/" class="btn btn-xs btn-link">
        Cobaltstrike red team
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/methods/external.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ‚ö†Ô∏è The quieter you become, the more you are able to hear ü•∑</p>
</footer>

</body>
</html>