<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="readloud">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>macOS intrusion - readloud.org</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "MacOS Intrusion", url: "#_top", children: [
              {title: "MacOS 101", url: "#macos-101" },
              {title: "Initial Access", url: "#initial-access" },
              {title: "User Persistence", url: "#user-persistence" },
              {title: "Root Persistence", url: "#root-persistence" },
              {title: "Privilege Escalation", url: "#privilege-escalation" },
              {title: "Lateral movement", url: "#lateral-movement" },
              {title: "Credential Access", url: "#credential-access" },
              {title: "Exfiltration", url: "#exfiltration" },
              {title: "MacOS Security Features", url: "#macos-security-features" },
              {title: "Offensive MacOS - Training / Cert", url: "#offensive-macos-training-cert" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../wmi%204%20attackers/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../wmi%204%20attackers/" class="btn btn-xs btn-link">
        Wmi 4 Attackers
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../internal/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../internal/" class="btn btn-xs btn-link">
        Internal
      </a>
    </div>
    
  </div>

    

    <ul>
<li><a href="#macos-intrusion">MacOS Intrusion</a><ul>
<li><a href="#macos-101">MacOS 101</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#installer-package">Installer Package</a></li>
<li><a href="#app-bundlespackage">App Bundles/Package</a></li>
<li><a href="#applescript-url">AppleScript URL</a></li>
<li><a href="#2fa-phishing">2FA Phishing</a></li>
<li><a href="#macos-payload-generator">MacOS payload generator</a></li>
<li><a href="#phishing-using-office">Phishing using office</a></li>
<li><a href="#c2">C2</a></li>
<li><a href="#user-persistence">User Persistence</a></li>
<li><a href="#plist---launchagents">Plist - (LaunchAgents)</a></li>
<li><a href="#login-items">Login items</a></li>
<li><a href="#loginlogout-hooks">Login/Logout Hooks</a></li>
<li><a href="#cronjobs">CronJobs</a></li>
<li><a href="#folder-action-scripts">Folder action scripts</a></li>
<li><a href="#jxa-persistence">JXA persistence</a></li>
<li><a href="#swift-persistence-scripts">Swift persistence scripts</a></li>
<li><a href="#authorization-plugins">Authorization Plugins</a></li>
<li><a href="#dock-shortcut-modification">Dock shortcut modification</a></li>
<li><a href="#atom-init-script">Atom Init script</a></li>
<li><a href="#sshrc-persistence">SSHrc persistence</a></li>
<li><a href="#vim-plugin">Vim plugin</a></li>
<li><a href="#sublim-text-app-script">Sublim text app script</a></li>
<li><a href="#zsh-profile">ZSH profile</a></li>
<li><a href="#xbar-plugin">XBar Plugin</a></li>
<li><a href="#root-persistence">Root Persistence</a></li>
<li><a href="#launch-daemons">Launch Daemons</a></li>
<li><a href="#emond">Emond</a></li>
<li><a href="#dylib-persistence">Dylib persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#system-creds">System creds</a></li>
<li><a href="#terminal-history">Terminal history</a></li>
<li><a href="#chrome-cookie-crimes">Chrome "Cookie Crimes"</a></li>
<li><a href="#helper-tool">Helper tool</a></li>
<li><a href="#prompt-phishing">Prompt phishing</a></li>
<li><a href="#lateral-movement">Lateral movement</a></li>
<li><a href="#machound">MacHound</a></li>
<li><a href="#bifrost">BiFrost</a></li>
<li><a href="#swiftbelt">SwiftBelt</a></li>
<li><a href="#living-of-the-orchard-bins">Living Of the Orchard Bins</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#keychain">Keychain</a></li>
<li><a href="#phishing-using-prompt">Phishing using prompt</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#exfiltrate-google-services">Exfiltrate Google Services</a></li>
<li><a href="#exfiltrating-jira">Exfiltrating Jira</a></li>
<li><a href="#slack-exfiltration">Slack exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#macos-security-features">MacOS Security Features</a></li>
<li><a href="#code-signing">Code Signing</a></li>
<li><a href="#entitlements">Entitlements</a></li>
<li><a href="#system-integrity-protection-sip">System Integrity Protection (SIP)</a></li>
<li><a href="#tcc">TCC</a></li>
<li><a href="#quarantine">Quarantine</a></li>
<li><a href="#gatekeeper">GateKeeper</a></li>
<li><a href="#xprotect">XProtect</a></li>
<li><a href="#extended-attributes">Extended Attributes</a></li>
<li><a href="#application-sandbox">Application sandbox</a></li>
<li><a href="#notarization">Notarization</a></li>
<li><a href="#apple-endpoint-security-framework">Apple Endpoint Security Framework</a></li>
<li><a href="#offensive-macos---training--cert">Offensive MacOS - Training / Cert</a></li>
<li><a href="#hitb---exploiting-directory-permissions-on-macos">HITB - Exploiting Directory PErmissions on MacOS</a></li>
<li><a href="#objective-see">Objective-See</a></li>
<li><a href="#offensive-macos-repo">Offensive MacOs Repo</a></li>
<li><a href="#def-con-29---cedric-owens---gone-apple-pickin-red-teaming-macos-environments-in-2021">DEF CON 29 - Cedric Owens - Gone Apple Pickin: Red Teaming MacOS Environments in 2021</a></li>
<li><a href="#cve-2021-30657---patrick-wardle-explanation-objective-see">CVE-2021-30657 - Patrick Wardle Explanation (Objective-See)</a></li>
<li><a href="#awesome-macos-red-teaming">Awesome MacOS Red Teaming</a></li>
<li><a href="#mac-security-conference">Mac Security Conference</a></li>
</ul>
</li>
</ul>
<h1 id="macos-intrusion">MacOS Intrusion</h1>
<p><a href="https://attack.mitre.org/matrices/enterprise/macos/">Mitre MacOS Matrix</a></p>
<h3 id="macos-101">MacOS 101</h3>
<table>
<thead>
<tr>
<th>Windows</th>
<th style="text-align: center;">MacOS</th>
</tr>
</thead>
<tbody>
<tr>
<td>Registry</td>
<td style="text-align: center;">Property List Files (.plist)</td>
</tr>
<tr>
<td>Windows Event Logs</td>
<td style="text-align: center;">Apple Unified Logging</td>
</tr>
<tr>
<td>CMD / PSH</td>
<td style="text-align: center;">Terminal.app (bash / zsh)t</td>
</tr>
<tr>
<td>Portable Executable (PE)</td>
<td style="text-align: center;">Mach-O Executable</td>
</tr>
<tr>
<td>DLL</td>
<td style="text-align: center;">Dynamic Library (Dylib)</td>
</tr>
<tr>
<td>%APPDATA%</td>
<td style="text-align: center;">~/Library/Application Support/</td>
</tr>
<tr>
<td>SYSTEM / Administrators</td>
<td style="text-align: center;">Root / admin</td>
</tr>
<tr>
<td>LSASS</td>
<td style="text-align: center;">Keychain</td>
</tr>
<tr>
<td>User Account Control (UAC)</td>
<td style="text-align: center;">Transparency, Consent, and Control (TCC)</td>
</tr>
<tr>
<td>Privileges</td>
<td style="text-align: center;">Entitlements</td>
</tr>
<tr>
<td>.lnk</td>
<td style="text-align: center;">Dock Shortcuts</td>
</tr>
<tr>
<td>-</td>
<td style="text-align: center;">Application Bundles (.app)</td>
</tr>
</tbody>
</table>
<h3 id="initial-access">Initial Access</h3>
<h4 id="installer-package">Installer Package</h4>
<h4 id="app-bundlespackage">App Bundles/Package</h4>
<h4 id="applescript-url">AppleScript URL</h4>
<ul>
<li>https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/</li>
</ul>
<h4 id="2fa-phishing">2FA Phishing</h4>
<p>EvilNginx</p>
<h4 id="macos-payload-generator">MacOS payload generator</h4>
<ul>
<li>https://github.com/D00MFist/Mystikal</li>
</ul>
<h4 id="phishing-using-office">Phishing using office</h4>
<p>Payload execution will probably be sandboxed.
- https://github.com/cldrn/macphish
- https://desi-jarvis.medium.com/office365-macos-sandbox-escape-fcce4fa4123c</p>
<h4 id="c2">C2</h4>
<ul>
<li>https://github.com/its-a-feature/Mythic</li>
<li>https://github.com/kareman/SwiftShell</li>
<li>https://github.com/cedowens/MacC2 </li>
</ul>
<h3 id="user-persistence">User Persistence</h3>
<p>--&gt; Main blog for persistence techniques: - https://theevilbit.github.io/beyond/beyond_intro/</p>
<h4 id="plist-launchagents">Plist - (LaunchAgents)</h4>
<h4 id="login-items">Login items</h4>
<h4 id="loginlogout-hooks">Login/Logout Hooks</h4>
<h4 id="cronjobs">CronJobs</h4>
<h4 id="folder-action-scripts">Folder action scripts</h4>
<h4 id="jxa-persistence">JXA persistence</h4>
<ul>
<li>https://github.com/D00MFist/PersistentJXA</li>
</ul>
<h4 id="swift-persistence-scripts">Swift persistence scripts</h4>
<ul>
<li>https://github.com/cedowens/Persistent-Swift</li>
</ul>
<h4 id="authorization-plugins">Authorization Plugins</h4>
<h4 id="dock-shortcut-modification">Dock shortcut modification</h4>
<h4 id="atom-init-script">Atom Init script</h4>
<h4 id="sshrc-persistence">SSHrc persistence</h4>
<h4 id="vim-plugin">Vim plugin</h4>
<ul>
<li>https://github.com/D00MFist/PersistentJXA/blob/master/VimPluginPersistence.js</li>
</ul>
<h4 id="sublim-text-app-script">Sublim text app script</h4>
<ul>
<li>https://github.com/D00MFist/PersistentJXA/blob/master/SublimeTextPluginPersistence.js</li>
</ul>
<h4 id="zsh-profile">ZSH profile</h4>
<h4 id="xbar-plugin">XBar Plugin</h4>
<ul>
<li>https://github.com/D00MFist/PersistentJXA/blob/master/xbarUtil.py</li>
</ul>
<h3 id="root-persistence">Root Persistence</h3>
<h4 id="launch-daemons">Launch Daemons</h4>
<h4 id="emond">Emond</h4>
<h4 id="dylib-persistence">Dylib persistence</h4>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<ul>
<li>https://ofiralmkias.medium.com/bypassing-macos-sandbox-performing-privilege-escalation-and-more-2a020efd7ceb</li>
</ul>
<p>Check if current user is local admin
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>id
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>dscl . list groups
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>dscl . read groups/admin
</span></code></pre></div></p>
<h4 id="system-creds">System creds</h4>
<ul>
<li>aws</li>
<li>gcp</li>
<li>azure</li>
<li>SSH keys</li>
</ul>
<h4 id="terminal-history">Terminal history</h4>
<p>Look for ZSH, Bash and other terminal history.  </p>
<h4 id="chrome-cookie-crimes">Chrome "Cookie Crimes"</h4>
<ul>
<li>https://mango.pdf.zone/stealing-chrome-cookies-without-a-password</li>
<li>https://github.com/defaultnamehere/cookie_crimes</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git clone https://github.com/defaultnamehere/cookie_crimes.git
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>cd cookie_crimes/
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>./cookie_crimes_macos.sh
</span></code></pre></div>
<h4 id="helper-tool">Helper tool</h4>
<ul>
<li>https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/</li>
</ul>
<h4 id="prompt-phishing">Prompt phishing</h4>
<p>Prompt user for credentials based on predefined context.  </p>
<h3 id="lateral-movement">Lateral movement</h3>
<h4 id="machound">MacHound</h4>
<ul>
<li>https://github.com/XMCyber/MacHound</li>
</ul>
<h4 id="bifrost">BiFrost</h4>
<ul>
<li>https://github.com/its-a-feature/bifrost</li>
</ul>
<h4 id="swiftbelt">SwiftBelt</h4>
<ul>
<li>https://github.com/cedowens/SwiftBelt</li>
</ul>
<h4 id="living-of-the-orchard-bins">Living Of the Orchard Bins</h4>
<ul>
<li>https://www.loobins.io/</li>
</ul>
<h3 id="credential-access">Credential Access</h3>
<h4 id="keychain">Keychain</h4>
<p>If root access you can retrieve and grab the <strong>keychain</strong> db and take offline using chainbreaker.
- https://github.com/n0fate/chainbreaker  </p>
<h4 id="phishing-using-prompt">Phishing using prompt</h4>
<h3 id="exfiltration">Exfiltration</h3>
<h4 id="exfiltrate-google-services">Exfiltrate Google Services</h4>
<ul>
<li><a href="https://github.com/antman1p/GD-Thief">gd-thief</a></li>
<li><a href="https://github.com/antman1p/GD-Thief">gdir-thief</a></li>
<li><a href="https://github.com/antman1p/Conf-Thief">conf-thief</a></li>
</ul>
<h4 id="exfiltrating-jira">Exfiltrating Jira</h4>
<ul>
<li><a href="https://github.com/antman1p/Jir-Thief">jir-thief</a></li>
</ul>
<h4 id="slack-exfiltration">Slack exfiltration</h4>
<ul>
<li><a href="https://github.com/BojackThePillager/Slackhound">slackhound</a></li>
<li><a href="https://github.com/emtunc/SlackPirate">slackpirate</a></li>
</ul>
<h4 id="impact">Impact</h4>
<h3 id="macos-security-features">MacOS Security Features</h3>
<h4 id="code-signing">Code Signing</h4>
<ul>
<li>Introduced MacOS X Lion (10.7)</li>
<li>Cryptographic signature embedded in app using (developer) certificate</li>
<li>Verification handled by : <strong>com.apple.driver.AppleMobileFileIntegrity.kext</strong> kernel extension and <strong>/usr/libexec/amfid</strong> daemon</li>
</ul>
<h4 id="entitlements">Entitlements</h4>
<p>Granular set of permissions that allow or deny an application access to specific system resources or privileges. (Fine-grained rights)</p>
<p>Displaying entitlements for a binary or application
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>codesign –dv --entitlement - ./binary
</span></code></pre></div></p>
<p>We conducting red team operation, operator should look for processes with desired entitlements, <strong>child process inherits the entitlements of the parent</strong> by default.  </p>
<h4 id="system-integrity-protection-sip">System Integrity Protection (SIP)</h4>
<h4 id="tcc">TCC</h4>
<p>TCC - Transaprency, Consent and Control is a mechanis in MacOS to limit and control application access to certain features. Requires user consent to access user data and some system resources.  </p>
<p>--&gt; Similar to Window's UAC (User Account Control), prompting the user if needed permissions.  </p>
<ul>
<li>https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc</li>
</ul>
<p>Folders such as <strong>~</strong> and <strong>/tmp</strong> are not protected by TCC and followings sensitive directories such as:
- ~.ssh
- ~.aws
- ~.config
- gcloud
- credentials.db
- ~.azure</p>
<p>--&gt; If SSH is running you can SSH in locally to get full disk access and bypass TCC.  </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>ssh user@ip &quot;cat ~/Library/Application\ Support/com.apple.TCC/TCC.db&quot;
</span></code></pre></div>
<ul>
<li>https://www.jamf.com/blog/zero-day-tcc-bypass-discovered-in-xcsset-malware/</li>
<li>https://www.youtube.com/watch?v=vMGiplQtjTY</li>
</ul>
<h4 id="quarantine">Quarantine</h4>
<p>Quarantine Attribute - q attr.<br />
- Appended by the OS to files downloaded via browsers (similar to smart screen in Windows world)</p>
<p>--&gt; Using <strong>curl</strong> does not append the quarantine attribute to the file.  </p>
<ul>
<li>https://eclecticlight.co/2019/04/25/%f0%9f%8e%97-quarantine-apps/</li>
<li>https://eclecticlight.co/2019/05/27/is-a-mac-os-x-gatekeeper-bypass-what-it-says/</li>
</ul>
<h4 id="gatekeeper">GateKeeper</h4>
<h4 id="xprotect">XProtect</h4>
<h4 id="extended-attributes">Extended Attributes</h4>
<p>Listing extended attributes for a file
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$ xattr downloadedFile
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>com.apple.metadata:kMDItemWhereFroms
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>com.apple.quarantine
</span></code></pre></div></p>
<p>Deleting quarantine attributes for a file
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$ xattr -d com.apple.quarantine downloadedFile
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>$ xattr downloadedFile
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>com.apple.metadata:kMDItemWhereFroms
</span></code></pre></div></p>
<p>Deleting recursively
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$ xattr -r -d com.apple.quarantine /path/to/MyApp.app
</span></code></pre></div></p>
<h4 id="application-sandbox">Application sandbox</h4>
<h4 id="notarization">Notarization</h4>
<h4 id="apple-endpoint-security-framework">Apple Endpoint Security Framework</h4>
<h3 id="offensive-macos-training-cert">Offensive MacOS - Training / Cert</h3>
<ul>
<li><a href="https://specterops.io/training/mac-tradecraft/">Specterops - Mac Tradfecraft</a></li>
<li><a href="https://www.offsec.com/courses/exp-312/">EXP-312: Advanced macOS Control Bypasses</a></li>
</ul>
<p>a### MacOS - Resources</p>
<ul>
<li>https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/macos-installers-abuse</li>
<li>https://null-byte.wonderhowto.com/how-to/hacking-macos-perform-privilege-escalation-part-1-file-permissions-abuse-0186331/</li>
<li>https://null-byte.wonderhowto.com/how-to/hacking-macos-perform-privilege-escalation-part-2-password-phishing-0186332/</li>
</ul>
<h4 id="hitb-exploiting-directory-permissions-on-macos">HITB - Exploiting Directory PErmissions on MacOS</h4>
<ul>
<li>https://conference.hitb.org/hitblockdown/materials/D1%20-%20Exploiting%20Directory%20Permissions%20on%20MacOS%20-%20Csaba%20Fitzl.pdf</li>
</ul>
<h4 id="objective-see">Objective-See</h4>
<ul>
<li>https://objective-see.org/index.html  </li>
</ul>
<h4 id="offensive-macos-repo">Offensive MacOs Repo</h4>
<ul>
<li>https://github.com/its-a-feature/offensive_macos</li>
</ul>
<h4 id="def-con-29-cedric-owens-gone-apple-pickin-red-teaming-macos-environments-in-2021">DEF CON 29 - Cedric Owens - Gone Apple Pickin: Red Teaming MacOS Environments in 2021</h4>
<ul>
<li>https://www.youtube.com/watch?v=IiMladUbL6E</li>
</ul>
<h4 id="cve-2021-30657-patrick-wardle-explanation-objective-see">CVE-2021-30657 - Patrick Wardle Explanation (Objective-See)</h4>
<p>Explanation of some MacOS security feature - Quarantine / GateKeeper / Notarization
- https://www.youtube.com/watch?v=ivjICKYZul0</p>
<h4 id="awesome-macos-red-teaming">Awesome MacOS Red Teaming</h4>
<ul>
<li>https://github.com/tonghuaroot/Awesome-macOS-Red-Teaming</li>
</ul>
<h4 id="mac-security-conference">Mac Security Conference</h4>
<ul>
<li>https://objectivebythesea.org/v6/index.html</li>
</ul>
<p><strong>TO DO</strong>
- Apple Events
- Read all : https://objective-see.org/blog.html
- https://pentester.wtf/blog/2020/specterops-2020-review/
- https://www.youtube.com/watch?v=vMGiplQtjTY
- Office Macros: Application sandbox and escape
- JXA JavaScript For Automation
- https://posts.specterops.io/no-place-like-chrome-122e500e421f
- https://labs.f-secure.com/blog/operationalising-calendar-alerts-persistence-on-macos
- https://www.virusbulletin.com/uploads/pdf/conference/vb2014/VB2014-Wardle.pdf
- https://theevilbit.github.io/posts/macos_persistence_spotlight_importers/
- https://theevilbit.github.io/beyond/
- https://objectivebythesea.org/v2/talks/OBTS_v2_Thomas.pdf
- https://github.com/cedowens/JXA-Runner
- Abuse daemons for privileges escalation (https://github.com/its-a-feature/HealthInspector)
- https://github.com/cedowens/JXA-Runner
- Basically all cedowens repo
    User_Launchdaemons()
    System_Launchdaemons()
- https://www.sentinelone.com/blog/privilege-escalation-macos-malware-the-path-to-root-part-2/
- https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/
- https://wojciechregula.blog/post/macos-red-teaming-bypass-tcc-with-old-apps/
- https://wojciechregula.blog/post/macos-red-teaming-get-ad-credentials-from-nomad/
- https://wojciechregula.blog/tags/tcc/
- https://wojciechregula.blog/post/macos-red-teaming-apple-signed-java/
- https://github.com/tonghuaroot/Awesome-macOS-Red-Teaming
- https://medium.com/red-teaming-with-a-blue-team-mentality/using-macos-internals-for-post-exploitation-b5faaa11e121
- https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sandbox
- https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections
- https://book.hacktricks.xyz/macos-hardening/macos-red-teaming
- https://hitcon.org/2022/slides/Every-authorization-has-its-black-tackling-privilege-escalation-in-macOS.pdf
- https://www.offsec.com/offsec/macos-preferences-priv-escalation/
- https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/
- https://book.hacktricks.xyz/macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/
- https://www.slideshare.net/wojdwo/abusing-securing-xpc-in-macos-apps
- https://wojciechregula.blog/post/learn-xpc-exploitation-part-1-broken-cryptography/
- http://lockboxx.blogspot.com/2019/09/macos-red-teaming-208-macos-att.html
- https://github.com/usnistgov/macos_security#readme
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-219r1.pdf
- https://www.youtube.com/watch?v=RKidBayaM7c
- https://www.youtube.com/watch?v=pOQOh07eMxY
- https://www.youtube.com/watch?v=IPFpyulNcRQ
- https://www.youtube.com/watch?v=W9GxnP8c8FU
- https://www.youtube.com/watch?v=fMRT8mPMJUs
- https://www.youtube.com/watch?v=W9GxnP8c8FU
- https://www.youtube.com/watch?v=a9hsxPdRxsY
- https://www.youtube.com/watch?v=cAl7epCq0q4
- https://theevilbit.github.io/beyond/beyond_intro/</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../wmi%204%20attackers/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../wmi%204%20attackers/" class="btn btn-xs btn-link">
        Wmi 4 Attackers
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../internal/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../internal/" class="btn btn-xs btn-link">
        Internal
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/readloud/readloud.github.io/releases/tag/themes/edit/master/docs/explore/methods/macos intrusion.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
<p>        ⚠️ The quieter you become, the more you are able to hear 🥷</p>
</footer>

</body>
</html>